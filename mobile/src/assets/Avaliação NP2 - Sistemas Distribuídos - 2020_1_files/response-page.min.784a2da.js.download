!function(t){function e(e){for(var r,c,s=e[0],a=e[1],f=e[2],l=e[3]||[],h=0,m=[];h<s.length;h++)c=s[h],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&m.push(i[c][0]),i[c]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);for(d&&d(e),u.push.apply(u,l);m.length;)m.shift()();return o.push.apply(o,f||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var f=n[s];0!==i[f]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=n[0]))}return 0===o.length&&(u.forEach((function(t){if(void 0===i[t]){i[t]=null;var e=document.createElement("link");a.nc&&e.setAttribute("nonce",a.nc),e.rel="prefetch",e.as="script",e.href=c(t),document.head.appendChild(e)}})),u.length=0),t}var r={},i={13:0},o=[],u=[];function c(t){return a.p+"response-page.chunk."+({1:"ir",2:"json_themes",3:"math",4:"phishing",5:"postsubmit",6:"question.datetime",7:"question.fileupload",8:"question.likert",9:"question.nps",10:"question.ranking",11:"question.rating",12:"quiz",14:"shareform"}[t]||t)+"."+{1:"8f48070",2:"a334576",3:"9c95ac4",4:"92b7872",5:"a1e54e0",6:"cb8df12",7:"5c8d26d",8:"99eea7f",9:"7ce4082",10:"2c37ef9",11:"3cd688c",12:"520231a",14:"0d706e6"}[t]+".js"}if("function"==typeof c){var s=c;c=function(){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var t=replaceChunkSrc(s.apply(this,arguments));if(!t||"string"!=typeof t)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return t}catch(t){return console.error(t),s.apply(this,arguments)}}}function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=r);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,a.nc&&u.setAttribute("nonce",a.nc),u.src=c(t);var s=new Error;o=function(e){u.onerror=u.onload=null,clearTimeout(f);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,n[1](s)}i[t]=void 0}};var f=setTimeout((function(){o({type:"timeout",target:u})}),12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(e)},a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a.oe=function(t){throw console.error(t),t},Object.defineProperty(a,"p",{get:function(){try{if("function"!=typeof setPublicPath)throw new Error("WebpackRequireFrom: 'setPublicPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return setPublicPath()}catch(t){return console.error(t),""}}});var f=window.webpackJsonp=window.webpackJsonp||[],l=f.push.bind(f);f.push=e,f=f.slice();for(var h=0;h<f.length;h++)e(f[h]);var d=l,m=(o.push([146,0]),n());e([[],{},0,[5,12]])}([,function(t,e){t.exports=React},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return a}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function c(t,e,n,r){return new(n||(n=Promise))((function(i,o){function u(t){try{s(r.next(t))}catch(t){o(t)}}function c(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,c)}s((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],u=0,c=o.length;u<c;u++,i++)r[i]=o[u];return r}},function(t,e){t.exports=_},,function(t,e,n){"use strict";function r(){return window.OfficeFormServerInfo}function i(t){window.OfficeFormServerInfo=t}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return m}));var r,i,o,u=n(18),c=n(11),s=n(8),a=n(41),f={};function l(){return o}function h(t){o=t}function d(){return r||(r=$.Deferred(),o?r.resolve(o):i?i.then((function(t){h(t),r.resolve(t)})).catch((function(){Object(a.b)((function(t){h(t),r.resolve(t)}),(function(t){return r.reject(t)}))})):Object(a.b)((function(t){h(t),r.resolve(t)}),(function(t){return r.reject(t)}))),r.promise()}function m(t){var e=f[t];if(!e){var n=$.Deferred();e=n.promise(),f[t]=e,Object(s.c)("MultilingualLazyLoadResourceString")?function(t){try{t=t||Object(c.i)().toLowerCase();var e=u.a.Resolve("ILazyLoadResourceStringsFunc");return e(t).catch((function(){var n=null==t?void 0:t.split("-")[0];return t!==n?e(n).catch((function(){return e(void 0)})):e(void 0)})).then((function(t){return t}))}catch(t){return Promise.reject(t)}}(t).then((function(t){n.resolve(t)})).catch((function(){Object(a.a)(t,(function(t){return n.resolve(t)}),(function(){d().done((function(t){return n.resolve(t)}))}))})):Object(a.a)(t,(function(t){return n.resolve(t)}),(function(){d().done((function(t){return n.resolve(t)}))}))}return e}},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return c}));n(8),n(5);function r(t,e){return t()}function i(t){return t()}function o(){}function u(){throw new Error("unreachable code")}FormsPro.initializeStyleBasis=o;var c={}},function(t,e,n){"use strict";n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return l}));var r,i=n(82),o=n(25),u=n(5);function c(t){r=t}function s(){return d(i.a.ResponsePage)&&!h()&&l("IncrementalLoadForms")}function a(){return d(i.a.ResponsePage|i.a.TeamsResponsePage|i.a.AssignmentResponsePage)&&!h()&&l("DelayLoadThirdPartyJs")}function f(){return d(i.a.ResponsePage)&&!h()&&l("DelayLoadAriaOdataJs")}function l(t){return Object(o.a)().Flighting.isEnabled(t)}function h(){return Object(u.a)().useDebugVersionScript}function d(t){return 0!=(r&t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"m",(function(){return d})),n.d(e,"n",(function(){return m})),n.d(e,"o",(function(){return b})),n.d(e,"b",(function(){return v})),n.d(e,"u",(function(){return g})),n.d(e,"s",(function(){return p})),n.d(e,"v",(function(){return O})),n.d(e,"h",(function(){return j})),n.d(e,"g",(function(){return w})),n.d(e,"k",(function(){return I})),n.d(e,"l",(function(){return S})),n.d(e,"r",(function(){return F})),n.d(e,"i",(function(){return y})),n.d(e,"q",(function(){return N})),n.d(e,"f",(function(){return T})),n.d(e,"t",(function(){return k})),n.d(e,"j",(function(){return P})),n.d(e,"w",(function(){return C})),n.d(e,"c",(function(){return L})),n.d(e,"d",(function(){return M})),n.d(e,"p",(function(){return x}));var r=n(3),i=n(24),o=n(39),u=n(11),c=n(8),s=n(5),a=n(10),f=n(14);function l(t,e){if(!t&&!Object(u.t)()&&!Object(u.s)()){var n=(new Error).stack;console.assert(t,e,n)}}function h(){return r.omit(Object(f.c)(),"embed","oembedsso","themecolor","preview")}function d(){return!!Object(f.c)().embed}function m(){return Object(s.a)().isOembedSPO}function b(){return!!Object(f.c)().oembedsso&&!!Object(f.c)().preview}function v(){return!(!Object(i.h)()&&!function(){if(Object(i.l)()&&Object(u.t)()&&"Analyze"!==Object(u.n)())return!0;return!1}())}function g(){return Object(i.m)()&&Object(c.c)("UnionSSOEnabled")&&Object(c.c)("UnionSsoServerEnabled")}function p(){return!Object(o.f)()&&!Object(u.u)()}function O(){return-1!==navigator.userAgent.toLowerCase().search("windows nt 10.")}function j(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident/")}function w(){return-1!==navigator.userAgent.toLowerCase().indexOf("edge/")}function I(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function S(){return I()&&Object(a.e)()<=640}function F(){return $(window).width()<=768}function y(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function N(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("mac os x")&&-1!==t.indexOf("version/9")&&-1!==t.indexOf("safari")}function T(){return!!navigator.userAgent.match(/android/i)}function k(){return-1!==navigator.userAgent.toLowerCase().indexOf("tbs/")}function P(){return-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger/")}function C(t){try{return JSON.parse(t)}catch(e){return t}}function L(t){return r.keys(t).filter($.isNumeric).map((function(e){return t[e]}))}function M(t){t+="=";var e=document.cookie.split(";").filter((function(e){return e.indexOf(t)>=0}));if(e.length>0){var n=e[0].trim();return n.substring(t.length,n.length)}return null}function x(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"h",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return h}));var r=n(3);function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.map((function(t){return t&&t.trim()})).filter((function(t){return!!t})).join(" ");return n||t.some((function(t){return""===t}))||(n=void 0),n}function o(t,e,n,r,i){r=r||0,n=n||0;var o=e.height(),u=t.outerHeight();if(t.offset()&&e.offset()){var c=t.offset().top-e.offset().top;if(c<0)e.scrollTop(e.scrollTop()+c-(u+n>o?0:n));else{var s=Math.min(u,o),a=c+s-o;u+n+r<o?a=c+(s=u+r)-o:u+n<o&&(s=u+n,a=c-n),a>0&&(i?e.animate({scrollTop:e.scrollTop()+a},"fast"):e.scrollTop(e.scrollTop()+a))}}}function u(t,e){void 0===e&&(e=!0);var n=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return e&&(n=n.replace(/'/g,"&apos;")),n}function c(t,e){var n=r.extend({},t);for(var o in e)switch(o){case"className":case"aria-labelledby":case"aria-describedby":n[o]=i(n[o],e[o]);break;case"children":case"defaultValue":case"value":e.hasOwnProperty(o)&&(null!=n[o]?n[o]=[].concat(n[o],e[o]):n[o]=e[o]);break;case"style":null!=n[o]?r.extend(n[o],e[o]):n[o]=e[o];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":n[o]=s(n[o],e[o]);break;default:void 0!==e[o]&&(n[o]=e[o])}return n}function s(t,e){return function(n){t&&t(n),e&&e(n)}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(n){(0===e.length||e.indexOf(n.keyCode)>=0)&&t(n)}}function f(t){var e=t.nativeEvent.explicitOriginalTarget;return t.relatedTarget||e||document.activeElement}function l(){return window.innerWidth}function h(t,e){if(t&&e)return t[e]||t[e.toLowerCase()]||void 0}},function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"v",(function(){return a})),n.d(e,"m",(function(){return l})),n.d(e,"n",(function(){return h})),n.d(e,"s",(function(){return d})),n.d(e,"t",(function(){return m})),n.d(e,"u",(function(){return b})),n.d(e,"y",(function(){return v})),n.d(e,"x",(function(){return g})),n.d(e,"w",(function(){return p})),n.d(e,"r",(function(){return O})),n.d(e,"o",(function(){return j})),n.d(e,"q",(function(){return w})),n.d(e,"b",(function(){return I})),n.d(e,"j",(function(){return S})),n.d(e,"a",(function(){return F})),n.d(e,"h",(function(){return y})),n.d(e,"c",(function(){return N})),n.d(e,"l",(function(){return T})),n.d(e,"k",(function(){return k})),n.d(e,"g",(function(){return P})),n.d(e,"i",(function(){return C})),n.d(e,"f",(function(){return L})),n.d(e,"e",(function(){return M})),n.d(e,"p",(function(){return x}));var r,i=n(5),o=n(7),u=n(44),c=n(14);function s(){if(null==r){var t=R(),e=Object(i.a)().deployment.toLocaleLowerCase();e.indexOf("usgovdodproduction")>=0?r="USDoDProd":e.indexOf("usgovproduction")>=0?r="USGovProd":e.indexOf("usgovgccproduction")>=0?r="USGovGccProd":(t.indexOf("forms.office.com")>=0||t.indexOf("forms.osi.office.net")>=0)&&-1===t.indexOf("tip.forms.office.com")?r="WWProd":t.indexOf("forms.microsoft.com")>=0?r="MSProd":t.indexOf("forms.office-int.com")>=0||t.indexOf("forms.osi.office-int.net")>=0?r="Int":t.indexOf("customervoice.microsoft.com")>=0?r="CVProd":t.indexOf("customervoice.microsoft-int.com")>=0?r="CVInt":t.indexOf("formweekly")>=0?r="Weekly":t.indexOf("formhotfix")>=0?r="Hotfix":t.indexOf("formdaily")>=0?r="Daily":t.indexOf("formpilot")>=0?r="Pilot":t.indexOf("formtrial")>=0?r="Trial":t.indexOf("formdrill")>=0?r="Drill":t.indexOf("localhost")>=0?r="DevHost":t.indexOf("forms.microsoft-int.com")>=0?r="MSInt":t.indexOf("formspro-test-staging")>=0?r="ProDaily":t.indexOf("tip.forms.office.com")>=0&&(r="ProTip")}return r}function a(){var t=R();return t.indexOf("cus-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0}function f(){return!!window.location.pathname.toLocaleLowerCase().startsWith("/formspro")}function l(){switch(s()){case"WWProd":return"https://c.office.com";case"MSProd":case"CVProd":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";case"MSInt":default:return null}}function h(){var t=window.location.pathname.toLowerCase();switch(f()&&(t=t.substring("/formspro".length)),t){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":case"/pages/teamsmeetingpollpage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/adminsettings.aspx":return"AdminSettings";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";default:return"Unknown"}}function d(){return R().indexOf(".forms.osi.office.net")>0}function m(){var t=s();return"WWProd"===t||"MSProd"===t||"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t||"CVProd"===t}function b(){var t=s();return"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t}function v(){return"USGovGccProd"===s()}function g(){return"USGovProd"===s()}function p(){return"USDoDProd"===s()}function O(){switch(s()){case"Int":case"WWProd":case"MSInt":case"MSProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":case"ProTip":case"CVInt":case"CVProd":return!0;default:return!1}}function j(){return O()}function w(){switch(window.location.pathname.toLowerCase()){case"/pages/mobiledesignpage.aspx":return!0;default:return!1}}function I(){var t=Object(u.c)();return m()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}function S(){return Object(o.c)((function(){return"USGovProd"===(t=s())||"USDoDProd"===t?"https://graph.microsoft.us/v1.0":function(){var t=s();return"WWProd"===t||"MSProd"===t||"CVProd"===t}()||v()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0";var t}),o.e)}function F(){return"USGovProd"===s()||"USDoDProd"===s()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"}function y(){return"USGovProd"===s()||"USDoDProd"===s()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"}function N(t){return"lists."+D(t)}function T(){switch(s()){case"WWProd":case"MSProd":case"CVProd":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}function k(){switch(s()){case"WWProd":case"MSProd":case"CVProd":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}function P(){switch(s()){case"WWProd":case"MSProd":case"CVProd":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}function C(){return Object(c.c)().lang||Object(i.a)().cultureInfo.Name}function L(){return Object(c.c)().lang||null}function M(){return"Int"}function x(){return R().indexOf("forms.microsoft")>=0}function D(t,e){switch(void 0===e&&(e=!1),null==t&&(t=s()),t){case"USDoDProd":return e?"apps.mil":"osi.apps.mil";case"USGovProd":return e?"office365.us":"osi.office365.us";case"USGovGccProd":return e?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":case"CVProd":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}function R(){return window.location.host.toLocaleLowerCase()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return X}));var r,i=n(2),o=n(3),u=n(4),c=n(0),s=n(8),a=n(5),f=n(47),l=n(21),h=n(9),d=(n(7),n(22)),m=n(19),b=n(11);!function(t){t[t.Normal=0]="Normal",t[t.SoftDeleted=1]="SoftDeleted"}(r||(r={}));var v=n(15),g=n(23),p=function(){function t(t,e){if(this.O=t,this.I=Object(g.b)(t),this.I){var n=this.I.getDesignForm;switch(this.O.SyncContext){case v.a.SharedTimeForm:n=this.I.getSharedForm;break;case v.a.ResponseTimeForm:n=this.I.getRuntimeForm;break;case v.a.AnalysisTimeForm:n=this.I.getAnalysisTimeForm;break;case v.a.ResponseDetailTimeForm:n=this.I.getResponseDetailRuntimeForm;break;case v.a.AdminPhishingReviewForm:n=this.I.getAdminPhishingReviewForm}this.F=n.bind(this.I)}}var e=t.prototype;return e.add=function(t){return this.O.SyncContext===v.a.LocalForm?new Promise((function(){})):this.O.SyncContext===v.a.DesignTimeForm?this.I.createForm(t):void Object(m.b)("Trying to create a form without design type.")},e.delete=function(t){if(this.O.SyncContext===v.a.DesignTimeForm)return this.N(),this.I.deleteForm(this.O.Model.Id);Object(m.b)("Trying to delete a form without design type.")},e.query=function(t){if(!this.F){return $.Deferred().reject({innerCode:1001,type:"ExpectedFailure"}).promise()}var e=u.a.getFieldSchemaInfo(this.O.Schema.LocalizedResources).Attributes.SourceFieldName,n=t.filter((function(t){return t!==e})),r=[],c=$.Deferred();return this.F(this.O.Model.Id,n).then((function(t){return c.resolve(t)}),(function(t){return c.reject(t)})),r.push(c.promise()),o.find(t,(function(t){return t===e}))&&!Object(b.q)()&&r.push(this.O.getAllLocaleResources()),$.when.apply($,r).then((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.extend.apply(o,Object(i.f)([{}],t))}))},e.update=function(t){if(this.O.SyncContext===v.a.LocalForm)return $.Deferred().promise();if(this.O.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var e=u.a.getFieldSchemaInfo(X.Schema.SoftDeleted).Attributes.SourceFieldName;return e in t&&t[e]===r.SoftDeleted&&this.N(),this.I.updateForm(this.O.Model.Id,t)},e.N=function(){var t=this;return this.I.removeRecentForm(this.O.Model.Id).then((function(){var e=Forms.Mru.MruDocumentCollectionMaster.getInstance();e&&e.removeDocument(t.O.Model.Id)}))},t}(),O=n(50),j=function(){function t(t,e){this.T=t,this.P=e,this.I=Object(g.b)(this.T.Form)}var e=t.prototype;return e.C=function(){return this.T.FormId},e.L=function(){return this.T.ResponseId},e.add=function(t){return Object(m.b)("No scenario to call this method currently.")},e.delete=function(t){return this.I.deleteFormResponse(this.C(),t.id)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=t.releaseDate,r=this.T.Form.SyncContext;return r!==v.a.DesignTimeForm&&r!==v.a.AnalysisTimeForm?$.Deferred().promise():void 0!==n?this.I.setResponseReleaseDate(this.C(),this.L(),n):$.Deferred().resolve().promise()},t}(),w=n(46),I=n(48),S=function(){function t(t,e){this.D=t,this.I=Object(g.b)(this.D.Response.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.D.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ResponseId",{get:function(){return this.D.ResponseId},enumerable:!1,configurable:!0}),e.add=function(t,e,n){return this.I.addFormResponseComment(this.FormId,this.ResponseId,e.Snapshot)},e.delete=function(t){return $.Deferred().promise()},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this.D.Response.Form.SyncContext;return n!==v.a.DesignTimeForm&&n!==v.a.AnalysisTimeForm?$.Deferred().promise():this.add(t,e,!0)},t}(),F={QuestionId:c.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:c.a.number({SourceFieldName:"id"}),Feedback:c.a.string({SourceFieldName:"feedback"}),Score:c.a.number({SourceFieldName:"score"}),SavingState:c.a.reference({IsLocalField:!0})};var y=function(t){function e(n){var r=t.call(this,n,{Scheduler:new w.a(e.name)})||this;return Object(O.b)(r),r.observe(N),r}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Response",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Response.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!1,configurable:!0}),e}(u.a.createObjectMasterClass("Comment",F,(function(t,e){return new S(t,e)})));function N(t){if(t.BeingDeleted&&t.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(t){I.a.logData({errorName:"ModelError",errorInfo:t.stack})}}var T={Id:c.a.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:c.a.collectionOf((function(){return y}),{SourceFieldName:"comments"}),AnswersAsString:c.a.string({SourceFieldName:"answers"}),StartDateAsString:c.a.string({SourceFieldName:"startDate"}),SubmitDateAsString:c.a.string({SourceFieldName:"submitDate"}),Responder:c.a.string({SourceFieldName:"responder"}),ResponderName:c.a.string({SourceFieldName:"responderName"}),QuizResult:c.a.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:c.a.string({SourceFieldName:"releaseDate"}),Answers:c.a.collectionOf({QuestionId:c.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:c.a.reference({SourceFieldName:"answer1"}),Feedback:c.a.string({IsLocalField:!0}),Score:c.a.number({IsLocalField:!0}),IsAutoGraded:c.a.boolean({IsLocalField:!0}),IsMathAnswer:c.a.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:c.a.reference({IsLocalField:!0}),SubmitDate:c.a.reference({IsLocalField:!0}),ReleaseDate:c.a.reference({IsLocalField:!0}),Feedback:c.a.string({IsLocalField:!0}),TotalScore:c.a.number({IsLocalField:!0}),IntegratedSavingState:c.a.reference({IsLocalField:!0}),SavingState:c.a.reference({IsLocalField:!0}),EmailReceiptConsent:c.a.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:c.a.string({SourceFieldName:"submitLanguage"}),MSRewardsData:c.a.reference({SourceFieldName:"msRewardsData"})};T.Answers[0];var k=function(t){function e(n){var r=this,i=$.Deferred();return(r=t.call(this,n,{Scheduler:new w.a(e.name),MasterReady:i.promise()})||this).A(),e.Rules.forEach((function(t){return r.addRule(t)})),i.resolve(),r}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!1,configurable:!0}),n.updateWithNormalizedResponse=function(t){var n=this;this.bulkEdit((function(){n.Synchronizer.onSourceDataReceived(u.a.convertToSourceData(t,e.Schema)),n.setData(t)}))},n.getAnswerByQuestionId=function(t){var e=u.a.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:t});return e&&u.a.getObjectMasterFromModel(e)},n.getCommentByQuestionId=function(t){var e=u.a.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:t});return e&&function(t){return u.a.getObjectMasterFromModel(t)}(e)},n.setAnswerGrading=function(t,e,n){var r=this.Form.getQuestionById(t);if(r){var i=r.SubQuestionMasters;i.length>0&&(t=i[i.length-1].Model.Id);var o=this.getCommentByQuestionId(t);if(o)o.bulkEdit((function(){o.Model.Score=e,o.Model.Feedback=n}));else{var c={QuestionId:t,Feedback:n,Score:e};u.a.Collection.addItems(this.Model.Comments,[c])}}},n.A=function(){var t=this;this._="Idle";var e=u.a.getCollectionMasterFromModel(this.Model.Comments);Object(O.c)(e,e.Schema[0].SavingState,(function(e){t._=e,t.U()})),Object(O.b)(this),this.U()},n.$=function(t){var e=this.getAnswerByQuestionId(t);if(e)return e;var n=u.a.Collection.addItems(this.Model.Answers,[{QuestionId:t}])[0];return u.a.getObjectMasterFromModel(n)},n.U=function(){this.Model.IntegratedSavingState=Object(O.a)([this.Model.SavingState,this._])},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"ResponseComment",InterestedFields:[t.Feedback,t.TotalScore],onChange:function(t){var e=t.Master,n=e.getCommentByQuestionId(null);n?n.bulkEdit((function(){n.Model.Feedback=e.Model.Feedback,n.Model.Score=e.Model.TotalScore})):u.a.Collection.addItems(e.Model.Comments,[{QuestionId:null,Feedback:e.Model.Feedback,Score:e.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[t.Answers[0].Feedback,t.Answers[0].Score,t.Answers[0].IsAutoGraded],onChange:function(t){var e=t.Master,n=e.Model.Answers,r=function(t){t.IsAutoGraded||e.setAnswerGrading(t.QuestionId,t.Score,t.Feedback)};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[t.Comments],onChange:function(t){var e=t.Master,n=e.Model.Comments,r=function(t){var n=t.QuestionId;if(n){var r=e.$(n);r.bulkEdit((function(){r.Model.Feedback=t.Feedback,r.Model.Score=t.Score,r.Model.IsAutoGraded=!1}))}else e.bulkEdit((function(){e.Model.Feedback=t.Feedback,e.Model.TotalScore=t.Score}))};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}}],e.rules=e.rules.concat(e.getRulesForSyncBetweenDateFields(t.StartDate,t.StartDateAsString),e.getRulesForSyncBetweenDateFields(t.SubmitDate,t.SubmitDateAsString),e.getRulesForSyncBetweenDateFields(t.ReleaseDate,t.ReleaseDateAsString))}return e.rules},enumerable:!1,configurable:!0}),e.getRulesForSyncBetweenDateFields=function(t,e){var n=u.a.getFieldSchemaInfo(t).Name,r=u.a.getFieldSchemaInfo(e).Name;return[{Name:"update "+n,InterestedFields:[e],onChange:function(t){var e=t.Master.Model;e[n]=new Date(e[r])}},{Name:"update "+r,InterestedFields:[t],onChange:function(t){var e=t.Master.Model;e[r]=e[n].toISOString()}}]},e}(u.a.createObjectMasterClass("Response",T,(function(t,e){return new j(t,e)})));function P(t){var e=u.a.convertFromSourceData(t,k.Schema);void 0!==e.StartDateAsString&&(e.StartDate=new Date(e.StartDateAsString)),void 0!==e.SubmitDateAsString&&(e.SubmitDate=new Date(e.SubmitDateAsString)),void 0!==e.ReleaseDateAsString&&(null===e.ReleaseDateAsString?e.ReleaseDate=new Date("0001-01-01T00:00:00Z"):e.ReleaseDate=new Date(e.ReleaseDateAsString));var n=[];if(e.AnswersAsString&&(n=JSON.parse(e.AnswersAsString).map((function(t){return{Answer:t.answer1,QuestionId:t.questionId}})),e.Answers=n),e.Comments){var r={},i=[];o.forEach(e.Comments,(function(t){var e=t.QuestionId||"___";r[e]&&i.push(r[e]),r[e]=t})),e.Comments=o.difference(e.Comments,i)}if(e.Comments){var c={};n.forEach((function(t){return c[t.QuestionId]=t})),o.forEach(e.Comments,(function(t){var r=t.QuestionId;if(r){var i=c[r];i||(i={Answer:null,QuestionId:r},n.push(i),c[r]=i),i.Feedback=t.Feedback,i.Score=t.Score}else e.Feedback=t.Feedback,e.TotalScore=t.Score}))}return e}var C=n(49),L=n(64),M=n(33),x=n(40),D=n(62),R=function(){function t(t){this.W=t,this.I=Object(g.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){if(!t.localeId||!t.localeName||this.W.Form.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var e={elementKey:"localename",elementValue:t.localeName,locale:t.localeId,questionId:""};return this.I.createLocaleItem(this.W.FormId,e)},e.delete=function(t){return t.localeId&&this.W.Form.SyncContext===v.a.DesignTimeForm?this.I.deleteLocale(this.W.FormId,t.localeId):$.Deferred().resolve().promise()},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||!t.localeName||this.W.Form.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=null!==e.ValuesBefore.localeName,r={elementKey:"localename",elementValue:t.localeName,locale:this.W.Model.localeId,questionId:null};return n?this.I.updateLocaleItem(this.W.FormId,r):this.I.createLocaleItem(this.W.FormId,r)},t}(),E={localeId:c.a.string({IsKeyField:!0}),localeName:c.a.string()},A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e}(u.a.createObjectMasterClass("LocaleInfoMaster",E,(function(t){return new R(t)}))),_=n(52),U=function(){function t(t,e){this.J=t,this.I=Object(g.b)(this.J.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.J.FormId},enumerable:!1,configurable:!0}),e.add=function(t){return this.J.Form.SyncContext===v.a.AdminPhishingReviewForm?this.I.createAdminPhishingReviewPermissionLink(this.FormId,t):this.I.createPermissionLink(this.FormId,t)},e.delete=function(t){return this.I.deletePermissionLink(this.FormId,t.principalId)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){if("OrgLink"===e.Snapshot.type||"Link"===e.Snapshot.type||"ShareToPeople"===e.Snapshot.type){var n={permissionSet:e.Snapshot.permissionSet,type:e.Snapshot.type};return this.J.Form.SyncContext===v.a.AdminPhishingReviewForm?this.I.createAdminPhishingReviewPermissionLink(this.FormId,n):this.I.createPermissionLink(this.FormId,n)}return Object(m.b)("No scenario to call this method currently.")},t}(),B={PrincipalId:c.a.string({SourceFieldName:"principalId"}),PermissionSet:c.a.string({SourceFieldName:"permissionSet"}),Type:c.a.reference({SourceFieldName:"type"}),FormId:c.a.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:c.a.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:c.a.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:c.a.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:c.a.reference({IsLocalField:!0})};var Q=function(t){function e(e){var n=t.call(this,e)||this;return Object(O.b)(n),n}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e}(u.a.createObjectMasterClass("Permission",B,(function(t,e){return new U(t,e)}))),q=function(){function t(t,e){this.K=t,this.I=Object(g.b)(this.K.getForm())}var e=t.prototype;return e.C=function(){return this.K.getFormId()},e.add=function(t){return this.I.createPermissionToken(this.C(),t)},e.delete=function(t){return this.I.deletePermissionToken(this.C(),t.principalId)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){return Object(m.b)("No scenario to call this method currently.")},t}(),V={PrincipalId:c.a.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:c.a.reference({SourceFieldName:"type"}),Name:c.a.string({SourceFieldName:"name"})};var z,G=function(t){function e(e){return t.call(this,e)||this}Object(i.c)(e,t);var n=e.prototype;return n.getForm=function(){return this.Parent.Parent},n.getFormId=function(){return this.getForm().Model.Id},e}(u.a.createObjectMasterClass("PermissionToken",V,(function(t,e){return new q(t,e)})));!function(t){t[t.Default=0]="Default",t[t.Shown=1]="Shown",t[t.Closed=2]="Closed"}(z||(z={}));var H=n(53),W=n(97),J=n(124),K={Id:c.a.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:c.a.string({SourceFieldName:"description"}),Background:c.a.fromMasterClass(l.f,{SourceFieldName:"background"}),Category:c.a.string({SourceFieldName:"category"}),Logo:c.a.fromMasterClass(l.f,{SourceFieldName:"logo"}),MeetingId:c.a.string({SourceFieldName:"meetingId"}),ModifiedDate:c.a.string({SourceFieldName:"modifiedDate"}),CreatedDate:c.a.string({SourceFieldName:"createdDate"}),OtherInfo:c.a.string({SourceFieldName:"otherInfo"}),OwnerId:c.a.string({SourceFieldName:"ownerId"}),OwnerTenantId:c.a.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:c.a.string({SourceFieldName:"ownerUserType"}),RowCount:c.a.number({SourceFieldName:"rowCount"}),SharedBy:c.a.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:c.a.string({SourceFieldName:"ownerDisplayName"}),SharedDate:c.a.string({SourceFieldName:"dateTimeShared"}),TableId:c.a.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:c.a.number({SourceFieldName:"tenantSwitches"}),PrivacyUrl:c.a.string({SourceFieldName:"privacyUrl"}),Title:c.a.string({SourceFieldName:"title"}),Version:c.a.string({SourceFieldName:"version"}),XlWorkbookId:c.a.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:c.a.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:c.a.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:c.a.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:c.a.collectionOf((function(){return Q}),{SourceFieldName:"permissions"}),PermissionTokens:c.a.collectionOf((function(){return G}),{SourceFieldName:"permissionTokens"}),Questions:c.a.collectionOf(l.i,{SourceFieldName:"questions"}),DescriptiveElements:c.a.collectionOf((function(){return C.a}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:c.a.boolean({IsLocalField:!0}),SoftDeleted:c.a.enumeration((function(){return r}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:c.a.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:c.a.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:c.a.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:c.a.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:c.a.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:c.a.string({SourceFieldName:"mfpBranchingData"}),PipesDetails:c.a.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:c.a.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:c.a.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:c.a.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:c.a.string({SourceFieldName:"inviteExpiryDays"}),FormsProEmbedCode:c.a.string({SourceFieldName:"formsProEmbedCode"}),FormsProAnswerTagMap:c.a.collectionOf({name:c.a.string(),value:c.a.string(),questionId:c.a.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:c.a.collectionOf({name:c.a.string(),value:c.a.string()},{IsLocalField:!0}),FooterText:c.a.string({SourceFieldName:"footerText"}),CustomCssFileName:c.a.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:c.a.string({SourceFieldName:"customDomainSenderEmail"}),ProjectId:c.a.string({SourceFieldName:"projectId"}),SurveyFont:c.a.string({SourceFieldName:"surveyFont"}),HeaderFont:c.a.string({SourceFieldName:"headerFont"}),Alias:c.a.string({SourceFieldName:"alias"}),TrackingId:c.a.string({SourceFieldName:"trackingId"}),ThankYouMessage:c.a.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:c.a.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:c.a.number({SourceFieldName:"flags"}),Type:c.a.reference({SourceFieldName:"type"}),OnlineSafetyLevel:c.a.number({SourceFieldName:"onlineSafetyLevel"}),BufferResponses:c.a.collectionOf(c.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),CoAuthors:c.a.collectionOf(c.a.reference(),{IsLocalField:!0}),DeleteCollaborationPermission:c.a.boolean({IsLocalField:!0}),LastSyncTime:c.a.number({IsLocalField:!0}),RtcStatus:c.a.number({IsLocalField:!0}),HasValidBranching:c.a.boolean({IsLocalField:!0}),HasQuestionMedia:c.a.boolean({IsLocalField:!0}),Created:c.a.string({IsLocalField:!0}),Modified:c.a.string({IsLocalField:!0}),PredefinedResponses:c.a.collectionOf({Id:c.a.number({IsKeyField:!0}),Answers:c.a.collectionOf({QuestionId:c.a.string(),Answer:c.a.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:c.a.string({IsLocalField:!0}),QuizQuestionsCount:c.a.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:c.a.string({IsLocalField:!0}),Responses:c.a.collectionOf(c.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),ResponsesCount:c.a.number({IsLocalField:!0}),XlExportingLocalTag:c.a.string({IsLocalField:!0}),SerializedSettings:c.a.string({SourceFieldName:"settings"}),Settings:c.a.fromMasterClass((function(){return W.a}),{IsLocalField:!0}),SerializedPredefinedResponses:c.a.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:c.a.string({IsLocalField:!0}),Theme:c.a.fromMasterClass((function(){return J.a}),{IsLocalField:!0}),ResponseModels:c.a.collectionOf((function(){return k}),{IsLocalField:!0}),IntegratedSavingState:c.a.reference({IsLocalField:!0}),SavingState:c.a.reference({IsLocalField:!0}),LogoInfo:c.a.fromMasterClass(l.g,{IsLocalField:!0}),CreatedFromOneDrive:c.a.boolean({IsLocalField:!0}),TemplateId:c.a.string(),TransferInProgress:c.a.boolean({IsLocalField:!0}),DataClassificationLabel:c.a.string(),DefaultLanguage:c.a.string({SourceFieldName:"defaultLanguage"}),LocaleList:c.a.collectionOf((function(){return A}),{SourceFieldName:"localeList"}),LocalizedResources:c.a.collectionOf((function(){return D.a}),{SourceFieldName:"localizedResources"}),CreatedBy:c.a.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:c.a.create({errorCode:c.a.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:c.a.string({SourceFieldName:"progressBarEnabled"}),YouTubeMessageBarState:c.a.enumeration((function(){return z}),{IsLocalField:!0})},X=function(t){function e(n,r,i,o,u,c){void 0===o&&(o=!1);var s=this,a=$.Deferred();r=Object(H.h)(r),(s=t.call(this,r,{Scheduler:new w.a(e.name),MasterReady:a.promise()})||this).initializing=a,s.syncBlocker=u||s.initializing,s.isGroupForm=i,s.X=o,s.Y=n,s.Z=c;var f=Object(l.e)();return s.formElementManager=new f(s),s.nt(r),s.rt(r),s.ot(r),e.Rules.forEach((function(t){return s.addRule(t)})),s.ut(),s}Object(i.c)(e,t);var n=e.prototype;return n.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(n,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsSampleForm",{get:function(){return this.X},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SyncContext",{get:function(){return this.Y},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SettingMaster",{get:function(){return u.a.getObjectMasterFromModel(this.Model.Settings)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ThemeMaster",{get:function(){return u.a.getObjectMasterFromModel(this.Model.Theme)},enumerable:!1,configurable:!0}),n.getRelatedSourceFields=function(t){return Object(H.g)(t)},n.getImageMaster=function(t){return Object(M.c)(this.getModelByFieldSchema(t))},n.getImageSettingsMaster=function(t){return Object(x.e)(this.getModelByFieldSchema(t))},n.getQuestionById=function(t){return this.formElementManager.getQuestionById(t)},n.getElementById=function(t){return this.formElementManager.getElementMasterById(t)},n.getReleasedResponsesByResponder=function(t){var e=this;return t&&!this.SettingMaster.Model.IsAnonymous?function(t,e){return Object(g.b)(t).getRuntimeResponses(t.Model.Id,e).then((function(t){return t.filter((function(t){return"0001-01-01T00:00:00Z"!==t.releaseDate})).map(P)}))}(this,t).then((function(t){return Object(s.d)()?e.Z.normalizeResponses(t):e.normalizeResponses(t)})):$.Deferred().resolve().promise()},n.getRuntimeResponse=function(t){var e=this;return t?function(t,e){return Object(g.b)(t).getRuntimeResponse(t.Model.Id,e).then(P)}(this,t).then((function(t){return e.ct(t)})):$.Deferred().resolve().promise()},n.ensureReadyToResponse=function(){return this.ensureFieldsReady(Object(H.d)())},n.ensureReadyToShare=function(){return this.ensureFieldsReady(Object(H.e)())},n.getDefaultResponse=function(){var t={};return Object(f.a)()&&o.forEach(this.Model.Questions,(function(e){return t[e.Id]=e.DefaultValue})),t},n.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},n.syncRuntimeResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return e=t,Object(g.b)(e).getRuntimeResponses(e.Model.Id).then((function(t){return t.map(P)}));var e})).then((function(e){t.updatingResponsesFromServer=!0,t.bulkEdit((function(){return t.Model.Responses=t.normalizeResponses(e)})),t.updatingResponsesFromServer=!1}))},n.submitResponse=function(t){var e=this;if("pending"===this.syncBlocker.state())return $.Deferred().resolve();var n=0,r=0,i=!1;return(t=o.clone(t)).Answers=o.map(t.Answers,(function(t){var u=e.getQuestionById(t.QuestionId);return u&&u.Model&&((t=o.clone(t)).Answer=u.serializeAnswer(t.Answer),"Question.TextField"===u.Model.Type&&(n++,t.Answer&&(r+=t.Answer.length),!i&&u.Model.IsMathQuiz&&(i=!0))),t})),i&&this.at(t),d.a.logData({name:"ResponsePage.Form.TextQuestionInfoOfSubmit",extraData:{textQuestionCount:n,textQuestionAnswerTotalLength:r,isQuiz:this.SettingMaster.Model.IsQuizMode}}),this.Synchronizer.existingInDataSource().then((function(){return function(t,e){var n=o.map(e.Answers,(function(t){return{questionId:t.QuestionId,answer1:t.Answer}})),r={answers:JSON.stringify(n),startDate:e.StartDate instanceof Date?e.StartDate.toISOString():"",submitDate:e.SubmitDate instanceof Date?e.SubmitDate.toISOString():""};return r.emailReceiptConsent=e.EmailReceiptConsent,r.submitLanguage=e.SubmitLanguage,e.Responder&&(r.responder=e.Responder,r.responderName=e.ResponderName),Object(g.b)(t).submitFormResponse(t.Model.Id,r)}(e,t)}))},n.getSnapshotToCopy=function(){var t=this.getSnapshot(Object(H.b)()),e=null;return t.XlWorkbookId&&((e=o.clone(t)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==Object(a.a)().userInfo.TenantId&&t.DataClassificationLabel&&(e||(e=o.clone(t)),e.DataClassificationLabel=null),null===e?t:e},n.getLocaleResouceById=function(t){return Object(g.a)(this.Model.Id).getLocaleResource(this.Model.Id,t).then((function(t){return Object(_.e)(t)}))},n.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,e)},n.rt=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},n.ot=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},n.nt=function(t){this.ft=new L.a(this,e.Schema.OtherInfo,Object(H.f)()),t.InitialData&&this.isFieldReady(e.Schema.OtherInfo)&&(t.ExistingInDataSource||t.InitialData.OtherInfo?this.ft.deserialize():this.ft.serialize())},n.normalizeResponses=function(t){var e=this;return this.bulkEdit((function(){t=t.map((function(t){return e.ct(t)}))})),t},n.ct=function(t){var e=this.Model.Settings.IsQuizMode&&this.SyncContext!==v.a.ResponseTimeForm,n={};this.FormElementManager.QuestionMasters.forEach((function(t){return n[t.Model.Id]=t})),(t=o.clone(t)).Answers=o.map(t.Answers,(function(t){var r=n[t.QuestionId];return r?((t=o.clone(t)).Answer=r.deserializeAnswer(t.Answer),t.IsMathAnswer=!r.Model.IsAnswerPlainText,null==t.Score&&e&&r.autoGradeAnswer(t),t):null})).filter((function(t){return!!t}));var r=this.getResponseModelById(t.Id);return r&&(function(t){return u.a.getObjectMasterFromModel(t)}(r).updateWithNormalizedResponse(t),t=r),t},n.getResponseModelById=function(t){return u.a.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:t})},n.at=function(t){var e=this,n={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};o.forEach(t.Answers,(function(t){var r=e.getQuestionById(t.QuestionId);if(r&&r.Model&&"Question.TextField"===r.Model.Type&&r.Model.IsMathQuiz){r.hasCorrectAnswers()?n.GradableQuestionCount++:n.QuestionCount++;var i=Object(h.w)(t.Answer);null!=i&&i.Answer?(n.TotalLength+=i.Answer.length,r.hasCorrectAnswers()?i.IsMath?n.MathGradableResponses++:n.TextGradableResponses++:i.IsMath?n.MathResponses++:n.TextResponses++):n.EmptyResponses++}})),d.a.logData({name:"ResponsePage.Form.TextFieldSubmissionMathInfo",extraData:n})},n.ut=function(){var t=this;this.formElementManager.adjustElementOrders();var n=[e.Schema.Questions,e.Schema.DescriptiveElements];this.addRule({Name:"ElementOrder",InterestedFields:n,onChange:function(){return t.formElementManager.adjustElementOrders()}})},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"DeserializeSettings",InterestedFields:[t.SerializedSettings],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedSettings||"{}",n=JSON.parse(e);t.Master.setData({Settings:n})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[t.SerializedPredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedPredefinedResponses||"[]",n=JSON.parse(e);t.Master.setData({PredefinedResponses:n})}}},{Name:"QuestionMediaProperties",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var e=t.Master.Model,n=u.a.convertToArray(t.Master.getSnapshot().Questions),r=u.a.convertToArray(t.Master.getSnapshot().DescriptiveElements);e.HasQuestionMedia=n.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))||r.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))}}]}return e.rules},enumerable:!1,configurable:!0}),e}(u.a.createObjectMasterClass("FormMaster",K,(function(t,e){return t.getSyncBlocker().then((function(){return new p(t,e)}))})));FormsPro.FormMaster=X},,function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return c}));n(3);function r(t){return o(t||window.location.search.substring(1))}function i(t){return o(t||window.location.hash.substring(1))}function o(t){var e={};return t&&t.trim().split("&").forEach((function(t){var n=t.indexOf("=");-1===n&&(n=t.length);var r=t.substring(0,n).trim();r&&(e[r]=decodeURIComponent(t.substring(n+1)||"").trim())})),e}function u(t){var e=document.createElement("a");return e.href=t,e.href}function c(t,e,n){var r=t.indexOf("#"),i=-1===r?"":t.substr(r);t=-1===r?t:t.substr(0,r);var o=new RegExp("([?&])"+e+"=.*?(&|$)","i"),u=-1!==t.indexOf("?")?"&":"?";return(t=t.match(o)?t.replace(o,"$1"+e+"="+n+"$2"):t+u+e+"="+n)+i}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.DesignTimeForm=1]="DesignTimeForm",t[t.ResponseTimeForm=2]="ResponseTimeForm",t[t.SharedTimeForm=3]="SharedTimeForm",t[t.LocalForm=4]="LocalForm",t[t.AnalysisTimeForm=5]="AnalysisTimeForm",t[t.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",t[t.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(18);function i(t){u().log(t)}function o(t){u().logForTeamsTab(t)}function u(){return r.a.Resolve("ILogger")}var c=window.onerror;window.onerror=function(t,e,n,r,o){i({eventName:"UnhandleException",eventType:"error_event",extraData:{columnNo:r,error:o&&o.toString(),fileName:e,lineNo:n,message:t,stack:o&&o.stack}}),c&&c.apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(1),o=n(27),u=function(t){function e(e){var n,r,i=t.call(this,e)||this;return i.state={},r=n=i,c.forEach((function(t){var e=r[t];e&&(r[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return e.apply(n,r)}catch(e){return s(n,t,e),null}})})),i}return Object(r.c)(e,t),e}(i.Component),c=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function s(t,e,n){try{if(n&&n.stack&&console.error(n.stack),window.onerror){var r=o.findDOMNode(t),i=r&&r.getAttribute("data-reactId")||"",u="Exception in "+t.constructor.name+"["+i+"]:"+e;n&&n.message&&(u+=" Message: "+n.message),window.onerror(u,"",0,0,n)}}catch(n){}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(){function t(){this.ht=!1,this.dt=!1}var e=t.prototype;return e.UsingSingleton=function(t){return this.bt(t,!0)},e.UsingFactory=function(t){return this.bt(t,!1)},e.Create=function(){return this.ht?(this.vt||(this.vt=this.gt()),this.vt):this.gt()},e.bt=function(t,e){return this.ht=e,this.pt=t,this},e.gt=function(){if(this.dt)throw Error("Circular dependency detected ");this.dt=!0;var t=this.pt();return this.dt=!1,t},t}(),i=function(){function t(){this.Ot={}}var e=t.prototype;return e.Add=function(t,e){this.Ot[t]=e},e.Get=function(t){return this.Ot[t]},t}(),o=new(function(){function t(){this.jt=new i}var e=t.prototype;return e.Resolve=function(t){var e,n=this.jt.Get(t);if(!n)throw Error("Failed to resolve "+t+", make sure you have registered it by calling Register()");try{e=n.Create()}catch(e){throw Error("Exception when resolving "+t+": "+e)}return e},e.Register=function(t){if(this.jt.Get(t))throw Error("Duplicate registration of "+t);var e=new r;return this.jt.Add(t,e),e},t}())},,function(t,e,n){"use strict";n.d(e,"g",(function(){return U})),n.d(e,"b",(function(){return B})),n.d(e,"a",(function(){return Q})),n.d(e,"f",(function(){return q})),n.d(e,"e",(function(){return V})),n.d(e,"c",(function(){return z})),n.d(e,"h",(function(){return H})),n.d(e,"d",(function(){return W}));var r=n(2),i=n(3),o=n(4),u=n(19),c=n(0),s=n(21),a=n(65),f=n(61),l=n(9),h=n(48),d=n(80),m=n(46),b=n(33),v=n(40),g=n(64),p=n(63),O=n(123),j=n(88),w=n(6),I=n(38),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.DateTime"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)},n.verify=function(t){return this.Model.Required&&!t?V.RequiredError:V.Success},n.getTypeDisplayName=function(){return Object(w.a)().phcdjjp},e}(I.a),F=n(128),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.FileUpload"},e.createDefaultDefinition=function(){var t=F.b;return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:t[Object.keys(t)[0]]}},n.verify=function(t){return this.Model.Required&&!t?V.RequiredError:V.Success},n.getTypeDisplayName=function(){return Object(w.a)().kijmfog},e}(I.a),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoice"},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?V.Success:V.RequiredError},n.getTypeDisplayName=function(){return"MatrixChoice"},n.getNormalizedAnswer=function(t){return t},e}(I.a),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},e.createDefaultDefinition=function(){var t=[{Description:Object(w.a)().fiknfhm.format(1),IsGenerated:!0,Id:1,Order:1},{Description:Object(w.a)().fiknfhm.format(2),IsGenerated:!0,Id:2,Order:2},{Description:Object(w.a)().fiknfhm.format(3),IsGenerated:!0,Id:3,Order:3},{Description:Object(w.a)().fiknfhm.format(4),IsGenerated:!0,Id:4,Order:4},{Description:Object(w.a)().fiknfhm.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.createSubQuestionsDefinition=function(){return[{Title:Object(w.a)().eiamedp.format(1),Type:"Question.MatrixChoice"},{Title:Object(w.a)().eiamedp.format(2),Type:"Question.MatrixChoice"}]},n.verify=function(t){return V.Success},n.getTypeDisplayName=function(){return Object(w.a)().difcigp},n.hasAnswer=function(){return!1},e}(I.a),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.NPS"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(w.a)().allhmih,LeftDescription:Object(w.a)().cflmphf,RightDescription:Object(w.a)().dddgikp,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},n.verify=function(t){return this.Model.Required&&!t&&0!==t?V.RequiredError:V.Success},n.getTypeDisplayName=function(){return Object(w.a)().fboigoi},n.isNumberType=function(){return!0},e}(I.a),P=n(30),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Ranking"},e.createDefaultDefinition=function(){var t=[{Description:Object(w.a)().fiknfhm.format(1),Order:1,Key:Object(P.b)()},{Description:Object(w.a)().fiknfhm.format(2),Order:2,Key:Object(P.b)()},{Description:Object(w.a)().fiknfhm.format(3),Order:3,Key:Object(P.b)()}];return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,AllowMultipleValues:!0,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?V.Success:V.RequiredError},n.getTypeDisplayName=function(){return Object(w.a)().kfpfphf},n.isCorrectAnswer=function(t){var e=this;if(!t)return!1;var n,r=JSON.parse(this.Model.GradingBasis);n=i.isString(t)?JSON.parse(t):i.map(i.sortBy(t,(function(t){return t.answerOrder})),(function(t){return t.id}));var o=i.map(r,(function(t){return i.findWhere(e.Model.ChoiceGroup,{Key:t}).Id}));return n.length===o.length&&i.isEqual(o,n)},n.createQuizResult=function(t){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(t){var e=this.Model.Point||0;t.Score=this.isCorrectAnswer(t.Answer)?e:0,t.IsAutoGraded=!0},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getNormalizedAnswer=function(t){return t||[]},n.hasCorrectAnswers=function(t){return!0},n.redressGradingBasis=function(){var t=this;this.Master.fieldsReady([Object(s.i)().Schema.ChoiceGroup,Object(s.i)().Schema.GradingBasis]).done((function(){var e=o.a.convertToArray(t.Master.Model.ChoiceGroup).sort((function(t,e){return t.Order-e.Order})).map((function(t){return t.Key}));t.Master.Model.GradingBasis=JSON.stringify(e)}))},e}(I.a),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Rating"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,Length:5,RatingShape:q.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.ShowRatingLabel},n.verify=function(t){return this.Model.Required&&!t?V.RequiredError:V.Success},n.getTypeDisplayName=function(){return Object(w.a)().nngbaol},n.isNumberType=function(){return!0},e}(I.a),M=n(28);var x=n(67),D=(n(7),n(83));var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.TextField"},e.createDefaultDefinition=function(){return e.createDefaultSingleLineDefinition()},e.createDefaultSingleLineDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(w.a)().nfkdbdh,Multiline:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.IsNumber},n.verify=function(t){var e=t;if(this.Model.IsMathQuiz&&e){var n=Object(l.w)(t);if((e=null==n.Answer?t:n.Answer).length>Object(M.i)())return V.MathLengthError}return this.Model.Required&&!e?V.RequiredError:e&&this.Model.IsNumber&&!this.wt(e)?V.NumberValidationError:V.Success},n.getTypeDisplayName=function(){return this.Model.Multiline?Object(w.a)().emlmoca:this.Model.IsNumber?Object(w.a)().gipkiml:Object(w.a)().goinnmm},n.isNumberType=function(){return!!this.Model.IsNumber},n.justifyNumberBoundaries=function(){var t=this;this.Master.bulkEdit((function(){var e=t.Master.Model,n=Object(x.a)(e.NumberMinBoundary)||"1",r=Object(x.a)(e.NumberMaxBoundary)||"10";switch(e.NumberValidationRule){case B.Greater:case B.GreaterOrEqual:case B.Equal:case B.NotEqual:r=null;break;case B.Less:case B.LessOrEqual:n=null;break;case B.Between:case B.NotBetween:if(parseFloat(n)>parseFloat(r)){var i=n;n=r,r=i}}e.NumberMinBoundary=n,e.NumberMaxBoundary=r}))},n.getValidationErrorMessage=function(){var t;switch(this.Model.FormsProValidationType){case U.Email:t=Object(w.a)().bnljgkk;break;case U.Custom:t=this.Model.FormsProCustomPlaceholder?this.Model.FormsProCustomPlaceholder:Object(w.a)().offppfk;break;default:t=this.getNumberValidationErrorMessage()}return t},n.getNumberValidationErrorMessage=function(t){var e=this.Model.NumberValidationRule;if(null!=e)return function(t){var e=Object(w.a)();switch(t){case"Between":return e.dddfkpm;case"Equal":return e.iligeon;case"Greater":return e.obnahde;case"GreaterOrEqual":return e.jknandk;case"Less":return e.flgjdme;case"LessOrEqual":return e.cofbbmf;case"None":return e.elpiaki;case"NotBetween":return e.mcdldln;case"NotEqual":return e.cafgceo;default:return""}}(B[e]).format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)},n.hasCorrectAnswers=function(t){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new D.a(t||this.Model).areAnyAnswersDefined()},n.isCorrectAnswer=function(e){return this.Model.IsQuiz&&!this.Model.Multiline?new D.a(this.Model).isCorrect(e):t.prototype.isCorrectAnswer.call(this,e)},n.createQuizResult=function(t){if(new D.a(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(e){if(this.Model.IsQuiz&&!this.Model.Multiline){var n=new D.a(this.Model);if(n.areAnyAnswersDefined()){var r=this.Model.Point?this.Model.Point:0;e.Score=n.isCorrect(e.Answer)?r:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(e,n){return n?this.Model.IsQuiz&&!this.Model.Multiline?n.IsAnswerCorrect?this.Model.Point:0:t.prototype.autoGradeWithQuizResult.call(this,e,n):null},n.It=function(t,e){return void 0===t||""===t||!!e.test(t)},n.wt=function(t){if(void 0===t||""===t)return!0;if(!Object(x.b)(t))return!1;var e=parseFloat(Object(x.a)(t)),n=parseFloat(this.Model.NumberMinBoundary),r=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case B.None:return!0;case B.Between:return e>=n&&e<=r;case B.NotBetween:return!(e>=n&&e<=r);case B.Greater:return e>n;case B.GreaterOrEqual:return e>=n;case B.Less:return e<r;case B.LessOrEqual:return e<=r;case B.Equal:return e===n;case B.NotEqual:return e!==n;default:return!0}},n.deserializeAnswer=function(t){if(this.Model.IsMathQuiz&&t&&""!=t){var e=Object(l.w)(t);return this.Model.IsAnswerPlainText=!e.IsMath,null==e.Answer?t:e.Answer}return t},e}(I.a);var E=n(23),A=n(15),_=function(){function t(t,e){this.St=t,this.I=Object(E.b)(this.St.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.St.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.St.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionType",{get:function(){return this.St.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.St.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&t.hasSection()}},enumerable:!1,configurable:!0}),e.add=function(t){var e=this;if(this.St.Form.SyncContext===A.a.DesignTimeForm){var n=this.St.ParentQuestionMaster;return n?n.Synchronizer.existingInDataSource().then((function(){return e.Ft(t)})):this.Ft(t)}Object(u.b)("Trying to create a question without design type.")},e.delete=function(t){var e=this;this.St.Form.SyncContext!==A.a.DesignTimeForm&&Object(u.b)("Trying to delete a question without design type.");var n=this.St.ParentQuestionMaster;if(n&&n.Deleted)return $.Deferred().resolve().promise();var r=this.St.SubQuestionMasters.map((function(t){return t.Synchronizer.flush()}));return $.when.apply($,r).then((function(){return e.St.createSyncJob((function(){return e.I.deleteFormQuestion(e.FormId,t.id,e.QuestionType,e.ExtraQosData)}))})).then(null,(function(t){return t&&621===t.innerCode?$.Deferred().resolve().promise():t}))},e.query=function(t){Object(u.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this;if(this.St.Form.SyncContext!==A.a.DesignTimeForm)return $.Deferred().resolve().promise();if("id"in t){var r=t.id,i=e.ValuesBefore.id;h.a.logData({errorName:"DataSourceUpdatingQuestionId",errorInfo:{newId:r,oldId:i}})}if(null===t.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(t){h.a.logData({errorName:"DataSourceUpdatingQuestionNullAllowMultipleValues",errorInfo:{stack:t.stack}})}return this.St.createUploadSyncJob((function(){return n.I.updateFormQuestion(n.FormId,n.QuestionId,n.QuestionType,t,n.ExtraQosData)}))},e.Ft=function(t){var e=this,n=this.St.createSyncJob((function(){return e.I.createFormQuestion(e.FormId,t,e.ExtraQosData)})).then((function(t){var e=t;return e.FileUploadSPOInfo&&(t.fileUploadSPOInfo={driveId:e.FileUploadSPOInfo.DriveId,errorCode:e.FileUploadSPOInfo.ErrorCode,folderId:e.FileUploadSPOInfo.FolderId,linkInfo:e.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:e.FileUploadSPOInfo.anonymousLinkInfo}),t}));return n.done((function(t){"id"in t&&t.id!==e.QuestionId&&h.a.logData({errorName:"ChangedIdFromServerSide",errorInfo:{newId:t.id,oldId:e.QuestionId,formId:e.FormId}})})),n},t}();var U,B,Q,q,V,z,G={Id:c.a.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:c.a.reference({SourceFieldName:"defaultValue"}),ImageInfo:c.a.fromMasterClass(s.f,{SourceFieldName:"image"}),ImageSettings:c.a.fromMasterClass(s.g,{IsLocalField:!0}),Order:c.a.number({SourceFieldName:"order"}),QuestionInfo:c.a.string({SourceFieldName:"questionInfo"}),Required:c.a.boolean({SourceFieldName:"required"}),Subtitle:c.a.string({SourceFieldName:"subtitle"}),CombinedTitle:c.a.string({SourceFieldName:"title"}),Type:c.a.reference({SourceFieldName:"type"}),GroupId:c.a.string({SourceFieldName:"groupId"}),ShowSubtitle:c.a.boolean({IsLocalField:!0}),Hidden:c.a.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:c.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:c.a.boolean({IsLocalField:!0}),FormsProRTSubtitle:c.a.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:c.a.boolean({IsLocalField:!0}),FormsProAnswerTag:c.a.string({IsLocalField:!0}),FormsProAnswerTagHasError:c.a.boolean({IsLocalField:!0}),Title:c.a.string({IsLocalField:!0}),BranchInfo:c.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),IntegratedSavingState:c.a.reference({IsLocalField:!0}),SavingState:c.a.reference({IsLocalField:!0}),IsQuiz:c.a.boolean({SourceFieldName:"isQuiz"}),GradingBasis:c.a.string({IsLocalField:!0}),Point:c.a.number({IsLocalField:!0}),ChoiceType:c.a.reference({IsLocalField:!0}),Choices:c.a.collectionOf({Description:c.a.string(),BranchInfo:c.a.fromMasterClass((function(){return d.a})),IsAnswerKey:c.a.boolean(),AnswerHint:c.a.string(),IsGenerated:c.a.boolean(),IsMathOption:c.a.boolean(),FormsProDisplayRTText:c.a.string()},{IsLocalField:!0}),Hint:c.a.string({IsLocalField:!0}),AllowMultipleValues:c.a.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:c.a.boolean({IsLocalField:!0}),OptionDisplayStyle:c.a.enumeration((function(){return z}),{IsLocalField:!0}),ShuffleOptions:c.a.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:c.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),ChoiceGroup:c.a.collectionOf((function(){return O.a}),{SourceFieldName:"choices"}),Length:c.a.number({IsLocalField:!0}),RatingShape:c.a.enumeration((function(){return q}),{IsLocalField:!0}),LeftDescription:c.a.string({IsLocalField:!0}),RightDescription:c.a.string({IsLocalField:!0}),FormsProRTLeftDescription:c.a.string({IsLocalField:!0}),FormsProRTRightDescription:c.a.string({IsLocalField:!0}),ShowRatingLabel:c.a.boolean({IsLocalField:!0}),MinRating:c.a.number({IsLocalField:!0}),FormsProSmileyList:c.a.string({IsLocalField:!0}),Multiline:c.a.boolean({IsLocalField:!0}),IsNumber:c.a.boolean({IsLocalField:!0}),HasTFRestrictionForPro:c.a.boolean({IsLocalField:!0}),Placeholder:c.a.string({IsLocalField:!0}),NumberValidationRule:c.a.enumeration((function(){return B}),{IsLocalField:!0}),FormsProValidationType:c.a.enumeration((function(){return U}),{IsLocalField:!0}),NumberMinBoundary:c.a.string({IsLocalField:!0}),NumberMaxBoundary:c.a.string({IsLocalField:!0}),FormsProCustomRegEx:c.a.string({IsLocalField:!0}),FormsProCustomPlaceholder:c.a.string({IsLocalField:!0}),Date:c.a.boolean({IsLocalField:!0}),Time:c.a.boolean({IsLocalField:!0}),FileUploadSPOInfo:c.a.create({anonymousLinkInfo:c.a.string(),driveId:c.a.string(),folderId:c.a.string(),errorCode:c.a.string(),linkInfo:c.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:c.a.create({Word:c.a.boolean(),Excel:c.a.boolean(),PowerPoint:c.a.boolean(),PDF:c.a.boolean(),Image:c.a.boolean(),Video:c.a.boolean(),Audio:c.a.boolean()},{IsLocalField:!0}),MaxFileCount:c.a.number({IsLocalField:!0}),MaxFileSize:c.a.number({IsLocalField:!0}),HasSpecificFileType:c.a.boolean({IsLocalField:!0}),CoAuthors:c.a.collectionOf(c.a.reference(),{IsLocalField:!0}),IsMathQuiz:c.a.boolean({IsLocalField:!0}),IsPlainTextInMathField:c.a.boolean({IsLocalField:!0}),IsAnswerPlainText:c.a.boolean({IsLocalField:!0}),IsMathInputDefault:c.a.boolean({IsLocalField:!0}),InputSwitcherDisabled:c.a.boolean({IsLocalField:!0}),MathPatterns:c.a.collectionOf(c.a.string(),{IsLocalField:!0}),MathAriaLabels:c.a.collectionOf(c.a.string(),{IsLocalField:!0}),LastMathMLFormula:c.a.string({IsLocalField:!0}),VideoInfo:c.a.create({Url:c.a.string(),Title:c.a.string(),Author:c.a.string(),Thumbnail_url:c.a.string(),OriginalWidth:c.a.number(),OriginalHeight:c.a.number(),ShowWarningBar:c.a.boolean()},{IsLocalField:!0}),TrackingId:c.a.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:c.a.string({SourceFieldName:"questionTagForIntelligence"}),IsFromSuggestion:c.a.boolean({SourceFieldName:"isFromSuggestion"})};!function(t){t[t.Number=0]="Number",t[t.Email=1]="Email",t[t.Custom=2]="Custom"}(U||(U={})),function(t){t[t.None=0]="None",t[t.Greater=1]="Greater",t[t.GreaterOrEqual=2]="GreaterOrEqual",t[t.Less=3]="Less",t[t.LessOrEqual=4]="LessOrEqual",t[t.Equal=5]="Equal",t[t.NotEqual=6]="NotEqual",t[t.Between=7]="Between",t[t.NotBetween=8]="NotBetween",t[t.Max=9]="Max"}(B||(B={})),function(t){t[t.SingleChoice=1]="SingleChoice",t[t.MultiChoice=2]="MultiChoice"}(Q||(Q={})),function(t){t[t.Number=0]="Number",t[t.Star=1]="Star",t[t.Smiley=2]="Smiley"}(q||(q={})),function(t){t[t.Success=0]="Success",t[t.RequiredError=1]="RequiredError",t[t.NumberValidationError=2]="NumberValidationError",t[t.QuizWrongChoiceError=3]="QuizWrongChoiceError",t[t.MathLengthError=4]="MathLengthError",t[t.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",t[t.RegExValidationError=6]="RegExValidationError"}(V||(V={})),function(t){t[t.Dropdown=0]="Dropdown",t[t.ListAll=1]="ListAll"}(z||(z={}));G.Choices[0],G.ChoiceGroup[0];function H(t){return o.a.getObjectMasterFromModel(t)}var W=function(t){function e(n){var r,c,s=this,a=$.Deferred();return n.InitialData?(e.resolveQuestionNullTypeIssue(n.InitialData),(n=i.clone(n)).InitialData=i.clone(n.InitialData),void 0!==n.InitialData.CombinedTitle?(r=n.InitialData,(c=r.CombinedTitle)&&(c=c.split("⁣")[0]),r.Title=c):function(t){if(t.IsMathQuiz&&t.Subtitle){var e=t.Title||"";t.CombinedTitle=e+"⁣"+t.Subtitle}else t.CombinedTitle=t.Title}(n.InitialData)):Object(u.b)("Question model should created with initial data."),(s=t.call(this,n,{MasterReady:a.promise(),Scheduler:new m.a(e.name)})||this).fieldsReady([e.Schema.ChoiceGroup]).done((function(){o.a.Collection.setComparer(s.Model.ChoiceGroup,(function(t,e){return t.Order-e.Order}))})),s.yt(n),Object(v.d)(s,e.Schema.ImageInfo,e.Schema.ImageSettings),s.Nt(n),s.redressGradingBasis(),s.coAuthorTimers={},s.initializing=a,s}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(b.c)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(v.e)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var t=this.Model.GroupId;return t&&this.Form.getQuestionById(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestionMasters",{get:function(){var t=this;return this.Form.FormElementManager.QuestionMasters.filter((function(e){return e.Model.GroupId===t.Model.Id}))},enumerable:!1,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.hasValidVideoUrl=function(){return Object(l.s)()?this.Tt()&&Object(f.c)(this.Model.VideoInfo.Url):this.Tt()&&Object(f.d)(this.Model.VideoInfo.Url)},n.createSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n).then((function(){return e.Form.getQuestionSyncBlocker(r)})).then(t);return n.resolve(),r},n.createUploadSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n,this.kt).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.kt=Object(a.a)(r),r},n.getMethodDelegator=function(){var t=this.Model.Type;this.Pt=this.Pt||(this.Pt={});var e=this.Pt[t];e||(e=new(function(t){switch(t){case"Question.Choice":return j.a;case"Question.TextField":return R;case"Question.DateTime":return S;case"Question.Rating":return L;case"Question.Ranking":return C;case"Question.MatrixChoice":return N;case"Question.MatrixChoiceGroup":return T;case"Question.NPS":return k;case"Question.FileUpload":return y;default:throw Error(t+" is not supported")}}(t))(this),this.Pt[t]=e);return e},n.getChoiceById=function(t){var e=o.a.Collection.getItemWithKeyFields(this.Model.ChoiceGroup,{Id:t});return e&&o.a.getObjectMasterFromModel(e)},n.getChoiceByKey=function(t){var e=i.find(this.Model.ChoiceGroup,(function(e){return e.Key===t}));return e&&Object(O.b)(e)},n.yt=function(t){this.Ct=new g.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Ct.deserialize():this.Ct.serialize()),this.justifyQuestionInfo()},n.Nt=function(t){!t.ExistingInDataSource&&t.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},n.hasRuntimeError=function(){var t=this.Model.FileUploadSPOInfo;return!!t&&!(!this.Form.SettingMaster.Model.IsAnonymous||!t.anonymousLinkInfo)},n.Tt=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new p.a([e.Schema.VideoInfo,e.Schema.ShowSubtitle,e.Schema.Hidden,e.Schema.BranchInfo,e.Schema.ShowRatingLabel,e.Schema.Point,e.Schema.FormsProCalculateSentiment,e.Schema.ImageSettings,e.Schema.GradingBasis,e.Schema.ChoiceType,e.Schema.Choices,e.Schema.Hint,e.Schema.AllowOtherAnswer,e.Schema.OptionDisplayStyle,e.Schema.ShuffleOptions,e.Schema.BranchInfoForOtherChoice,e.Schema.Length,e.Schema.RatingShape,e.Schema.LeftDescription,e.Schema.RightDescription,e.Schema.Multiline,e.Schema.IsNumber,e.Schema.Placeholder,e.Schema.NumberValidationRule,e.Schema.NumberMinBoundary,e.Schema.NumberMaxBoundary,e.Schema.Date,e.Schema.Time,e.Schema.IsMathQuiz,e.Schema.IsPlainTextInMathField,e.Schema.IsAnswerPlainText,e.Schema.InputSwitcherDisabled,e.Schema.IsMathInputDefault,e.Schema.MathPatterns,e.Schema.MathAriaLabels,e.Schema.HasSpecificFileType,e.Schema.FileTypes,e.Schema.MaxFileCount,e.Schema.MaxFileSize,e.Schema.MinRating,e.Schema.FormsProRTLeftDescription,e.Schema.FormsProRTRightDescription,e.Schema.FormsProEnableAnswerTag,e.Schema.FormsProAnswerTag,e.Schema.FormsProAnswerTagHasError,e.Schema.HasTFRestrictionForPro,e.Schema.FormsProValidationType,e.Schema.FormsProCustomRegEx,e.Schema.FormsProCustomPlaceholder,e.Schema.FormsProSmileyList])),e.questionInfoFieldSet},enumerable:!1,configurable:!0}),e.resolveQuestionNullTypeIssue=function(t){if(!t.Type){var e={choiceType:t.ChoiceType,date:t.Date,time:t.Time,ratingShape:t.RatingShape,multiline:t.Multiline};t.Type=null!=e.choiceType?"Question.Choice":null!=e.date||null!=e.time?"Question.DateTime":e.ratingShape?"Question.Rating":"Question.TextField",h.a.logData({errorName:"QuestionNullTypeError",errorInfo:{message:"question type resolved",conditions:e,resolvedType:t.Type}})}},e.getSourceFields=function(t){return i.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e}(o.a.createObjectMasterClass("QuestionMaster",G,(function(t,e){return new _(t,e)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(t){W.prototype[t]=function(){var e=this.getMethodDelegator();return e[t].apply(e,arguments)}}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"j",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"g",(function(){return f})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return d}));var r=n(18);function i(){return r.a.Resolve("IMixin").getMixinFormMaster()}function o(){return r.a.Resolve("IMixin").getMixinFormMaster()}function u(){return r.a.Resolve("IMixin").getMixinImageInfoMaster()}function c(){return r.a.Resolve("IMixin").getMixinQuestionMaster()}function s(){return r.a.Resolve("IFormApiMixin").getMixinFormApi()}function a(){return r.a.Resolve("IMixin").getMixinFormElementManager()}function f(){return r.a.Resolve("IMixin").getMixinImageSettingsMaster()}function l(){return r.a.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function h(){return r.a.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function d(){return r.a.Resolve("IMixin").getFileUploadConfirmDialog()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(16),i=function(){function t(){}t.prototype;return t.logData=function(t){Object(r.a)({eventName:t.name,eventType:"engagement_event",extraData:t.extraData})},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return c}));n(4);var r=n(54),i=n(34),o=(n(22),n(12));n(53);function u(t){if(!t.isFieldReady(o.a.Schema.OwnerTenantId)||!t.isFieldReady(o.a.Schema.OwnerId))return i.a.getInstance().createDataProvider();var e=1;if(t.IsGroupForm)e=3;else{if(!t.Model.OwnerTenantId||!t.Model.OwnerId)return null;e=2}return i.a.getInstance().createDataProvider(e,t.Model.OwnerTenantId,t.Model.OwnerId)}function c(t){var e=Object(r.a)(t),n=1;return e.IsGroupOwner?n=3:e.OrgId&&e.OwnerId&&(n=2),i.a.getInstance().createDataProvider(n,e.OrgId,e.OwnerId)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"j",(function(){return b})),n.d(e,"f",(function(){return v})),n.d(e,"l",(function(){return g})),n.d(e,"h",(function(){return p})),n.d(e,"m",(function(){return O})),n.d(e,"i",(function(){return j})),n.d(e,"c",(function(){return w})),n.d(e,"k",(function(){return I})),n.d(e,"e",(function(){return S}));var r,i=n(5),o=n(14);!function(t){t[t.signup=1]="signup"}(r||(r={}));var u,c,s,a="auth_pvr",f=!1;function l(){return s||h()}function h(){var t=s||Object(o.c)().Host||Object(o.b)().Host;switch(t){case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":case"ODC":return t;default:return null}}function d(){return u||Object(o.c)().groupId||Object(o.b)().groupId}function m(){return c||Object(o.c)().tid||Object(o.b)().tid}function b(){return!!h()||!!Object(i.a)().isOembedSPO}function v(){var t=Object(o.c)().route;if(t){var e=t.toLowerCase();switch(e){case"start":case"appitems":case"groupitems":return e;default:return}}}function g(){return"Teams"===l()&&"undefined"!=typeof microsoftTeams}function p(){return"Assignments"===l()}function O(){return"Union"===l()}function j(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function w(){return g()||p()||"Stream"===l()||"StreamMobile"===l()}function I(){return"PowerPointTaskpane"===l()||"PowerPointContent"===l()}function S(){return f}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18);function i(){return r.a.Resolve("IPageContext")}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"f",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return f}));var r=n(65);function i(t){return l().then((function(){window.location.assign(t)}))}function o(){return c(!1)}function u(){return c(!0)}function c(t){return l().then((function(){window.location.reload(t)}))}function s(t){return l().then((function(){window.location.replace(t)}))}function a(t){return l().then((function(){var e=window.location,n=e.origin+t+e.search+e.hash;window.location.replace(n)}))}function f(t){h.push(t)}function l(){var t=h;h=[];var e=$.when.apply($,t.map((function(t){return Object(r.a)(t())})));return h.push((function(){return e})),e}var h=[]},function(t,e){t.exports=ReactDOM},function(t,e,n){"use strict";n.d(e,"j",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"k",(function(){return s})),n.d(e,"h",(function(){return a})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"i",(function(){return d})),n.d(e,"l",(function(){return m}));n(25),n(7),n(5);function r(){return 1e3}function i(){return 4e3}function o(){return 1e3}function u(){return 800}function c(){return 600}function s(){return 719}function a(){return 320}function f(){return 240}function l(){return 422}function h(){return 5242880}function d(){return 3e3}function m(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/}},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return s}));var r=n(2),i=n(1),o=n(3),u=n(10);function c(t){return i.createElement(s,Object(r.a)({},t))}var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=o.clone(this.props.HTMLAttributes)||{};return t.className=Object(u.a)("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",t.className),this.props.Accessible||(t.role="presentation",t["aria-hidden"]="true"),i.createElement("i",Object(r.a)({},t))},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(3);function i(){return t=[u()+u(),u(),u(),u(),u()+u()+u()].join("-"),e=parseInt(t.charAt(19),16),n=(e=3&e|8).toString(16),t=c(t,14,"4"),t=c(t,19,n);var t,e,n}function o(t){var e=t.match(/[0-9a-fA-F]*/g),n="";return r.map(e,(function(t){return n+=t})),!t||/^[0-]*$/.test(t)}function u(){return function(t,e,n){for(var r=t.length,i=n.length;r<e;r+=i)t=n+t;return t}(Math.floor(65536*Math.random()).toString(16),4,"0")}function c(t,e,n){return t.substring(0,e)+n+t.substring(e+1)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);function i(t,e){return t.__lazyComponentClass||(t.__lazyComponentClass=r.lazy(e)),t.__lazyComponentClass}},function(t,e,n){"use strict";var r=n(2),i=n(1),o=i.PureComponent,u=i.Suspense,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.children,n=t.fallback;return i.createElement(u,{fallback:n},e)},e.defaultProps={fallback:null},e}(o);e.a=c},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return I})),n.d(e,"c",(function(){return S})),n.d(e,"a",(function(){return F}));var r,i,o=n(2),u=n(3),c=n(4),s=n(0),a=n(19),f=n(30),l=n(21),h=n(34),d=n(48),m=n(49),b=n(12),v=n(20),g=n(23),p=function(){function t(t,e){this.Lt=t;var n,r=this.Lt.Parent;if(r instanceof b.a)n=r;else{if(!(r instanceof v.d||r instanceof m.a))throw"Wrong parent type of ImageInfoMaster.";n=r.Form}var i=n.IsGroupForm?3:2;this.I=Object(g.b)(n),this.Mt=h.a.getInstance().createImageProvider(i,n.Model.OwnerTenantId,n.Model.OwnerId);var o=c.a.getFieldSchemaInfo(t.Membership.FieldSchema);this.xt=o.Attributes.SourceFieldName||o.Name}var e=t.prototype;return e.add=function(t){var e=$.Deferred();return window.setTimeout((function(){e.resolve()})),e.promise()},e.delete=function(t){return Object(a.b)("not supported")},e.query=function(t){return Object(a.b)("not supported")},e.update=function(t){var e,n=t.uploadParameters;return n?(n.Delete?e=this.Dt():n.ImageFile?e=this.Rt(n.ImageFile):n.Url&&(e=this.Et(n.Url,n.Size)),e?e.then((function(t){var e=u.clone(t);return e.uploadParameters=null,e})):void 0):this.At()},e.At=function(){var t=this,e=c.a.convertToSourceData(this.Lt.getSnapshot(),Object(l.f)().Schema);delete e.uploadParameters;var n,r={};r[this.xt]=e;var i=this.Lt.Parent;if(i instanceof b.a)n=this.I.updateForm(i.Model.Id,r);else{if(!(i instanceof v.d||i instanceof m.a))return Object(a.b)("not supported");var o=i;n=o.createUploadSyncJob((function(){return t.I.updateFormQuestion(o.Form.Model.Id,o.Model.Id,o.Model.Type,r)}))}return n.then((function(e){return e&&e[t.xt]}))},e.Et=function(t,e){var n=this,r={SourceUrl:t,Title:Object(f.b)(),Size:e},i=this.Lt.Parent;if(i instanceof b.a)return this.I.createFormImageFromUrl(i.Model.Id,this.xt,r);if(i instanceof v.d||i instanceof m.a){var o=i;return o.createUploadSyncJob((function(){return n.I.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,r)}))}return Object(a.b)("not supported")},e.Rt=function(t){var e=this,n={ImageBlob:t,ImageName:Object(f.b)(),ImageType:t.type},r=this.Lt.Parent;if(r instanceof b.a)return this.Mt.uploadFormImage(r.Model.Id,this.xt,n);if(r instanceof v.d||r instanceof m.a){var i=r;return i.createUploadSyncJob((function(){return e.Mt.uploadQuestionImage(i.Form.Model.Id,i.Model.Id,e.xt,n)}))}return Object(a.b)("not supported")},e.Dt=function(){var t,e=this,n=this.Lt.Parent;if(n instanceof b.a)t=this.Mt.deleteFormImage(n.Model.Id,this.xt);else{if(!(n instanceof v.d||n instanceof m.a))return Object(a.b)("not supported");var r=n;t=r.createUploadSyncJob((function(){return e.Mt.deleteQuestionImage(r.Form.Model.Id,r.Model.Id,e.xt)}))}return t.then(null,(function(t){return t&&805===t.innerCode?(d.a.logData({errorName:"DeleteImageNotFoundError",errorInfo:{imageUrl:e.Lt.Model.ResourceUrl}}),$.Deferred().resolve().promise()):t})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},t}(),O=n(46),j=n(50),w={AltText:s.a.string({SourceFieldName:"altText"}),ContentType:s.a.string({SourceFieldName:"contentType"}),FileIdentifier:s.a.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:s.a.string({SourceFieldName:"originalFileName"}),ResourceId:s.a.string({SourceFieldName:"resourceId"}),ResourceUrl:s.a.string({SourceFieldName:"resourceUrl"}),Width:s.a.number({SourceFieldName:"width"}),Height:s.a.number({SourceFieldName:"height"}),UploadParameters:s.a.reference({SourceFieldName:"uploadParameters"}),ErrorType:s.a.enumeration((function(){return i}),{IsLocalField:!0}),ResponseError:s.a.reference({IsLocalField:!0}),ImageProcessingStatus:s.a.enumeration((function(){return r}),{IsLocalField:!0}),IsPredefined:s.a.boolean({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0})};function I(t){if(!t)return!1;if(t.ResourceUrl)return!0;var e=t.UploadParameters;return!!e&&!!e.ImageFile}function S(t){return c.a.getObjectMasterFromModel(t)}!function(t){t[t.Idle=0]="Idle",t[t.Picking=1]="Picking",t[t.Uploading=2]="Uploading",t[t.Deleting=3]="Deleting"}(r||(r={})),function(t){t[t.NoError=0]="NoError",t[t.SizeTooLarge=1]="SizeTooLarge",t[t.InvalidType=2]="InvalidType",t[t.BrokenImage=3]="BrokenImage",t[t.ServerError=4]="ServerError",t[t.DeleteFailError=5]="DeleteFailError"}(i||(i={}));var F=function(t){function e(n){var o=this,c=$.Deferred(),s=!n.ExistingInDataSource&&n.InitialData&&!!n.InitialData.ResourceUrl,a=u.clone(n.InitialData);(n=u.clone(n)).InitialData=s?u.extend({},a,{ImageProcessingStatus:r.Uploading}):u.extend({},a,{UploadParameters:null,ErrorType:i.NoError,ResponseError:null,ImageProcessingStatus:r.Idle,Width:null,Height:null});var f=new O.a(e.name);f.setMaxRetryTimesForUpdate(0);var l=(o=t.call(this,n,{Scheduler:f,MasterReady:c.promise()})||this).Synchronizer;return l.observe((function(t){var e;u.contains(t.FieldSchemas,l.Schema.CreationError)?e=l.Model.CreationError:u.contains(t.FieldSchemas,l.Schema.UpdateError)&&(e=l.Model.UpdateError),e&&o.bulkEdit((function(){o.Model.ResponseError=e;var t=o.Model.UploadParameters;t&&t.Delete?o.Model.ErrorType=i.DeleteFailError:o.Model.ErrorType=i.ServerError}))}),[l.Schema.CreationError,l.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(t){!t.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(r.Idle)}}),o.initializing=c,o.duplicatingImage=s,o.originalInitialData=a,Object(j.b)(o),o}Object(o.c)(e,t);var n=e.prototype;return n.getSettingsMaster=function(){return this._t},n.setSettingsMaster=function(t){this._t=t},n.resetStatus=function(t){var e=this.Model;this.bulkEdit((function(){e.ErrorType=i.NoError,e.ResponseError=void 0,e.ImageProcessingStatus=t}))},e}(c.a.createObjectMasterClass("ImageInfoMaster",w,(function(t,e){return new p(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return g}));var r=n(11),i=n(5),o=n(21),u=n(7),c=n(42),s=n(41),a=n(30),f=n(26),l=n(25),h=n(72),d=n(70),m=function(){function t(t){for(this.Ut=t.trim();"/"===this.Ut.charAt(this.Ut.length-1);)this.Ut=this.Ut.substr(0,this.Ut.length-1)}var e=t.prototype;return e.deleteQuestionImage=function(e,n,r){var i=this;return b().then((function(o){return t.deleteImageInternal(o,i.$t(t.getQuestionImageUrl(e,n,r)))}))},e.uploadQuestionImage=function(e,n,r,i){var o=this;return b().then((function(u){return t.uploadImageInternal(u,o.$t(t.getQuestionImageUrl(e,n,r)),r,i)}))},e.deleteFormImage=function(e,n){var r=this;return b().then((function(i){return t.deleteImageInternal(i,r.$t(t.getFormImageUrl(e,n)))}))},e.uploadFormImage=function(e,n,r){var i=this;return b().then((function(o){return t.uploadImageInternal(o,i.$t(t.getFormImageUrl(e,n)),n,r)}))},t.getFormImageUrl=function(e,n){return t.formImageUrlPattern.format(e,n)},t.getQuestionImageUrl=function(e,n,r){return t.questionImageUrlPattern.format(e,n,r)},t.deleteImageInternal=function(e,n){var r=new h.a("Image.Delete");r.start();var i={type:"DELETE",url:n,headers:{Authorization:e?"Bearer "+e:"","X-CorrelationId":r.CorrelationId,"X-UserSessionId":Object(d.b)()}};return t.sendRequest(i,(function(){return r.end({resultType:"Success"})}),(function(t){var e={correlationId:r.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return r.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e}))},t.uploadImageInternal=function(e,n,r,i){var o=new h.a("Image.Upload");o.start();var u={type:"PUT",url:n,headers:{Authorization:e?"Bearer "+e:"","Content-Type":i.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(Object(a.b)(),i.ImageName),"X-CorrelationId":o.CorrelationId,"X-UserSessionId":Object(d.b)()},processData:!1,data:i.ImageBlob};return t.sendRequest(u,(function(t){if(!t||!t.resourceId){var e={correlationId:o.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};return o.end({resultType:"Failure",extraData:{imageUrl:n,error:e,imageType:r}}),$.Deferred().reject(e).promise()}o.end({resultType:"Success",extraData:{imageType:r}});var i={};return i.altText=t.altText,i.contentType=t.contentType,i.fileIdentifier=t.fileIdentifier,i.originalFileName=t.originalFileName,i.resourceId=t.resourceId,i.resourceUrl=t.resourceUrl,i.height=t.height,i.width=t.width,i}),(function(t){var e={correlationId:o.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return o.end({resultType:"Failure",extraData:{imageUrl:u.url,error:e}}),e}))},t.sendRequest=function(t,e,n){return Object(r.o)()&&(t.headers.__RequestVerificationToken=Object(i.a)().antiForgeryToken),$.ajax(t).then(e,(function(r){if(!Object(c.d)(r))return n(r);Object(l.a)().AuthContext.refreshToken().done((function(){Object(s.e)((function(){return t.headers.__RequestVerificationToken=Object(i.a)().antiForgeryToken,$.ajax(t).then(e,n)}),f.d)}))}))},e.$t=function(t){return this.Ut+"/"+t},t.formImageUrlPattern="forms('{0}')/{1}",t.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",t}();function b(){return Object(l.a)().AuthContext.getFormApiToken()}var v=function(){function t(){if(t.instance)return t.instance;t.instance=this,this.Bt=Object(r.d)()}var e=t.prototype;return t.getInstance=function(){return new t},e.getOwnerServiceUrl=function(t,e,n){return 1===t?this.getFormApiServiceUrl():4===t?this.getFormApiServiceUrl()+"me/":e&&n?this.getFormApiServiceUrl()+e+(3===t?"/groups/":"/users/")+n+"/":null},e.createDataProvider=function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null);var r=Object(o.d)();if(1===t)return this.defaultDataProvider||(this.defaultDataProvider=new r(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var i=this.getOwnerServiceUrl(t,e,n);return i&&new r(this.getFormApiServiceUrl(),i)},e.createImageProvider=function(t,e,n){if(void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null),1===t)return this.currentImageProvider||(this.currentImageProvider=new m(this.getFormApiServiceUrl())),this.currentImageProvider;var r=this.getOwnerServiceUrl(t,e,n);return r&&new m(r)},e.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},e.getCollabDBServiceUrl=function(){var t;return t=Object(r.r)()?Object(r.d)():Object(r.e)(),Object(r.c)(t)},e.getBaseServiceUrl=function(){if(!Object(r.r)())return"https://forms.office-int.com/";var t;switch(this.Bt){case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=Object(r.p)()?"https://forms.microsoft.com/":"https://forms.office.com/";break;case"WWProd":t=Object(u.c)((function(){return"https://forms.office.com/"}),u.e);break;case"MSProd":t="https://forms.microsoft.com/";break;case"ProTip":t="https://tip.forms.office.com/";break;case"CVProd":t="https://customervoice.microsoft.com/";break;default:t="https://"+window.location.host+"/"}return t},e.getServiceUrl=function(t){return this.getBaseServiceUrl()+t},t}();function g(){return v.getInstance().createDataProvider()}},function(t,e,n){"use strict";n.d(e,"h",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"a",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"f",(function(){return d})),n.d(e,"c",(function(){return m}));var r=n(11),i=n(54),o=null,u=null;function c(t){o=t}function s(){return o&&o()}function a(t){u=t}function f(){return u&&u()}function l(){var t=Object(i.a)(s()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(r.l)()}function h(){var t=Object(i.a)(s()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(r.k)()}function d(){var t=Object(i.a)(s()||"");return!!t.OrgId&&-1!==Object(r.g)().indexOf(t.OrgId.toLowerCase())}function m(){var t=s();return t&&Object(i.a)(t)}},function(t,e,n){"use strict";var r,i,o,u;n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return m}));var c=null,s=null;function a(){return r||(r=f())instanceof b&&(r=l()),r}function f(){return i||(i=d()?window.localStorage:h()),i}function l(){return o||(o=m()?window.sessionStorage:h()),o}function h(){return u||(u=new b),u}function d(){if(null==c)try{var t="officeforms.__storage_test__";window.localStorage.setItem(t,t),window.localStorage.removeItem(t),c=!0}catch(t){c=!1}return c}function m(){if(null==s)try{var t="officeforms.__storage_test__";window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t),s=!0}catch(t){s=!1}return s}var b=function(){function t(){}var e=t.prototype;return e.clear=function(){},e.getItem=function(t){},e.key=function(t){return null},e.removeItem=function(t){},e.setItem=function(t,e){},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1),i=n(6),o={};Object.defineProperty(o,"LocalizedStrings",{get:i.a});var u=r.createContext(o)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),i=n(4),o=function(){function t(t){this.Qt=t}var e=t.prototype;return t.supportMobileDesign=function(t){return!1},t.hasInvalidSettingOnMobile=function(t){return t.ShowSubtitle||!!t.ImageInfo.ResourceUrl||!!t.VideoInfo.Url},Object.defineProperty(e,"Master",{get:function(){return this.Qt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Model",{get:function(){return this.Qt.Model},enumerable:!1,configurable:!0}),e.isEmpty=function(t){return!t},e.justifyNumberBoundaries=function(){throw Error("to be overridden")},e.supportsQuestionLevelBranching=function(){return!0},e.supportsChoiceLevelBranching=function(){return!1},e.getBranchedResult=function(t,e){var n=this.getBranchingResult(t);switch(n.Type){case"Next":n.TargetElement=e}return n},e.isNumberType=function(){return!1},e.getNumberValidationErrorMessage=function(t){throw Error("to be overridden")},e.getValidationErrorMessage=function(){throw Error("to be overridden")},e.getSnapshotWithoutBranchInfo=function(){var t=r.clone(this.Master.getSnapshot());return delete t.BranchInfo,delete t.BranchInfoForOtherChoice,t},e.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},e.insertChoice=function(t,e){},e.getNormalizedAnswer=function(t){return t},e.hasAnswer=function(){return!0},e.hasCorrectAnswers=function(t){return!1},e.isCorrectAnswer=function(t){return!1},e.setAnswerKey=function(t,e){},e.createQuizResult=function(t){return null},e.autoGradeAnswer=function(t){var e=!this.Model.Point,n=null==t.Answer||""===t.Answer;(e||n)&&(t.Score=0,t.IsAutoGraded=!0)},e.autoGradeWithQuizResult=function(t,e){var n=this.Master.Parent;return(n&&n.Model||this.Model).Point||(null==t||""===t)?0:null},e.serializeAnswer=function(t){return t},e.deserializeAnswer=function(t){return t},e.justifyQuestionInfo=function(){},e.showAsDropdown=function(){},e.redressGradingBasis=function(){},e.getBranchInfoMaster=function(t){return i.a.getObjectMasterFromModel(t)},e.getBranchingResult=function(t){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},t}()},function(t,e,n){"use strict";n.d(e,"d",(function(){return C})),n.d(e,"f",(function(){return L})),n.d(e,"g",(function(){return M})),n.d(e,"e",(function(){return x})),n.d(e,"c",(function(){return D})),n.d(e,"b",(function(){return R})),n.d(e,"a",(function(){return E}));var r,i,o,u,c,s,a,f,l,h,d,m,b,v,g,p,O,j,w,I=n(3),S=n(11),F=n(24),y=n(5),N=n(16),T=n(34),k=n(2),P=function(t){function e(){var n=this;return e.instance?e.instance:((n=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),e.instance=n,n)}Object(k.c)(e,t);var n=e.prototype;return e.getInstance=function(){return new e},n.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchDeferred.resolve(t)}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;T.a.getInstance().createDataProvider().getUserInfo().done((function(e){return t.prefetchDeferred.resolve(e)})).fail((function(e){return t.prefetchDeferred.reject(e)}))},e}(n(94).a);function C(){return A().then((function(){return d}),(function(){return $.Deferred().resolve(!1).promise()}))}function L(){var t=Object(y.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(S.k)())}function M(){var t=Object(y.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(S.l)())}function x(){var t=Object(y.a)().userInfo.TenantId;return t&&-1!==Object(S.g)().indexOf(t.toLowerCase())}function D(){return A().then((function(){var t=0;return d&&(t=1),m&&(t|=2),M()&&(t|=8),L()&&(t|=b?16:4),v&&(t|=64,g?t|=128:O?t|=256:p&&(t|=512)),t}),(function(){return 0}))}function R(){return j||(j=$.Deferred(),$(document).ready((function(){T.a.getInstance().createDataProvider().getDataClassificationLabels().then((function(t){j.resolve(t)}),(function(t){return j.reject(t)})),j.fail((function(t){Object(N.a)({eventName:"TenantDataClassificationLevelsGetFailure",eventType:"error_event",extraData:t})}))}))),j.promise()}function E(t,e){if(!w){var n=T.a.getInstance().createDataProvider();(w=n.getDataClassificationLabelDetail(t,e)).fail((function(t){Object(N.a)({eventName:"TenantDataClassificationLevelDetailGetFailure",eventType:"error_event",extraData:t})}))}return w}function A(){return h||(h=$.Deferred(),$(document).ready((function(){if(Object(y.a)().userInfo.UserId||Object(F.i)()||Object(F.l)())try{var t=Object(y.a)().userLicenseInfo;(null==t?void 0:t.id)?_(t.licenses,t.isPaidUser):P.getInstance().getPromise().then((function(t){_(t.licenses,t.isPaidUser)})).fail(h.reject)}catch(t){h.reject(t)}else h.resolve({});h.fail((function(t){Object(N.a)({eventName:"UserInfoGetFailure",eventType:"error_event",extraData:t})}))}))),h.promise()}function _(t,e){var n=I.object(t.map((function(t){var e=t.licenseName,n=t.skus;return[e,JSON.parse(n)]})));!function(t){for(var e in r)if(t.hasOwnProperty(r[e])){var n=t[r[e]];if(n&&n.length>0)return void(d=!0)}d=!1}(n),function(t){for(var e in i)if(t.hasOwnProperty(i[e])){var n=t[i[e]];if(n&&n.length>0)return m=!0,void parseInt(e)}m=!1}(n),function(t){for(var e in o){if(t.hasOwnProperty(o[e]))if((n=t[o[e]])&&n.length>0){!0,parseInt(e);break}}for(var e in u){if(t.hasOwnProperty(u[e]))if((n=t[u[e]])&&n.length>0){parseInt(e);break}}for(var e in c){var n;if(t.hasOwnProperty(c[e]))if((n=t[c[e]])&&n.length>0){parseInt(e);break}}}(n),function(t){b=!(!L()||!t)}(e),function(t){for(var e in s)if(t.hasOwnProperty(s[e])){var n=t[s[e]];if(n&&n.length>0)return void(v=!0)}v=!1}(n),function(t){for(var e in a){if(t.hasOwnProperty(a[e]))(n=t[a[e]])&&n.length>0&&(g=!0)}for(var e in f){if(t.hasOwnProperty(f[e]))(n=t[f[e]])&&n.length>0&&(O=!0)}for(var e in l){var n;if(t.hasOwnProperty(l[e]))(n=t[l[e]])&&n.length>0&&(p=!0)}}(n),h.resolve(n)}!function(t){t[t.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",t[t.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(r||(r={})),function(t){t[t.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",t[t.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",t[t.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",t[t.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(i||(i={})),function(t){t[t.FORMS_GOV_E1=0]="FORMS_GOV_E1",t[t.FORMS_GOV_E3=1]="FORMS_GOV_E3",t[t.FORMS_GOV_E5=2]="FORMS_GOV_E5",t[t.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(t){t[t.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",t[t.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",t[t.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",t[t.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(u||(u={})),function(t){t[t.FORMS_DOD_E1=0]="FORMS_DOD_E1",t[t.FORMS_DOD_E3=1]="FORMS_DOD_E3",t[t.FORMS_DOD_E5=2]="FORMS_DOD_E5",t[t.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(c||(c={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO",t[t.Forms_Pro_USL=1]="Forms_Pro_USL",t[t.Forms_Pro_USL_GCC=2]="Forms_Pro_USL_GCC",t[t.Forms_Pro_CE=3]="Forms_Pro_CE",t[t.Forms_Pro_Service=4]="Forms_Pro_Service",t[t.Forms_Pro_FS=5]="Forms_Pro_FS",t[t.Forms_Pro_Marketing=6]="Forms_Pro_Marketing",t[t.Forms_Pro_Plan=7]="Forms_Pro_Plan",t[t.Forms_Pro_PS=8]="Forms_Pro_PS",t[t.Forms_Pro_SalesEnt=9]="Forms_Pro_SalesEnt",t[t.Forms_Pro_Talent=10]="Forms_Pro_Talent",t[t.Forms_Pro_Operations=11]="Forms_Pro_Operations",t[t.Forms_Pro_Relationship_Sales=12]="Forms_Pro_Relationship_Sales",t[t.Forms_Pro_Customer_Insights=13]="Forms_Pro_Customer_Insights",t[t.Forms_Pro_Service_GCC=14]="Forms_Pro_Service_GCC",t[t.Forms_Pro_FS_GCC=15]="Forms_Pro_FS_GCC",t[t.Forms_Pro_Human_Resources_GCC=16]="Forms_Pro_Human_Resources_GCC",t[t.Forms_Pro_PS_GCC=17]="Forms_Pro_PS_GCC",t[t.Forms_Pro_SalesEnt_GCC=18]="Forms_Pro_SalesEnt_GCC"}(s||(s={})),function(t){t[t.Forms_Pro_USL=0]="Forms_Pro_USL",t[t.Forms_Pro_USL_GCC=1]="Forms_Pro_USL_GCC"}(a||(a={})),function(t){t[t.Forms_Pro_CE=0]="Forms_Pro_CE",t[t.Forms_Pro_Service=1]="Forms_Pro_Service",t[t.Forms_Pro_FS=2]="Forms_Pro_FS",t[t.Forms_Pro_Marketing=3]="Forms_Pro_Marketing",t[t.Forms_Pro_Plan=4]="Forms_Pro_Plan",t[t.Forms_Pro_PS=5]="Forms_Pro_PS",t[t.Forms_Pro_SalesEnt=6]="Forms_Pro_SalesEnt",t[t.Forms_Pro_Talent=7]="Forms_Pro_Talent",t[t.Forms_Pro_Operations=8]="Forms_Pro_Operations",t[t.Forms_Pro_Relationship_Sales=9]="Forms_Pro_Relationship_Sales",t[t.Forms_Pro_Customer_Insights=10]="Forms_Pro_Customer_Insights",t[t.Forms_Pro_Service_GCC=11]="Forms_Pro_Service_GCC",t[t.Forms_Pro_FS_GCC=12]="Forms_Pro_FS_GCC",t[t.Forms_Pro_Human_Resources_GCC=13]="Forms_Pro_Human_Resources_GCC",t[t.Forms_Pro_PS_GCC=14]="Forms_Pro_PS_GCC",t[t.Forms_Pro_SalesEnt_GCC=15]="Forms_Pro_SalesEnt_GCC"}(f||(f={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO"}(l||(l={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return v})),n.d(e,"b",(function(){return g}));var r,i,o=n(2),u=n(3),c=n(4),s=n(0),a=n(28),f=n(5),l=n(25),h=n(12),d=n(33),m={TargetResourceId:s.a.string(),Layout:s.a.enumeration((function(){return r})),Size:s.a.enumeration((function(){return i})),NaturalWidth:s.a.number(),NaturalHeight:s.a.number(),ContainerWidth:s.a.number(),ContainerHeight:s.a.number(),ActualWidth:s.a.number(),ActualHeight:s.a.number(),Left:s.a.number(),Top:s.a.number()};function b(t){return c.a.getObjectMasterFromModel(t)}function v(t,e,n){t.fieldsReady([e]).done((function(){var r=t.getModelByFieldSchema(e),i=Object(d.c)(r);t.ensureFieldsReady([n]).done((function(){var e=b(t.getModelByFieldSchema(n));i.setSettingsMaster(e)}))}))}!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Square=3]="Square"}(r||(r={})),function(t){t[t.Small=1]="Small",t[t.Large=2]="Large"}(i||(i={}));var g=function(t){function e(e){var n=t.call(this,e)||this;return e.MasterTreeReady&&e.MasterTreeReady.done((function(){var t=n.Parent;t instanceof h.a&&t.fieldsReady([h.a.Schema.LogoInfo]).done((function(){t.Model.LogoInfo===n.Model&&(n.qt=!0)}))})),n}Object(o.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"IsFormLogo",{get:function(){return this.qt},enumerable:!1,configurable:!0}),n.validateImageSettings=function(t){var e=u.clone(this.getSnapshot());if(744===e.ContainerWidth&&(e.ContainerHeight=e.ContainerHeight*Object(a.k)()/e.ContainerWidth,e.ContainerWidth=Object(a.k)(),!t)){var n=this.Model;n.ContainerWidth=e.ContainerWidth,n.ContainerHeight=e.ContainerHeight}if(null==e.ContainerHeight||null==e.ContainerWidth||null==e.ActualHeight||null==e.ActualWidth||null==e.Top||this.IsFormLogo&&(120!==e.ContainerHeight||120!==e.ContainerWidth)||e.Left>0||e.ContainerWidth>e.Left+e.ActualWidth||e.Top>0||e.ContainerHeight>e.Top+e.ActualHeight){var r=this.getDefaultImageSettings();for(var i in r)e[i]=Math.round(r[i]),t||(this.Model[i]=e[i])}return e},n.calcLogoLayout=function(t){var e,n,i,o=(this.Model.NaturalWidth||Object(a.f)())/(this.Model.NaturalHeight||Object(a.e)()),u=(t=t||{}).isSmallSize,c=t.isMobile,s=t.isSlimSize;if(c)(n=(e=s?30:u?70:80)*o)>e?(n=(e=s?40:e)*o,i=r.Vertical):i=r.Horizontal;else{var f=void 0;u?(e=70,f=125):s?(e=40,f=95):(e=120,f=215),(n=e*o)>f?(n=(e=s?30:u?40:70)*o,i=r.Vertical):i=r.Horizontal}return{ActualWidth:n=Math.min(n,750),ActualHeight:e,Layout:i}},n.getDefaultImageSettings=function(){var t,e=this.Model;e.NaturalHeight&&e.NaturalWidth?t={NaturalHeight:e.NaturalHeight,NaturalWidth:e.NaturalWidth}:t={NaturalHeight:e.NaturalHeight||Object(a.e)(),NaturalWidth:e.NaturalWidth||Object(a.f)()};if((!Object(l.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")||!Object(f.a)().userInfo.IsMsa)&&this.IsFormLogo)return t;var n=this.Vt();if(null==n.Height?(t.ContainerWidth=n.Width,t.ContainerHeight=n.Width*t.NaturalHeight/t.NaturalWidth):null==n.Width?(t.ContainerWidth=n.Height*t.NaturalWidth/t.NaturalHeight,t.ContainerHeight=n.Height):(t.ContainerWidth=n.Width,t.ContainerHeight=n.Height),null==n.Height||null==n.Width)t.Left=0,t.Top=0,t.ActualWidth=t.ContainerWidth,t.ActualHeight=t.ContainerHeight;else{var r=Math.max(t.ContainerWidth/t.NaturalWidth,t.ContainerHeight/t.NaturalHeight);t.ActualWidth=r*t.NaturalWidth,t.ActualHeight=r*t.NaturalHeight,t.Left=(t.ContainerWidth-t.ActualWidth)/2,t.Top=(t.ContainerHeight-t.ActualHeight)/2}return t},n.Vt=function(){var t=this.Model;if(this.IsFormLogo)return{Height:120,Width:120};if(null==t.Size||t.Size===i.Small)switch(t.Layout){case r.Square:return{Width:314,Height:314};case r.Vertical:return{Height:314};case r.Horizontal:default:return{Width:314}}else switch(t.Layout){case r.Square:return{Width:414,Height:414};case r.Vertical:return{Height:414};case r.Horizontal:default:return{Width:Object(a.k)()}}},e}(c.a.createObjectMasterClass("ImageSettingsMaster",m))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h})),n.d(e,"e",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"c",(function(){return b})),n.d(e,"h",(function(){return v})),n.d(e,"f",(function(){return g})),n.d(e,"d",(function(){return w}));var r=n(3),i=n(42),o=(n(7),n(22)),u=n(72),c=n(70),s=n(11),a=n(5),f=n(108);function l(t,e,n){var r;t&&(r="lang="+t),j(Object(f.a)(),r,void 0,e,n)}function h(t,e){return l(Object(s.f)(),t,e)}function d(t,e){j("GetRefreshedAntiForgeryToken",void 0,void 0,(function(e){var n=Object(a.a)();n.antiForgeryToken=e,Object(a.b)(n),t&&t()}),e)}function m(t,e){j("GetUserInfo",void 0,void 0,(function(e){var n=Object(a.a)();n.userInfo=e,Object(a.b)(n),t&&t()}),e)}function b(t){return O("GetThemes",void 0,JSON.stringify({name:t||""}),void 0)}function v(t){return O("GetUserInfo",void 0,void 0,p(t)).then((function(t){if(t){var e=Object(a.a)();e.userInfo=t,Object(a.b)(e)}}))}function g(t){return O("GetFlights",void 0,void 0,p(t)).then((function(t){if(t){var e=Object(a.a)();e.flights=t,Object(a.b)(e)}}))}function p(t){return{Accept:"application/json",Authorization:Object(i.a)(t)}}function O(t,e,n,i){var o;o="/"===window.location.pathname?"/Default.aspx/"+t:window.location.pathname+"/"+t,e&&(o+="?"+e);var s=new u.a("PageMethod.{0}".format(t));return s.start(),i=r.extend({},i,{"X-CorrelationId":s.CorrelationId,"X-UserSessionId":Object(c.b)()}),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:o,data:n||"{}",dataType:"json",headers:i}).then((function(t,e,n){return s.end({resultType:"Success",extraData:{status:e}}),t.d}),(function(e,n,r){return s.end({resultType:"Failure",extraData:{url:o,message:r}}),{message:r,name:"PageMethod CallWebMethod Failure: "+t}}))}function j(t,e,n,r,i){O(t,e,n,void 0).done(r).fail(i)}function w(t,e,n,r){var i=r||Object(s.f)()||navigator.language,u="https://uhf.microsoft.com/"+i+"/shell/xml/OfficeForms";t&&(u+="?"+t),$.ajax({type:"GET",url:u,dataType:"xml",success:function(t){e&&e(t)},error:function(r){o.a.logData({name:"Error.UHF.UniversalHeaderAndFooterError",extraData:{error:r}}),"en-us"!==i?w(t,e,n,"en-us"):n&&n(r)}})}},function(t,e,n){"use strict";n.d(e,"d",(function(){return C})),n.d(e,"g",(function(){return L})),n.d(e,"b",(function(){return M})),n.d(e,"c",(function(){return x})),n.d(e,"a",(function(){return D})),n.d(e,"f",(function(){return R})),n.d(e,"e",(function(){return E}));var r,i=n(25),o=n(16),u=n(86),c=n(11),s=n(5),a=n(47),f=n(10),l=n(14),h=n(26),d=(n(98),n(8),n(9));function m(t){return(t?"tokenSuccess_":"tokenFailure_")+Math.floor(65536*Math.random()).toString(6)}function b(t){if(!t)throw Error("The uuid is null or empty.");if(0===t.trim().length)throw Error("The uuid only has spaces.")}function v(t){if(t!==window.UnionUuid)throw Error("The acutal uuid is {0} but the expected one is {1}".format(t,window.UnionUuid.toString()))}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(r||(r={}));var g,p,O=n(109),j=n(44),w=n(41);function I(t){try{return $.when(function(t){g&&"rejected"!==g.state()||(g=Object(w.h)(t).done((function(){Object(o.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoSuccess",eventType:"engagement_event"})})).fail((function(t){Object(o.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoFailed",eventType:"engagement_event",extraData:{error:t}})})));return g}(t),function(t){p&&"rejected"!==p.state()||(p=Object(w.f)(t).done((function(){Object(o.a)({eventName:"AddinPage.PageMethod.GetFlightsSuccess",eventType:"engagement_event"})})).fail((function(t){Object(o.a)({eventName:"AddinPage.PageMethod.GetFlightsFailed",eventType:"engagement_event",extraData:{error:t}})})).always((function(){return Object(i.a)().setFlightsBasingOnAuth_Deprecated(Object(s.a)().flights)})));return p}(t))}catch(t){return Object(o.a)({eventName:"AddinPage.Auth.RefreshInfoFailed",eventType:"engagement_event"}),$.Deferred().resolve().promise()}}var S,F,y=Object(s.a)().signInLinkSilent,N=Object(s.a)().signInLinkSilentMsa,T=0,k=null,P=!1;function C(t){var e=t&&t.response&&t.response.statusCode;if(Object(c.o)()&&401===e){if(t&&t.response&&"Expired"===Object(f.c)(t.response.headers,"X-FailureReason"))return!0;var n=t&&t.response&&Object(d.w)(t.response.body);if(711===(n&&n.error&&parseInt(n.error.code)))return!0}return!1}function L(){var t=$.Deferred();if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(e,n){!n&&e?t.resolve():Object(i.a)().AuthContext.signIn().then(h.b)})),!window.formsRefreshAuthTokenCallback){var e=new u.a("Auth.RefreshToken");e.start();var n=function(t,n){try{e.end({extraData:{loggedIn:t},resultType:n?"ExpectedFailure":"Success"}),$("#refreshAuthTokenFrame").remove();var r=window.formsRefreshAuthTokenCallbacks;r&&(n?r&&r.length>0&&r[0](t,n):r.forEach((function(e){return e(t,n)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(Object(i.a)().AuthContext.hasUserLoggedIn()){var r=Object(s.a)().userInfo.IsMsa?N:y,o=$('<iframe id="refreshAuthTokenFrame" style="display: none" src="'+r+'" />');o.on("load",(function(){window.setTimeout((function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)}),5e3)})),window.formsRefreshAuthTokenCallback=n,$(document.body).append(o)}else n(!1,!0)}return t.promise()}function M(t,e){var n=$.Deferred();if(window.formsDetectUserLoggedInCallback)n.reject();else{var r="Msa"===t,i=r?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",o=new u.a(i);o.start();var c=r?N:y;e&&(c=Object(l.d)(c,r?"username":"login_hint",encodeURIComponent(e)));var s=$("<iframe id='detect-user-loggedIn-frame' style='display: none' src='"+c+"' />");s.on("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)})),window.formsDetectUserLoggedInCallback=function(t,e){window.formsDetectUserLoggedInCallback=void 0,o.end({resultType:e?"ExpectedFailure":"Success"}),$("#detect-user-loggedIn-frame").remove(),n.resolve(t)},$(document.body).append(s)}return n.promise()}function x(t,e){if(Object(a.b)()||Object(a.c)()||Object(d.u)()||Object(a.f)()){if(F||(F=$.Deferred()),!Object(a.c)()&&!Object(a.f)()&&k&&k.isAccessTokenFromHostValid()){var n=k.getAccessToken();return e?I(n).always((function(){return F.resolve(n)})):F.resolve(k.getAccessToken()),F.promise()}return"pending"!==F.state()&&(F=$.Deferred()),k=null,P=!1,Object(d.u)()?function(t,e){try{b(window.UnionUuid);var n=window.FormsJSInterface.getServerAuthToken(window.UnionUuid);n.then=function(t,e){var r=m(!0);window[r]=t;var i=m(!1);return window[i]=e,n.thenJS(r,i)},n.then(t,e)}catch(t){E(t)}}((function(t){!function(t){if(t)try{v(t.mUUID);var e=t.mResult;e?R(e):E("the mResult is not returned")}catch(t){E(t)}else E("the result is null or empty")}(t)}),(function(t){!function(t){var e=null;if(t)try{v(t.mUUID),(e=t.mErrorMessage)||(e="the mErrorMessage is null or empty")}catch(t){e=t}else e="the result is null or empty";E(e)}(t)})):(window.addEventListener("message",A,!1),window.parent.postMessage("GetAccessTokenFromHost","*")),T=0,U(),F.promise()}return Object(d.b)()?Object(O.a)().then(null,(function(){return _(t)})):_(t)}function D(t){return t?(t.startsWith("t=")?"":"Bearer ")+t:""}function R(t){k=new B(t)}function E(t){Object(o.a)({eventName:"GetAccessTokenFailed",eventType:"error_event",extraData:{errorInfo:t&&t.message?t.message:t}}),P=!0}function A(t){if(t.data.startsWith("FormsAccessTokenFromHost:"))try{var e=t.data.indexOf("FormsAccessTokenFromHost:Bearer ");if(-1!==e){var n=t.data.substring(e+"FormsAccessTokenFromHost:Bearer ".length);k=new B(n)}}finally{window.removeEventListener("message",A,!1)}}function _(t){var e=$.Deferred();return Object(c.o)()?(e.resolve(null),e.promise()):t.getCachedUser()?(t.acquireToken(Object(c.h)(),(function(n,r){if(!n&&r)return S=new Date,void e.resolve(r);var i;if(!t.getCachedToken(Object(c.a)())){if(S){var u=(new Date).getTime()-S.getTime();Object(o.a)({eventName:"Auth.AcquireTokenIdleTime",eventType:"engagement_event",extraData:{error:n,idleTimeInMinutes:u/6e4}})}return t.clearCache(),void Object(h.d)()}if(t.clearCache(),n.match("^AADSTS50079:"))return Object(o.a)({eventName:"AADAcquireTokenMfaCheckFailure",eventType:"error_event",extraData:n}),(i=new Error).name="AADAcquireTokenMfaCheckError",i.message=n,void e.reject(i);if(!n.match("^AADSTS50058:"))return Object(o.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:n}),(i=new Error).name="AADAcquireTokenError",i.message=n,void e.reject(i);if(Object(d.h)()||Object(d.g)()){var s=Object(j.c)();if(Object(o.a)({eventName:"LoginIECrossZone",eventType:"error_event",extraData:{useLegacyLoginDomain:!!s}}),Object(j.c)())Object(j.g)(!1);else if(Object(j.d)())return Object(j.g)(!0),void Object(h.d)()}else Object(o.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:n});(function(t){var e=$.Deferred();return function(t){var e=function(n){switch(n.data){case"TPC:NotSupported":t(!1),window.removeEventListener("message",e);break;case"TPC:Supported":t(!0),window.removeEventListener("message",e)}};window.addEventListener("message",e,!1);$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src=https://controls.officeppe.com/thirdpartycookie/check.html><iframe>')}((function(n){Object(o.a)({eventName:"Auth.ThirdPartyCookieSupport",eventType:"engagement_event",extraData:{allow:n}});var r=new Error(t);r.name=n?"LoginIECrossZoneError":"ThirdPartyCookieBlockedError",e.resolve(r)})),e.promise()})(n).done((function(t){return e.reject(t)}))})),e.promise()):(e.resolve(null),e.promise())}function U(){if(null!=k){var t=k.getAccessToken();I(t).always((function(){return F.resolve(t)}))}else if(T<10){if(P)return void F.resolve(null);T++,window.setTimeout(U,1e3)}else T=0,F.resolve(null)}var B=function(){function t(t){this.zt=t;this.Gt=(new Date).getTime()+33e5}var e=t.prototype;return e.getAccessToken=function(){return this.zt},e.isAccessTokenFromHostValid=function(){return!!this.zt&&(new Date).getTime()<this.Gt},t}()},function(t,e,n){"use strict";function r(t,e){return t&&e?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate():void 0}function i(t,e){return t&&e?1e3*(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())+t.getMilliseconds()-(1e3*(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())+e.getMilliseconds()):void 0}function o(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return f}));var r=n(36);function i(){return Object(r.d)()}function o(){return function(t){var e=Object(r.b)(),n=t+".timestamp",i=e.getItem(n),o=i&&JSON.parse(i);if(!o||Date.now()>o)return e.removeItem(n),e.removeItem(t),null;var u=e.getItem(t);return u&&JSON.parse(u)}("officeforms.auth.detectAADInProgress")}function u(t){!function(t,e,n){var i=t+".timestamp",o=Object(r.b)();e?(o.setItem(i,JSON.stringify(Date.now()+n)),o.setItem(t,JSON.stringify(e))):(o.removeItem(i),o.removeItem(t))}("officeforms.auth.detectAADInProgress",t,5e3)}function c(){return"true"===l("officeforms.auth.detectAADResult")}function s(t){h("officeforms.auth.detectAADResult",t?"true":null)}function a(){return!!l("officeforms.uselegacylogindomain")}function f(t){h("officeforms.uselegacylogindomain",t?"1":null)}function l(t){return Object(r.b)().getItem(t)}function h(t,e){e?Object(r.b)().setItem(t,e):Object(r.b)().removeItem("officeforms.uselegacylogindomain")}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Auto=2]="Auto"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(8),i=n(59),o=n(65),u=n(39),c=function(){function t(t,e,n){var o=this;void 0===e&&(e=1e3),void 0===n&&(n=5e3),this.Ht=Number.MAX_VALUE,e=null!=e?e:1e3,n=null!=n?n:5e3,(Object(r.c)("EnableSlowerSave")||Object(u.d)()&&Object(r.c)("EnableSlowerSaveForEdu"))&&-1!==(Object(i.a)("DelayUpdateMasters")||[]).indexOf(t)&&(e*=4,n*=4),this.Wt=e,this.Jt=n,this.Kt=function(){return o.Xt().resolve()}}var e=t.prototype;return e.scheduleUpdate=function(){if(this.Yt)throw Error("Calling scheduleUpdate() before the previous one is resolved.");return this.Yt=$.Deferred(),this.Zt=window.setTimeout(this.Kt,this.Wt),this.ee=window.setTimeout(this.Kt,this.Jt),this.Yt.promise()},e.postponeUpdate=function(){if(!this.Yt)throw Error("Calling postponeUpdate() before update scheduled.");window.clearTimeout(this.Zt),this.Zt=window.setTimeout(this.Kt,this.Wt)},e.cancelUpdate=function(){this.Xt().reject()},e.setMaxRetryTimesForUpdate=function(t){this.Ht=t},e.Xt=function(){window.clearTimeout(this.Zt),this.Zt=void 0,window.clearTimeout(this.ee),this.ee=void 0;var t=this.Yt;return this.Yt=void 0,t},e.retryForCreation=function(t){return t<3?Object(o.c)():Object(o.b)()},e.retryForUpdate=function(t){var e=this;if(t>=this.Ht)return Object(o.b)();var n=a;t<f&&(n=s*Math.pow(2,t)),this.ne=window.setTimeout((function(){e.ne=void 0,r.resolve()}),n);var r=$.Deferred();return r.promise()},e.cancelRetryForUpdate=function(){window.clearTimeout(this.ne),this.ne=void 0},t}(),s=2500,a=6e5,f=Math.log(a/s)/Math.log(2)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return h}));var r=n(11),i=n(8),o=n(14);function u(t,e){void 0===e&&(e=!1);var n=Object(o.c)()[t];return""===n||(n?(Array.isArray(n)&&(n=n[0]),e?"false"!==n.toLowerCase():"true"===n.toLowerCase()):e)}function c(){return u("d")}function s(){return u("oembedssotrial")&&Object(r.t)()||u("oembedsso")||u("powerappembed")}function a(){if(u("pptcontentsso")){var t=Object(o.c)().hostplatform;if("PC"===t)return!0;if("OfficeOnline"===t&&Object(i.c)("PPTContentAddinSSO"))return!0}return!1}function f(){return u("pptintegration")}function l(){return u("runtimeautorefresh")}function h(){return u("streamsso")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(16),i=function(){function t(){}t.prototype;return t.logData=function(t){Object(r.a)({eventName:t.errorName,eventType:"error_event",extraData:t.errorInfo})},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return F}));var r=n(2),i=n(3),o=n(4),u=n(0),c=(n(6),n(21)),s=n(65),a=n(61),f=n(9),l=n(16),h=n(80),d=n(46),m=n(33),b=n(40),v=n(23),g=n(15),p=function(){function t(t,e){this.re=t,this.I=Object(v.b)(this.re.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.re.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ElementId",{get:function(){return this.re.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ElementType",{get:function(){return this.re.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.re.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&!!t.FormElementManager.SectionMasters.length}},enumerable:!1,configurable:!0}),e.add=function(t){var e=this;if(this.re.Form.SyncContext!==g.a.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.re.createSyncJob((function(){return e.I.createFormDescriptiveElement(e.FormId,t,e.ExtraQosData)}))},e.delete=function(t){var e=this;if(!t||!t.id)throw Error("Trying to delete an empty element.");if(this.re.Form.SyncContext!==g.a.DesignTimeForm)throw Error("Trying to delete an element without design type.");return $.when(this.re.createSyncJob((function(){return e.I.deleteFormDescriptiveElement(e.FormId,t.id||"",e.ElementType,e.ExtraQosData)}))).then(null,(function(t){return t&&621===t.innerCode?$.Deferred().resolve().promise():t}))},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){var n=this;return this.re.Form.SyncContext!==g.a.DesignTimeForm?$.Deferred().resolve().promise():this.re.createUploadSyncJob((function(){return n.I.updateFormDescriptiveElement(n.FormId,n.ElementId,n.ElementType,t,n.ExtraQosData)}))},t}(),O=n(64),j=n(63),w=n(50),I={BranchInfo:u.a.fromMasterClass((function(){return h.a}),{IsLocalField:!0}),CoAuthors:u.a.collectionOf(u.a.reference(),{IsLocalField:!0}),FileUploadSPOInfo:u.a.create({anonymousLinkInfo:u.a.string(),driveId:u.a.string(),errorCode:u.a.string(),folderId:u.a.string(),linkInfo:u.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:u.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:u.a.string({SourceFieldName:"formsProRTSubtitle"}),Id:u.a.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:u.a.fromMasterClass(c.f,{SourceFieldName:"image"}),ImageSettings:u.a.fromMasterClass(c.g,{IsLocalField:!0}),IntegratedSavingState:u.a.reference({IsLocalField:!0}),Order:u.a.number({SourceFieldName:"order"}),QuestionInfo:u.a.string({SourceFieldName:"questionInfo"}),SavingState:u.a.reference({IsLocalField:!0}),ShowSubtitle:u.a.boolean({IsLocalField:!0}),Subtitle:u.a.string({SourceFieldName:"subtitle"}),Title:u.a.string({SourceFieldName:"title"}),Type:u.a.reference({SourceFieldName:"type"}),VideoInfo:u.a.create({Author:u.a.string(),OriginalHeight:u.a.number(),OriginalWidth:u.a.number(),ShowWarningBar:u.a.boolean(),Thumbnail_url:u.a.string(),Title:u.a.string(),Url:u.a.string()},{IsLocalField:!0})};function S(t){return o.a.getObjectMasterFromModel(t)}var F=function(t){function e(n){var r=this,o=$.Deferred();if(!n.InitialData)throw Error("Element model should created with initial data.");return(n=i.clone(n)).InitialData=i.clone(n.InitialData),n.InitialData.FormsProRTQuestionTitle||(n.InitialData.FormsProRTQuestionTitle=null),n.InitialData.FormsProRTSubtitle||(n.InitialData.FormsProRTSubtitle=null),r=t.call(this,n,{MasterReady:o.promise(),Scheduler:new d.a(e.name)})||this,Object(w.b)(r),r.U(),r.yt(n),Object(b.d)(r,e.Schema.ImageInfo,e.Schema.ImageSettings),e.Rules.forEach((function(t){return r.addRule(t)})),r.ie={},o.resolve(),r}Object(r.c)(e,t);var n=e.prototype;return e.supportMobileDesign=function(t){return!1},Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(m.c)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(b.e)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.setVideoUrl=function(t,n){var r=this.Model.VideoInfo;o.a.getObjectMasterFromModel(r).bulkEdit((function(){r.Url=Object(a.a)(t),r.Title="",r.Author="",r.Thumbnail_url="",r.OriginalWidth=e.defaultWidth,r.OriginalHeight=e.defaultHeight,r.ShowWarningBar=n&&Object(a.b)(t)}))},n.hasValidVideoUrl=function(){return Object(f.s)()?this.Tt()&&Object(a.c)(this.Model.VideoInfo.Url):this.Tt()&&Object(a.d)(this.Model.VideoInfo.Url)},n.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:e.defaultHeight,OriginalWidth:e.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},n.resetBranchInfo=function(){e.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.createSyncJob=function(t){var e=this,n=$.Deferred(),r=n.promise().then((function(){return e.Form.getQuestionSyncBlocker(r)})).then(t);return n.resolve(),r},n.createUploadSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n,this.kt).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.kt=Object(s.a)(r),r},n.updateCoAuthors=function(t){var e=this,n=i.filter(this.Model.CoAuthors,(function(e){return t.userId===e.userId}))[0],r=function(){n&&u.deleteItems([n]),t.userId in e.ie&&(clearTimeout(e.ie[t.userId]),delete e.ie[t.userId])},u=o.a.getCollectionMasterFromModel(this.Model.CoAuthors);u.bulkEdit((function(){r(),n=o.a.Collection.addItems(e.Model.CoAuthors,[t])[0]}));this.ie[t.userId]=window.setTimeout(r,1e4)},e.getBranchInfoMaster=function(t){return o.a.getObjectMasterFromModel(t)},n.yt=function(t){this.Ct=new O.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Ct.deserialize():this.Ct.serialize())},n.U=function(){this.isFieldReady(e.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(w.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n.Tt=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new j.a([e.Schema.BranchInfo,e.Schema.ImageSettings,e.Schema.ShowSubtitle,e.Schema.VideoInfo])),e.questionInfoFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{InterestedFields:[t.Id],Name:"block id changes",onChange:function(t){var e,n=t.Master.Model,r=n.Id,i=t.OldValues.Id;n.Id=i;try{throw Error("Changing element id")}catch(t){e=t}Object(l.a)({eventName:"UpdatingElementId",eventType:"error_event",extraData:{newId:r,oldId:i,stack:e.stack}})}},{InterestedFields:[t.ImageInfo.SavingState,t.SavingState],Name:"IntegrateSavingState",onChange:function(t){return t.Master.U()}}]}return e.rules},enumerable:!1,configurable:!0}),e.getSourceFields=function(t){return i.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e.defaultWidth=459,e.defaultHeight=256,e}(o.a.createObjectMasterClass("DescriptiveElementMaster",I,(function(t,e){return new p(t,e)})))},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return c}));var r=n(3),i=n(4);function o(t){var e=t.Synchronizer;e.observe((function(){return s(t)}),[e.Schema.CreationFailed,e.Schema.CreationInProcess,e.Schema.CreationScheduled,e.Schema.UpdateFailed,e.Schema.UpdateInProcess,e.Schema.UpdateScheduled]),s(t)}function u(t,e,n){var o=i.a.convertToArray(t.Model).map(i.a.getObjectMasterFromModel);function u(){var t=o.map((function(t){return t.getModelByFieldSchema(e)}));n(c(t))}u(),t.observe((function(t){t.AddedModels.length&&(o=o.concat(t.AddedModels.map(i.a.getObjectMasterFromModel))),t.RemovedModels.length&&t.RemovedModels.map(i.a.getObjectMasterFromModel).forEach((function(t){t.Synchronizer.deletedFromDataSource().done((function(){o=r.without(o,t),u()}))})),u()}),[e])}function c(t){return r.contains(t,"Saving")?"Saving":r.contains(t,"Scheduled")?"Scheduled":r.contains(t,"Failed")?"Failed":"Idle"}function s(t){var e=t.Synchronizer.Model;e.CreationInProcess||e.UpdateInProcess?t.Model.SavingState="Saving":e.CreationScheduled||e.UpdateScheduled?t.Model.SavingState="Scheduled":e.CreationFailed||e.UpdateFailed?t.Model.SavingState="Failed":t.Model.SavingState="Idle"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return l}));var r=n(11),i=n(59),o=n(5),u=Object(o.a)().hashMapping,c=Object(o.a)().isCdnEnabled,s=Object(o.a)().addPrefixForProWhenNoCdn,a={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function f(t){return t?c?h(t):s?"/FormsPro"+t:t:""}function l(t,e){if(!t)return"";var n=t.split(".").pop();if("js"!==n&&"css"!==n)return t;var r=function(t,e){return(/^vendors\//i.test(t)?a.vendorsFolder:a.defaultFolder)[e]}(t,n)+t;if(c&&void 0!==u){var i=u[t.toLowerCase()];if(void 0!==i)return h(r.replace(new RegExp(n+"$"),i+"."+n))}var f=r+(e?"?v="+Object(o.a)().version:""),l=Object(o.a)().ring;return!c&&l&&(f=f+(e?"&":"?")+"ring="+l),s?"/FormsPro"+f:f}function h(t){if(t=t.toLowerCase(),Object(r.r)()){var e=Object(i.a)("CdnEndPoint");if(e)return e+t}return"/cdn"+t}},function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return a})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var r=n(3),i=n(4),o=n(16);function u(t){return{localizedResources:c(t)}}function c(t){var e=function(t){var e=t.filter((function(t){return!t.questionId})),n=r.groupBy(e,(function(t){return t.locale}));return r.map(n,(function(t){var e={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return t.forEach((function(t){!function(t,e){switch(t.elementKey){case"thankyoumessage":e.thankYouMessage=t.elementValue;break;case"formclosemessage":e.formCloseMessage=t.elementValue;break;case"footertext":e.footerText=t.elementValue;break;default:d(t,e)}}(t,e)})),e}))}(t),n=function(t){var e=t.filter((function(t){return t.questionId})),n=r.groupBy(e,(function(t){return t.locale})),i={};return r["map"](n,(function(t,e){var n=r["groupBy"](t,(function(t){return t.questionId}));var i=r["map"](n,(function(t,n){var i={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:e,localeName:null,option:null,questionId:n,rightDescription:null,subtitle:null,title:null};var o=t.filter((function(t){return t.elementKey&&t.elementKey.startsWith("choiceid_")}));if(o&&o.length>0){var u=r["map"](o,(function(t){var e={choiceId:null,description:null,key:null};v(t,e);return e}));i.choices=u}var c=t.filter((function(t){return t.elementKey&&!t.elementKey.startsWith("choiceid_")}));if(c){c.forEach((function(t){b(t,i)}))}return i}));return i})).forEach((function(t){var e=t.length>0&&t[0].localeId;e&&(i[e]=t)})),i}(t);return e.forEach((function(t){if(t.localeId){var e=n[t.localeId];e&&(t.questionResources=e)}})),e}function s(t){var e=m(t);return null!=t.formCloseMessage?(e.elementKey="formclosemessage",e.elementValue=t.formCloseMessage):null!=t.thankYouMessage?(e.elementKey="thankyoumessage",e.elementValue=t.thankYouMessage):null!=t.footerText&&(e.elementKey="footertext",e.elementValue=t.footerText),e}function a(t){var e=m(t);return null!=t.leftDescription?(e.elementKey="leftdescription",e.elementValue=t.leftDescription):null!=t.rightDescription?(e.elementKey="rightdescription",e.elementValue=t.rightDescription):null!=t.option&&'{"choicesV1":[]}'!==t.option?(e.elementKey="option",e.elementValue=t.option):null!=t.formsprortlocaleldescription?(e.elementKey="formsprortlocaleldescription",e.elementValue=t.formsprortlocaleldescription):null!=t.formsprortlocalerdescription&&(e.elementKey="formsprortlocalerdescription",e.elementValue=t.formsprortlocalerdescription),e}function f(t,e,n,o){var u={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t.localeId,localeName:t.localeName,option:null,questionId:e,rightDescription:null,subtitle:null,title:null},c=i.a.Collection.getItemWithKeyFields(o.Model.Questions,{Id:e});if(c&&c.ChoiceGroup&&c.ChoiceGroup.length>0){var s=r.map(c.ChoiceGroup,(function(t){return{choiceId:t.Id.toString(),description:null,key:t.Key}}));u.choices=s}var a=i.a.Collection.itemsAddedInSource(n.questionResources,[u]);return i.a.getObjectMasterFromModel(a[0])}function l(t,e,n){var r={choiceId:t,description:null,key:e},o=i.a.Collection.itemsAddedInSource(n.choices,[r]);return i.a.getObjectMasterFromModel(o[0])}function h(t){var e=i.a.Collection.itemsAddedInSource(t.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return i.a.getObjectMasterFromModel(e[0])}function d(t,e){switch(e.localeId=t.locale,t.elementKey){case"title":e.title=t.elementValue;break;case"subtitle":e.subtitle=t.elementValue;break;case"localename":e.localeName=t.elementValue;break;case"formsprortlocaletitle":e.formsprortlocaletitle=t.elementValue;break;case"formsprortlocalesubtitle":e.formsprortlocalesubtitle=t.elementValue;break;default:var n=t.elementValue&&t.elementValue.length,r="Unexpected locale element key:["+t.elementKey+"], value length:"+n,i=new Error(r).stack;return console.log(i),void Object(o.a)({eventName:"UnexpectedLocaleElementKey",eventType:"error_event",extraData:r+", call stack:"+i})}}function m(t){var e={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=t.title?(e.elementKey="title",e.elementValue=t.title):null!=t.subtitle?(e.elementKey="subtitle",e.elementValue=t.subtitle):null!=t.localeName?(e.elementKey="localename",e.elementValue=t.localeName):null!=t.formsprortlocaletitle?(e.elementKey="formsprortlocaletitle",e.elementValue=t.formsprortlocaletitle):null!=t.formsprortlocalesubtitle&&(e.elementKey="formsprortlocalesubtitle",e.elementValue=t.formsprortlocalesubtitle),e}function b(t,e){switch(e.questionId=t.questionId,t.elementKey){case"leftdescription":e.leftDescription=t.elementValue;break;case"rightdescription":e.rightDescription=t.elementValue;break;case"option":e.option=t.elementValue;break;case"formsprortlocaleldescription":e.formsprortlocaleldescription=t.elementValue;break;case"formsprortlocalerdescription":e.formsprortlocalerdescription=t.elementValue;break;default:d(t,e)}}function v(t,e){var n=t.elementKey;n&&n.startsWith("choiceid_")&&(e.choiceId=n.split("_")[1]),e.description=t.elementValue}},function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return m})),n.d(e,"h",(function(){return b}));var r,i=n(3),o=(n(7),n(63)),u=n(12),c=n(97);function s(t){var e=u.a.Schema,n=[];return t.forEach((function(t){switch(t){case"Settings":case e.Settings:n.push(e.SerializedSettings);break;case"Modified":case e.Modified:n.push(e.ModifiedDate);break;case"Created":case e.Created:n.push(e.CreatedDate);break;case"ResponsesCount":case e.ResponsesCount:n.push(e.RowCount);break;case"PredefinedResponses":case e.PredefinedResponses:n.push(e.SerializedPredefinedResponses);break;case"Theme":case e.Theme:n.push(e.Background,e.OtherInfo);break;default:l().covers(t)?n.push(e.OtherInfo):n.push(t)}})),i.uniq(n)}function a(){var t=u.a.Schema;return[t.Background,t.Description,t.Logo,t.LogoInfo,t.Questions,t.DescriptiveElements,t.Settings,t.SoftDeleted,t.Title,t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Theme,t.TrackingId,t.XlWorkbookId,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.OnlineSafetyLevel,t.MeetingId,t.ProgressBarEnabled]}function f(){return a().concat([u.a.Schema.OwnerId,u.a.Schema.OwnerTenantId])}function l(){return r||(r=new o.a([u.a.Schema.PrimaryCustomizedThemeColor,u.a.Schema.SecondaryCustomizedThemeColor,u.a.Schema.TertiaryCustomizedThemeColor,u.a.Schema.Theme,u.a.Schema.LogoInfo,u.a.Schema.CreatedFromOneDrive,u.a.Schema.TemplateId])),r}function h(){var t=u.a.Schema;return[t.Title,t.ModifiedDate,t.CreatedDate,t.MeetingId,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Permissions,t.PermissionTokens,t.ResponsesCount,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.XlExportingTag,t.XlFileUnsynced,t.XlUnsyncedReason,t.Category,t.TrackingId,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.Flags,t.OnlineSafetyLevel,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ProgressBarEnabled]}function d(){var t=u.a.Schema;return[t.Title,t.ModifiedDate,t.Description,t.Settings,t.Theme,t.Questions,t.DescriptiveElements,t.Logo,t.LogoInfo,t.Background,t.Category,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.OnlineSafetyLevel,t.ProgressBarEnabled,t.TenantSwitches,t.PrivacyUrl]}function m(){var t=u.a.Schema;return[t.Title,t.ModifiedDate,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.Category,t.Type,t.ProgressBarEnabled]}function b(t){var e,n;return t.InitialData&&((t.InitialData.SerializedSettings||t.InitialData.Settings)&&(e=e||{},t.InitialData.SerializedSettings?e.Settings=JSON.parse(t.InitialData.SerializedSettings):e.SerializedSettings=c.a.serialize(t.InitialData.Settings)),(t.InitialData.SerializedPredefinedResponses||t.InitialData.PredefinedResponses)&&(e=e||{},t.InitialData.SerializedPredefinedResponses?e.PredefinedResponses=JSON.parse(t.InitialData.SerializedPredefinedResponses):e.SerializedPredefinedResponses=(n=t.InitialData.PredefinedResponses)&&n.length>0?JSON.stringify(n):null)),e&&((t=i.clone(t)).InitialData=i.extend({},t.InitialData,e)),t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));function r(t){var e=function(t){try{t=t.replace(/_/g,"/").replace(/-/g,"+");var e=(f=t,window.atob(f.replace(/ /g,"")).split("").map((function(t){return t.charCodeAt(0)}))),n=i(e.slice(0,16)),r=i(e.slice(16,32)),o=function(t,e){if(null==t||0===t.length)return t;var n=t.length;for(;--n>=0&&!(e.indexOf(t.charAt(n))<0););return t.substr(0,n+1)}(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e.slice(32)),"."),u={},c=o.split("$%@#");if(c.length>1){o=c[0];for(var s=1;s<c.length;s++){var a=c[s].split("=");a&&2===a.length&&(u[a[0]]=a[1])}}return{OrgId:n,OwnerId:r,TableId:o,MoreInfo:u}}catch(t){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}var f}(t),n=!1;return e.MoreInfo&&"g"===e.MoreInfo.t&&(n=!0),{OrgId:e.OrgId,OwnerId:e.OwnerId,TableId:e.TableId,IsGroupOwner:n}}function i(t){if(16!==t.length)return null;var e=function(t){for(var e="",n="",r=0;r<t.length;r++)n=1===(n=t[r].toString(16)).length?"0"+n:n,e+=n;return e}([].concat(t.slice(0,4).reverse(),t.slice(4,6).reverse(),t.slice(6,8).reverse(),t.slice(8)));return e=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)}},function(t,e,n){"use strict";n.d(e,"d",(function(){return b})),n.d(e,"c",(function(){return v})),n.d(e,"f",(function(){return g})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return j}));var r=n(24),i=n(5),o=n(10),u=n(14),c=n(26),s=n(9),a=n(25),f=n(27),l=n(6),h=n(77),d=n(7);var m=n(22);function b(t){var e=j(t);return g(e)?$.Deferred().promise():e}function v(t){var e=j(t);return g(e)?void 0:e}function g(t){return 401===t.statusCode&&!Object(r.k)()&&(function(t){if(t){var e=void 0;switch(t.innerCode){case 702:e="Auth.NotOnboardedTenant";break;case 703:e="Auth.DisabledByTenantAdmin";break;case 705:e="Auth.UserNeedMultiFactorAuth"}e&&m.a.logData({extraData:{tenantId:Object(i.a)().userInfo.TenantId},name:e})}}(t),Object(u.c)().embed?(t.innerCode=10001,!1):(700===t.innerCode||701===t.innerCode)&&(!Object(s.u)()||701!==t.innerCode&&700!==t.innerCode?Object(s.t)()&&Object(s.j)()&&Object(s.f)()?(t.innerCode=15003,!1):(Object(a.a)().AuthContext.signIn().then(c.b),!0):(function(t){Object(d.d)(),Object(l.c)().done((function(){f.render(Object(h.a)({Error:t}),document.getElementById("content-root"))}))}({innerCode:701===t.innerCode?10300:10301}),!1)))}function p(t){return O(t).value}function O(t){var e={status:0};if(null==t)e.value=t;else{var n=t["@odata.count"]&&parseInt(t["@odata.count"]);isNaN(n)||(e.count=n),e.value=Object(s.w)(void 0===t.value?t:t.value)}return e}function j(t){var e={correlationId:t&&t.response&&t.response.headers&&Object(o.c)(t.response.headers,"X-CorrelationId"),headers:t&&t.response&&t.response.headers,statusCode:t&&t.response&&t.response.statusCode,statusText:t&&t.response&&t.response.statusText},n=t&&t.response&&Object(s.w)(t.response.body),r=n.error&&parseInt(n.error.code);if(isNaN(r))switch(e.statusCode){case 0:e.innerCode=15001;break;case 429:e.innerCode=15429}else e.innerCode=r;return e.innerMessage=n.error&&n.error.message,e.type=n.error&&n.error["@ms.form.error.type"],e.customizedMessage=n.error&&n.error["@ms.form.error.customizedMessage"],e.isServerError=!0,e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l}));var r,i,o=n(41),u=n(51),c="Customized Theme",s="Default Theme",a={BackgroundColor:"#E8F2F4",BackgroundImage:null,Name:s,PrimaryColor:"#008272",SecondaryColor:"#004B50",Thumbnail:Object(u.a)("/Images/Theme/teal-thumbnail.png")};function f(t){return(i||(i=n.e(2).then(n.t.bind(null,147,3)).then((function(t){return t.default}))),i).then((function(e){return h(e[t])||a}))}function l(t){return function(t){return r||(r=new Promise((function(e,n){Object(o.c)(t||a.Name).then(JSON.parse).then(e,n)}))),r}(t).then((function(e){return h(e[t])||a}))}function h(t){if(!t)return t;var e=t.BackgroundImage;null!=e&&/^\/Images\//i.test(e)&&(t.BackgroundImage=Object(u.a)(e));var n=t.Thumbnail;return null!=n&&/^\/Images\//i.test(n)&&(t.Thumbnail=Object(u.a)(n)),t}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(1),o=(n(7),n(100)),u=n(93),c=n(95);function s(t){return i.createElement(a,t)}var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ue=!1,e.ce=!1,e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.ce=!0,this.ue||window.setTimeout((function(){t.ue=!0,t.ce&&t.forceUpdate()}))},n.componentWillUnmount=function(){this.ce=!1},n.createReactNodes=function(){var t,e=this.props,n=e.ShowRequiredStar?i.createElement(c.a):void 0,r=e.ShowOrdinal?i.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;return e.Alert&&!this.ue||(t=Object(o.a)({ContainsHtml:!1,Text:e.Label,RenderMode:"RichText"})),e.Bold?[i.createElement("b",void 0,r,t,n),e.children]:[r,t,n,e.children]},e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r,i=n(5),o=decodeURI(Object(i.a)().webSettings||"{}"),u={};function c(t){var e,n;if(void 0===r)try{r=JSON.parse(o)}catch(t){r={}}return null!==(n=null!==(e=r[t])&&void 0!==e?e:u[t])&&void 0!==n?n:""}function s(t,e){u[t]=e}s("DelayUpdateMasters",["CommentMaster","DescriptiveElementMaster","FormMaster","QuestionMaster"]),s("IgnoredClientError_Prod",["ResizeObserver loop limit exceeded"])},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));var r=n(5),i=n(14);function o(){if(Object(r.a)().isOembedSPO&&$(".office-form.office-form-theme-shadow").height()&&$(".office-form-footer-container").height()){var t=$(".office-form.office-form-theme-shadow").height()+$(".office-form-footer-container").height()+80;c("ResponsePage",t+=$(".office-form-new-bottom-bar").height()?$(".office-form-new-bottom-bar").height():0)}}function u(t){Object(r.a)().isOembedSPO&&c("ResponsePage",t)}function c(t,e){var n=Object(i.c)().hostId;if(n)parent.postMessage("FormsPageHeight:"+n+":"+e.toString(),"*");else{var r=Object(i.c)().id;parent.postMessage(t+"Height:"+r+":"+e.toString(),"*")}}function s(t){if(Object(r.a)().isOembedSPO){var e=t.Model.Title?t.Model.Title:"",n=t.Model.Description?t.Model.Description:"",o=Object(i.c)().hostId;parent.postMessage("FormsInfo:"+o+":"+encodeURIComponent(e)+":"+encodeURIComponent(n),"*")}}function a(t){if(Object(r.a)().isOembedSPO){var e=t&&(t.innerCode||t.message||""),n=Object(i.c)().hostId;parent.postMessage("FormsError:"+n+":"+encodeURIComponent(e),"*")}}var f=window.onerror;window.onerror=function(t,e,n,r,i){a(i),f&&f.apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var r=n(8),i=n(14),o=n(9);function u(t){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(t)}function c(t){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(t)}function s(t){return u(t)||c(t)}function a(t){return Object(o.s)()?u(t)?f(t):c(t)?function(t){var e=t.indexOf("/video");if(Object(r.c)("VideoStartTimeBugfix")){var n=t.substring(t.indexOf("?")+1),o=Object(i.c)(n),u=o.st?"st="+o.st+"&amp;":"",c=t.indexOf("?")>-1?t.slice(e,t.indexOf("?")):t.slice(e);return t.slice(0,e)+"/embed"+c+"?"+u+"autoplay=false&amp;showinfo=true&amp;app=forms"}return t.slice(0,e)+"/embed"+t.slice(e)+"?autoplay=false&amp;showinfo=true&amp;app=forms"}(t):void 0:f(t)}function f(t){var e=document.createElement("a");e.href=t;var n=e.pathname.split("/"),o=t.substring(t.indexOf("?")+1),u=Object(i.c)(o),c=u.v||n[0]||n[1];return Object(r.c)("VideoStartTimeBugfix")?"https://www.youtube.com/embed/"+c+"?feature=oembed&amp;modestbranding=1&amp;rel=0"+(u.t?"&amp;start="+u.t:""):"https://www.youtube.com/embed/"+c+"?feature=oembed&modestbranding=1&rel=0"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(2),i=n(3),o=n(4),u=n(0),c=n(96),s=n(23),a=n(15),f=n(52),l=function(){function t(t){this.W=t,this.I=Object(s.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==a.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.Form;return n?n.Synchronizer.existingInDataSource().then((function(){var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(f.d)(i.pick(t,[n]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=e.W.Model.localeId,o.questionId="",r.push(Object(c.a)(o,e.W.FormId)))}return $.when.apply($,r).then((function(t){}))})):$.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==a.a.DesignTimeForm)return $.Deferred().resolve().promise();var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],u=Object(f.d)(i.pick(t,[n]));u.locale=this.W.Model.localeId,u.questionId="",r.push(o?this.I.updateLocaleItem(this.W.FormId,u):this.I.createLocaleItem(this.W.FormId,u))}return $.when.apply($,r).then((function(t){}))},t}(),h=n(75),d={footerText:u.a.string(),formCloseMessage:u.a.string(),formsprortlocalesubtitle:u.a.string(),formsprortlocaletitle:u.a.string(),localeId:u.a.string({IsKeyField:!0}),localeName:u.a.string(),questionResources:u.a.collectionOf((function(){return h.a})),subtitle:u.a.string(),thankYouMessage:u.a.string(),title:u.a.string()},m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!1,configurable:!0}),e.getFormResourceMaster=function(t,e){var n=i.find(e.Model.LocalizedResources,(function(e){return e.localeId===t}));if(n)return o.a.getObjectMasterFromModel(n);throw Error("This locale does not exist in form.")},e.getQuestionResourceMaster=function(t,e,n){var r=n.Model.LocalizedResources,i=o.a.Collection.getItemWithKeyFields(r,{localeId:t});if(i){if(i.questionResources||(i.questionResources=[]),i.questionResources.length>0){var u=o.a.Collection.getItemWithKeyFields(i.questionResources,{localeId:t,questionId:e});if(u)return o.a.getObjectMasterFromModel(u)}return Object(f.c)({localeId:t,localeName:i.localeName},e,i,n)}throw Error("This locale does not exist in form.")},e}(o.a.createObjectMasterClass("FormLocalizedItemMaster",d,(function(t){return new l(t)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),i=n(4),o=n(107),u=function(){function t(t){this.se=t.concat(),this.ae=t.map((function(t){return i.a.getFieldSchemaInfo(t).Name}))}var e=t.prototype;return Object.defineProperty(e,"FieldSchemas",{get:function(){return this.se.concat()},enumerable:!1,configurable:!0}),e.covers=function(t){return Object(o.b)(t)?r.contains(this.ae,t):r.contains(this.se,t)},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(4),i=0,o=function(){function t(t,e,n){this.W=t,this.fe=e,this.le=n.FieldSchemas,this.me()}var e=t.prototype;return e.serialize=function(){var t=this.W.getSnapshot(this.le),e=this.W.Schema,n={};this.le.forEach((function(e){var i=r.a.getFieldSchemaInfo(e).Name;n[i]=r.a.convertToSourceData(t[i],e)}));var o=r.a.getFieldSchemaInfo(this.fe).Name,c=u(n,e,[]),s=c&&JSON.stringify(c),a=this.W.Model[o]!==s;(a||Math.random()<i)&&(a=!0,s=(c=u(n,e,null))&&JSON.stringify(c)),a&&(this.W.Model[o]=s)},e.deserialize=function(){var t=r.a.getFieldSchemaInfo(this.fe).Name,e=this.W.Model[t],n=e?JSON.parse(e):{},i={};this.le.forEach((function(t){var e=r.a.getFieldSchemaInfo(t).Name;i[e]=r.a.convertFromSourceData(n[e],t)})),this.W.setData(i,this.le)},e.me=function(){var t=this,e=r.a.getFieldSchemaInfo(this.fe).Name;this.W.addRule({Name:"Deserialize - "+e,InterestedFields:[this.fe],onChange:function(e){e.BeingDeleted||t.deserialize()}}),this.W.addRule({Name:"Serialize - "+e,InterestedFields:this.le,onChange:function(e){e.BeingDeleted||t.serialize()}})},t}();function u(t,e,n){if(null==t)return null;if(Array.isArray(t)){if(t.length){var i=e[0];return t.map((function(t){return u(t,i,n)}))}return n}var o={},c=0;return r.a.getSubFieldSchemas(e).forEach((function(e){var i=r.a.getFieldSchemaInfo(e),s=i.Attributes.SourceFieldName||i.Name,a=t[s];i.IsLeaf||(a=u(a,e,n)),null!=a&&(++c,o[s]=a)})),c>0?o:null}},function(t,e,n){"use strict";function r(t){return $.Deferred().reject(t).promise()}function i(t){return $.Deferred().resolve(t).promise()}function o(t){return t?t.then(null,i):i()}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return f}));var r=n(16),i=n(5),o=Date.now(),u={},c={},s=function(){try{var t="FormsVersion"+window.location.pathname,e=window.localStorage.getItem(t),n=Object(i.a)().version;return e===n||(window.localStorage.setItem(t,n),!1)}catch(t){return!1}}();function a(t,e){var n=Date.now(),r={sa:n-o};return u[t]=r,e.done((function(){r.d=Date.now()-n})).fail((function(){r.d=Date.now()-n,r.f=1}))}function f(){var t=window.NavKeyPoints;Object(r.a)({eventName:"Forms.PerformanceAnalysis",eventType:"engagement_event",extraData:{checkPoints:c,requests:u,requestsAll:Date.now()-o,scriptCached:s,scriptDownload:t&&t.PageStartTime&&o-t.PageStartTime,version:1}})}},function(t,e,n){"use strict";function r(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)}function i(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)?parseFloat(e).toString():""}function o(t){return Math.floor(t)===t}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return d}));function r(t){var e=[t.R,t.G,t.B].map((function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*e[0]+.7152*e[1]+.0722*e[2]}function i(t){return(r({R:255,G:255,B:255})+.05)/(r(t)+.05)>4.5}function o(t){return i(t)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function u(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function c(t){return"#"+u(t.R)+u(t.G)+u(t.B)}function s(t){var e,n=t.R,r=t.G,i=t.B,o=Math.max(n,r,i),u=Math.min(n,r,i),c=o-u,s=0===o?0:c/o,a=o/255;switch(o){case u:e=0;break;case n:e=r-i+c*(r<i?6:0),e/=6*c;break;case r:e=i-n+2*c,e/=6*c;break;case i:e=n-r+4*c,e/=6*c}return{H:e,S:s,V:a}}function a(t){var e,n,r,i,o,u,c,s,a=t.H,f=t.S,l=t.V;switch(u=l*(1-f),c=l*(1-(o=6*a-(i=Math.floor(6*a)))*f),s=l*(1-(1-o)*f),i%6){case 0:e=l,n=s,r=u;break;case 1:e=c,n=l,r=u;break;case 2:e=u,n=l,r=s;break;case 3:e=u,n=c,r=l;break;case 4:e=s,n=u,r=l;break;case 5:e=l,n=u,r=c}return{R:Math.round(255*e),G:Math.round(255*n),B:Math.round(255*r)}}function f(t){t.startsWith("#")&&(t=t.substring(1));var e=parseInt(t,16);return{R:e>>16&255,G:e>>8&255,B:255&e}}function l(t){var e=f(t),n=s(e);return r(e)>186&&(n.V=.45,e=a(n)),c(e)}function h(t){var e=s(f(t));return c(a({H:e.H,S:e.S,V:e.V-.1}))}function d(t){var e,n=s(f(t));return e=n.S>.05?.05:0,c(a({H:n.H,S:e,V:.95}))}},function(t,e,n){"use strict";function r(t,e){return u(e,t&&t.type,t&&t.statusCode)}function i(t,e){return u(e,t&&t.failureType,t&&t.statusCode)}function o(t){var e=t;if(e&&e.statusCode)return JSON.stringify({correlationId:e.correlationId,innerCode:e.innerCode,innerMessage:e.innerMessage,isServerError:e.isServerError,statusCode:e.statusCode,statusText:e.statusText,type:e.type});var n=t;return n&&n.message?JSON.stringify({message:n.message,name:n.name,stack:n.stack}):JSON.stringify(t||"")}function u(t,e,n){switch(t){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(e){case"Failure":return!1;case"ExpectedFailure":return!0;default:var r=parseInt(n);if(r>=0&&r<500)return!0}}return!1}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n(18);function i(){return r.a.Resolve("IAWTLogger")}function o(){var t=i();return t&&t.SessionId}function u(){var t=$.Deferred(),e=i();return e?e.flush((function(){return t.resolve()})):t.resolve(),t.promise()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(35),i=n(18);var o=n(16),u=n(59);function c(t){Object(r.d)()||i.a.Resolve("IThirdPartyLinkify").then((function(){return function(t){t.linkify();var e=/^[a-z0-9]\.|\.xxx/i,n=Object(u.a)("LinkifyEscapeRegex");n&&(e=new RegExp(n,"i"));t.find("a.linkified").each((function(t,n){$(n).text().match(e)&&$(n).contents().unwrap()})),t.find("a.linkified").length&&Object(o.a)({eventName:"NeedLinkify",eventType:"engagement_event"})}(t)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),i=n(30),o=n(86),u=function(){function t(t){this.ve=null,this.ge={CorrelationId:Object(i.b)(),Data:{},Duration:0,Name:t},this.ve=new o.a(t)}var e=t.prototype;return Object.defineProperty(e,"Name",{get:function(){return this.ge.Name},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Duration",{get:function(){return this.ge.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CorrelationId",{get:function(){return this.ve.CorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Data",{get:function(){return this.ge.Data},enumerable:!1,configurable:!0}),e.start=function(){this.ve.ExtraData=this.Data.extraData,this.ve.start()},e.end=function(t){var e=this.pe(t);this.ve.end({extraData:e.Data.extraData,logLevel:"Info",resultCode:e.Data.resultCode,resultType:e.Data.resultType})},e.log=function(t){var e=this.pe(t);this.ve.log({extraData:e.Data.extraData,logLevel:"Info",resultCode:e.Data.resultCode,resultType:e.Data.resultType})},e.pe=function(t){var e=r.clone(this.ge);return e.Data=r.extend({},this.ge.Data,t),e},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(4),o=n(0),u=n(9),c=(n(7),n(20)),s={Answer:o.a.reference(),AnswerEntity:o.a.reference(),BranchedElement:o.a.reference(),BranchingType:o.a.string(),NextQuestionInOrder:o.a.reference(),NextQuestionInitialized:o.a.boolean(),QuizResult:o.a.reference(),ShowPhishingFormWarning:o.a.boolean(),Visible:o.a.reference(),FormsProOrdinal:o.a.reference(),FormsProRuntimeTitle:o.a.reference(),FormsProRuntimeSubtitle:o.a.reference(),InitialFormsProLocalizedRuntimeTitle:o.a.reference(),InitialFormsProLocalizedRuntimeSubtitle:o.a.reference(),SelectedChoice:o.a.reference()},a=function(t){function e(e,n){var r=t.call(this)||this;return r.Oe=function(){return r.updateBranchedQuestion()},r.St=e,r.St.observe(r.Oe),r.je=n,r.addRule({Name:"UpdateBranchedQuestion",onChange:function(t){return r.updateBranchedQuestion()}}),r}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestionRuntimeMasters",{get:function(){var t=this;return this.SubQuestions.map((function(e){return t.getSubQuestionRuntimeById(e.Model.Id)}))},enumerable:!1,configurable:!0}),n.getSubQuestionRuntimeById=function(t){return this.je?this.je.getOrCreateQuestionRuntimeById(t):null},n.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var t=Object(u.w)(this.Model.Answer||"{}"),e=null==t.Answer?this.Model.Answer:t.Answer;return this.Question.verify(e)===c.e.Success}return this.Question.verify(this.Model.Answer)===c.e.Success}return this.SubQuestionRuntimeMasters.every((function(t){return t.Question.verify(t.Model.Answer)===c.e.Success}))},n.release=function(){this.St.unobserve(this.Oe)},n.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},n.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},n.getScore=function(){var t=this.Model.AnswerEntity,e=t&&t.Score;return null!=e?e:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},n.updateBranchedQuestion=function(){if(!this.Question.Deleted){var t=this.Model,e=this.Question.getBranchedResult(t.Answer,t.NextQuestionInOrder);this.bulkEdit((function(t){t.BranchedElement=e.TargetElement,t.BranchingType=e.Type}))}},n.we=function(){},e}(i.a.createObjectMasterClass("QuestionRuntime",s))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return s}));var r=n(2),i=n(1),o=n(3),u=n(105),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ie=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t;return(t=o.clone(this.props)||{}).children=this.props.Text,t.ref=this.Ie,!(t.HTMLAttributes&&t.HTMLAttributes.title)&&this.props.Text&&(t.HTMLAttributes=o.clone(t.HTMLAttributes)||{},t.HTMLAttributes.title=this.props.Text),i.createElement(u.a,Object(r.a)({},t))},n.focus=function(){this.Ie.current&&this.Ie.current.focus()},e}(n(17).a);function s(t){return i.createElement(c,Object(r.a)({},t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(2),i=n(3),o=n(4),u=n(0),c=n(46),s=n(64),a=n(63),f=n(96),l=n(23),h=n(15),d=function(){function t(t){this.W=t,this.I=Object(l.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.QuestionId;if(n){var r=this.W.Form.getQuestionById(n).getChoiceByKey(this.W.Model.key||"");if(r)return r.Synchronizer.existingInDataSource().then((function(){var n=r.Model.Id.toString();e.W.Model.choiceId=n;var i={elementKey:"choiceid_"+n,elementValue:t.description,locale:e.W.LocaleId,questionId:e.W.QuestionId};return Object(f.a)(i,e.W.FormId).then((function(){return{choiceId:n,description:t.description}}))}))}return $.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();if(t.choiceId||void 0===t.description)throw Error("No valid payload to update.");var n={elementKey:"choiceid_"+this.W.ChoiceId,elementValue:t.description,locale:this.W.LocaleId,questionId:this.W.QuestionId};return null!==e.ValuesBefore.description?this.I.updateLocaleItem(this.W.FormId,n):this.I.createLocaleItem(this.W.FormId,n)},t}(),m={choiceId:u.a.string({IsKeyField:!0}),description:u.a.string(),key:u.a.string({IsLocalField:!0})},b=function(t){function e(e){var n=t.call(this,e)||this;if(!n.Model.key){if(!n.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return n.Form.fieldsReady([n.Form.Schema.Questions])})).done((function(){var t=n.Form.getQuestionById(n.QuestionId).getChoiceById(Number(n.Model.choiceId));t&&(n.Model.key=t.Model.Key)}))}return n}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("ChoiceLocalizedItemMaster",m,(function(t){return new d(t)}))),v=n(52),g=function(){function t(t){this.W=t,this.I=Object(l.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.QuestionId;if(n){var r=this.W.Form.getElementById(n);if(r)return r.Synchronizer.existingInDataSource().then((function(){var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(v.f)(i.pick(t,[n]));o.elementKey&&(o.locale=e.W.Model.localeId,o.questionId=e.W.QuestionId,r.push(Object(f.a)(o,e.W.FormId)))}return $.when.apply($,r).then((function(t){}))}))}return $.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],u=Object(v.f)(i.pick(t,[n]));u.locale=this.W.Model.localeId,u.questionId=this.W.QuestionId,r.push(o?this.I.updateLocaleItem(this.W.FormId,u):this.I.createLocaleItem(this.W.FormId,u))}return $.when.apply($,r).then((function(t){}))},t}(),p={choices:u.a.collectionOf((function(){return b})),choicesV1:u.a.collectionOf({choiceId:u.a.string({IsLocalField:!0}),description:u.a.string({SourceFieldName:"Description"}),formsProDisplayRTText:u.a.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:u.a.string(),formsprortlocalerdescription:u.a.string(),formsprortlocalesubtitle:u.a.string(),formsprortlocaletitle:u.a.string(),leftDescription:u.a.string(),localeId:u.a.string({IsKeyField:!0}),localeName:u.a.string(),option:u.a.string(),questionId:u.a.string({IsKeyField:!0}),rightDescription:u.a.string(),subtitle:u.a.string(),title:u.a.string()},O=function(t){function e(n){var r=this,i=$.Deferred();return(r=t.call(this,n,{MasterReady:i.promise(),Scheduler:new c.a(e.name)})||this).Se(n),i.resolve(),r}Object(r.c)(e,t);var n=e.prototype;return e.handleChoicesV1Deleted=function(t,e,n){t<0||i.forEach(n.Model.LocalizedResources,(function(n){i.filter(n.questionResources,(function(t){return t.questionId===e})).forEach((function(e){e.choicesV1.length>t&&o.a.Collection.itemsDeletedInSource(e.choicesV1,[e.choicesV1[t]])}))}))},e.handleChoicesV1Exchange=function(t,e,n,r){i.forEach(r.Model.LocalizedResources,(function(r){o.a.getCollectionMasterFromModel(r.questionResources).bulkEdit((function(r){i.filter(r,(function(t){return t.questionId===n})).forEach((function(n){var r,o,u=n.choicesV1;for(t>e?(r=e,o=t):(r=t,o=e);u.length<=o+1;)Object(v.b)(n);var c=i.map(u,(function(t){return t.description})),s=c.splice(t,1);c.splice(e,0,s[0]);for(var a=r;a<=o;++a)u[a].description=c[a]}))}))}))},Object.defineProperty(n,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!1,configurable:!0}),n.getChoiceLocalizedMaster=function(t){var e=this,n=i.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n){var r=i.find(n.ChoiceGroup,(function(e){return e.Id.toString()===t}));if(r){var u=o.a.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:t});return u?o.a.getObjectMasterFromModel(u):Object(v.a)(t,r.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},n.getChoiceV1LocalizedMaster=function(t){var e=this,n=i.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n&&n.Choices.length>t){for(;this.Model.choicesV1.length<n.Choices.length;)Object(v.b)(this.Model);return o.a.getObjectMasterFromModel(this.Model.choicesV1[t])}return null},n.Se=function(t){e.Schema.option&&(this.Fe=new s.a(this,e.Schema.option,e.ChoicesV1FieldSet),t.InitialData&&this.isFieldReady(e.Schema.option)&&(t.ExistingInDataSource||t.InitialData.option?this.Fe.deserialize():this.Fe.serialize()))},Object.defineProperty(e,"ChoicesV1FieldSet",{get:function(){return e.choicesV1FieldSet||(e.choicesV1FieldSet=new a.a([e.Schema.choicesV1])),e.choicesV1FieldSet},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("QuestionLocalizedItemMaster",p,(function(t){return new g(t)})))},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));var r,i=n(11),o=n(5),u=n(66),c=n(51);function s(t){return $.when.apply($,t.map(a))}function a(t){return v[t]||(v[t]=s(m[t]||[]).then((function(){return function(t){var e=$.Deferred();void 0===r&&(n=h,r=Object.keys(n).reduce((function(t,e){return t[e]=function(t,e){return d.indexOf(t)>=0?e||"":Object(c.b)(e,!1)}(e,n[e]),t}),{}));var n;var i=r[t];if(!i)throw Error("No script path for "+t);var u=document.getElementsByTagName("head")[0];if(!u)return e.reject(Error("No head element found!")).promise();var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=i,Object(o.a)().isCdnEnabled&&d.indexOf(t)<0&&(s.crossOrigin="anonymous");return s.onload=function(){return e.resolve()},s.onerror=function(){u.removeChild(s),e.reject(Error("Failed to load javascript file: "+i))},u.appendChild(s),e.promise()}(t)})),"undefined"!=typeof Forms&&Object(u.b)("script:"+t,v[t])),v[t]}var f=Object(o.a)().scriptSuffix,l=Object(o.a)().isCdnEnabled,h={"combined-design":l?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_e982333.js","combined-response":l?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_e8aff49.js","aria-odata":l?"Vendors/combinedmin/aria_odata.min.js":"Vendors/combined/aria_odata_831dd67.js",BootStrap:"Vendors/bootstrap/3.4.1/bootstrap."+f,DataTables:"Vendors/DataTables."+f,Chart:"Vendors/Chart-2.6."+f,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",Cropper_Modified:"Vendors/cropper/cropper.modified."+f,D3:"Vendors/d3/d3."+f,FileSave:"Vendors/FileSaver.min.js",Heatmap:"Vendors/highcharts/heatmap.min.js",HighCharts:"Vendors/highcharts/highcharts.min.js",HighCharts_More:"Vendors/highcharts/highcharts-more.min.js",ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"Vendors/officebrowserfeedback/1.4.2/officebrowserfeedback_floodgate.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+f,JQuery_Picker:"Vendors/pickadate-3.5.6/picker."+f,JQuery_Picker_Date:"Vendors/pickadate-3.5.6/picker.date."+f,JQuery_Picker_Time:"Vendors/pickadate-3.5.6/picker.time."+f,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",Linkify:"Vendors/linkify-2.1.8/linkify.min.js",Linkify_JQuery:"Vendors/linkify-2.1.8/linkify-jquery.min.js",MathJax:Object(i.r)()?"../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML":"//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",MathQuill:"Vendors/mathquill/mathquill."+f,O365ShellBootstrap:Object(o.a)().o365ShellBootHost?Object(o.a)().o365ShellBootHost.concat("/api/shellbootstrapper/",Object(o.a)().userInfo.IsMsa?"consumer":"business","/oneshell"):"",Pattern_Fill:"Vendors/highcharts/pattern-fill.min.js",Mark:"Vendors/markjs-8.9.0/mark."+f,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+f,WordCloud:"Vendors/highcharts/wordcloud.min.js",Xlsx:"Vendors/xlsx.core.min.js"};var d=["Ivy","MathJax","O365ShellBootstrap"];var m={};function b(t,e){m[t]=e}b("JQuery_Picker_Date",["JQuery_Picker"]),b("JQuery_Picker_Time",["JQuery_Picker"]),b("Linkify_JQuery",["Linkify"]),b("WordCloud",["HighCharts"]),b("HighCharts_More",["HighCharts"]),b("Heatmap",["HighCharts"]),b("Pattern_Fill",["HighCharts"]);var v={}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(1),o=n(32),u=n(31);function c(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,155))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))}function s(t){var e=Object(u.a)(s,c);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return h}));var r=n(2),i=n(1),o=n(32),u=n(31);function c(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(3).then(n.bind(null,152))];case 1:return[2,{default:t.sent().MathjaxFormulaRenderer}]}}))}))}function s(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(3).then(n.bind(null,154))];case 1:return[2,{default:t.sent().VirtualKeyboardControl}]}}))}))}function a(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(3).then(n.bind(null,153))];case 1:return[2,{default:t.sent().FormulaDesigner}]}}))}))}function f(t){var e=Object(u.a)(f,s);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}function l(t){var e=Object(u.a)(l,c);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}function h(t){var e=Object(u.a)(h,a);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(2),i=n(1),o=n(27),u=n(3),c=n(28),s=n(10),a=(n(7),n(22)),f=n(17),l=n(93),h=n(95);function d(t){return i.createElement(m,t)}var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ye=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.AutoFocus&&this.focus()},n.focus=function(){this.ye.current&&this.ye.current.focus()},n.createReactNodes=function(){return[this.Ne(),this.Te()]},n.Ne=function(){var t=this.props,e=t.Options;if(t.Label||t.ShowRequiredStar)return i.createElement("div",null,i.createElement("span",{className:e&&e.classNameForInnerLabel},t.Label),t.ShowRequiredStar?i.createElement(h.a):void 0)},n.Te=function(){var t,n,r,u,a=this,f=this.props,l=f.Options,h="DesignPage.ShortCut.Clipboard",d=Object(s.f)(l&&l.HTMLPropsForInnerElement,{value:f.Value||"",className:"office-form-textfield-input form-control border-no-radius",placeholder:f.Placeholder,ref:this.ye,style:{height:f.MinimalHeight+"px",overflowY:1===f.TextFieldType?"auto":void 0},spellCheck:!0,disabled:f.Disabled,onChange:this.ke.bind(this),maxLength:f.MaxLength?f.MaxLength:Object(c.b)(),onFocus:f.AutoSelection?function(){if(a.ye.current){var t=o.findDOMNode(a.ye.current);t&&t.select()}}:void 0,onKeyDown:Object(s.g)((function(t){if(t.ctrlKey){var n=new Date,r=String.fromCharCode(t.keyCode),i="Ctrl+"+r;switch(r){case"C":case"X":a.Pe(e.prevTimeKeyDown,n.getTime())>e.minDuration&&a.Ce(t,h,i),e.prevTimeKeyDown=n.getTime();break;case"V":a.Ce(t,h,i);break;case"Y":case"Z":a.Ce(t,"DesignPage.ShortCut.UndoRedo",i)}}})),onCopy:function(t){var n=new Date;a.Pe(e.prevTimeOnCopy,n.getTime())>e.minDuration&&a.Ce(t,h,"onCopy"),e.prevTimeOnCopy=n.getTime()},onPaste:function(t){a.Ce(t,h,"onPaste")},onCut:function(t){var n=new Date;a.Pe(e.prevTimeOnCut,n.getTime())>e.minDuration&&a.Ce(t,h,"onCut"),e.prevTimeOnCut=n.getTime()}});switch(f.TextFieldType){case 2:var m=d,v=null==f.MinimalHeight?80:f.MinimalHeight>0?f.MinimalHeight:0;m.MinHeight=v.toString()+"px",t=function(t){return i.createElement(b,t)}(m);break;case 1:n=i.createElement("textarea",d);break;case 0:default:r=i.createElement("input",d)}if(f.ShowCharCounter){var g=!f.Value||d.maxLength>f.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";u=i.createElement("label",{className:g},this.Le(f.Value,d.maxLength))}var p=Object(s.a)("office-form-textfield",f.Options&&f.Options.classNameForInnerDiv);return i.createElement("div",{className:p},t,n,r,u)},n.ke=function(t){if(!this.props.Disabled){var e=t.target,n=e.value;if(n&&n.length>e.maxLength&&(n=n.slice(0,e.maxLength)),this.props.onValueChange(n),this.props.ShowCharCounter){var r=o.findDOMNode(e).nextSibling;r&&(r.innerText=this.Le(n,e.maxLength))}}},n.Le=function(t,e){return(t||"").length.toString()+" / "+e.toString()},n.Ce=function(t,e,n){var r;this.props.HTMLAttributes&&(r=this.props.HTMLAttributes.className),a.a.logData({name:e,extraData:{targetClassName:r,operation:n}})},n.Pe=function(t,e){return e-t},e.prevTimeKeyDown=0,e.prevTimeOnCopy=0,e.prevTimeOnCut=0,e.minDuration=500,e}(l.a);var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ye=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.Me(),this.xe=this.Me.bind(this),window.addEventListener("resize",this.xe)},n.componentDidUpdate=function(){this.Me()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.xe)},n.focus=function(){this.ye.current&&this.ye.current.focus()},n.render=function(){var t=u.clone(this.props);return t.ref=this.ye,delete t.MinHeight,i.createElement("textarea",t)},n.Me=function(){var t=o.findDOMNode(this),e=this.props,n=t.parentElement,r=n.style.height;n.style.height=window.getComputedStyle(n).height,t.style.height=e.MinHeight;var i=t.offsetHeight-t.clientHeight;t.style.height=t.scrollHeight+i+"px",n.style.height=r,t.style.minHeight=e.MinHeight},e}(f.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(2),i=n(4),o=n(0),u=n(8),c=n(18),s=n(49),a=n(81),f=n(20),l={TargetQuestionId:o.a.string(),ToTheEnd:o.a.boolean()},h=function(t){function e(n){var r=t.call(this,n)||this;return r.De=!1,r.Re=!1,r.Ee=function(t){return r.Ae()},n.MasterTreeReady.done((function(){r.Deleted||(e.normalize(r,{},!1),r.addRule({Name:"normalize",onChange:function(t){e.normalize(r,t.OldValues,!0)}}),r.observe((function(t){r.Deleted||r._e()})))})),r}Object(r.c)(e,t);var n=e.prototype;return n.getElementMaster=function(){var t=this.Parent;do{if(t instanceof f.d||t instanceof s.a)return t}while(t=t.Parent);return null},n.getTargetElementMaster=function(){if(this.Deleted)return null;var t=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var e=t.getElementMasterById(this.Model.TargetQuestionId);return e&&e.Deleted?null:e?(a.a.isSection(e.Model.Type)||t.findContainerSection(this.getElementMaster())===t.findContainerSection(e))&&e:e},n.resetToDefault=function(){var t=this;this.bulkEdit((function(){t.Model.ToTheEnd=null,t.Model.TargetQuestionId=null}))},n.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},n.getBranchingResult=function(){var t=this.Model;return this.isValid()?t.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},n.hasSectionBranching=function(){var t=this.getElementMaster(),e=this.getTargetElementMaster();return a.a.isSection(t.Model.Type)||e&&a.a.isSection(e.Model.Type)},e.normalize=function(t,e,n){var r=t.Model;r.ToTheEnd?e.ToTheEnd&&r.TargetQuestionId||(r.TargetQuestionId=null):r.ToTheEnd=null,n&&t.Ue()},n.isValid=function(){return this.De||(this.Ue(),this._e()),this.Re},n.Ue=function(){this.De=!0,this.Re=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster());var t=this.Model.TargetQuestionId;!this.Re&&t&&Object(u.d)()&&(this.Re=c.a.Resolve("IIncrementalLoadStrategy").has(t))},n._e=function(){var t=this.getTargetElementMaster(),e=this.$e;t!==e&&((e instanceof f.d||e instanceof s.a)&&e.unobserve(this.Ee),this.$e=t,(t instanceof f.d||t instanceof s.a)&&t.observe(this.Ee))},n.Ae=function(){if(this.$e.Deleted)this.Model.TargetQuestionId=null;else if(this.$e instanceof f.d){var t=this.getElementMaster().Form.FormElementManager;t.findContainerSection(this.getElementMaster())!==t.findContainerSection(this.$e)&&(this.Model.TargetQuestionId=null)}},e}(i.a.createObjectMasterClass("BranchInfoMaster",l))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3),i=n(4),o=n(49),u=n(12),c=n(20),s=function(){function t(t){this.formMaster=t}var e=t.prototype;return Object.defineProperty(t,"QuestionOrderFloor",{get:function(){return 500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!1,configurable:!0}),t.isDescriptiveElement=function(t){return"Question.ColumnGroup"===t},t.isSection=function(t){return"Question.ColumnGroup"===t},Object.defineProperty(e,"TopQuestionMasters",{get:function(){return r.filter(this.formMaster.Model.Questions,(function(t){return!t.GroupId})).map(i.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HeaderTopQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.Be(null,e):this.TopQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HeaderQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.Be(null,e,!0):this.QuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionMasters",{get:function(){return i.a.convertToArray(this.formMaster.Model.Questions).map(i.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DescriptiveElementMasters",{get:function(){return i.a.convertToArray(this.formMaster.Model.DescriptiveElements).map(i.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SectionMasters",{get:function(){return r.filter(this.DescriptiveElementMasters,(function(e){return t.isDescriptiveElement(e.Model.Type)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e,"AllElementMasters",{get:function(){return this.getAllElements().map(i.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TopElementMasters",{get:function(){return this.Qe(!0).map(i.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),e.getQuestionById=function(t){var e=i.a.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:t});return e&&Object(c.h)(e)},e.getElementMasterById=function(t){return this.getQuestionById(t)||this.getDescriptiveElementMasterById(t)},e.getDescriptiveElementMasterById=function(t){var e=i.a.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:t});return e&&Object(o.b)(e)},e.findQuestionsInSection=function(t,e){if(t){var n=this.SectionMasters,i=r.indexOf(n,t);return i>=0?this.Be(n[i].Model.Order,i+1<n.length?n[i+1].Model.Order:null,e):[]}return e?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},e.findContainerSection=function(t){var e=this.SectionMasters;return e[r.findLastIndex(e,(function(e){return e.Model.Order<=t.Model.Order}))]},e.adjustElementOrders=function(){var e=this;if(this.formMaster.isFieldReady(u.a.Schema.Questions)){var n=this.formMaster.isFieldReady(u.a.Schema.DescriptiveElements),r=this.getAllElements();r.length&&this.formMaster.bulkEdit((function(){r.sort(t.questionComparer),r[0].Order||(r[0].Order=t.QuestionOrderFloor+t.QuestionOrderDefaultStep);for(var i=0,o=r[0].Order,u=1;u<=r.length;++u){var c=r[u]&&r[u].Order;if(!c)break;if(o!==c){var s=(c-o)/(u-i);for(o+=s;++i<u;)r[i].Order=o,o+=s}}for(;++i<r.length;)o+=t.QuestionOrderDefaultStep,r[i].Order=o;e.formMaster.Model.Questions=r.filter((function(e){return!t.isDescriptiveElement(e.Type)})).map((function(t){return t})),n&&(e.formMaster.Model.DescriptiveElements=r.filter((function(e){return t.isDescriptiveElement(e.Type)})))}))}},e.getSectionNodes=function(){var t=this,e=[],n=this.HeaderTopQuestionMasters;return n.length&&e.push({TopQuestionMasters:n}),this.SectionMasters.forEach((function(n){e.push({Section:n,TopQuestionMasters:t.findQuestionsInSection(n)})})),e},e.getAllElements=function(){return this.Qe(!1)},e.Qe=function(e){var n=i.a.convertToArray(this.formMaster.Model.Questions);e&&(n=r.filter(n,(function(t){return!t.GroupId})));var o=n;return this.formMaster.isFieldReady(u.a.Schema.DescriptiveElements)&&(o=o.concat(i.a.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(t.questionComparer)),o},t.questionComparer=function(t,e){var n=t.Order-e.Order;return t.Order&&e.Order||(n=-n),n||t.Id.localeCompare(e.Id)},e.Be=function(t,e,n){var r;return r=n?this.QuestionMasters:this.TopQuestionMasters,null!==e&&(r=r.filter((function(t){return e>t.Model.Order}))),null!==t&&(r=r.filter((function(e){return e.Model.Order>t}))),r},t}()},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.ResponsePage=1]="ResponsePage",t[t.TeamsResponsePage=2]="TeamsResponsePage",t[t.AssignmentResponsePage=4]="AssignmentResponsePage"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),i=n(30),o=n(48),u=function(t,e,n){this.answer=t,this.id=e||Object(i.b)(),this.isMath=n},c=function(){function t(e){if(this.qe=[],null!=e.GradingBasis)try{this.qe=JSON.parse(e.GradingBasis)}catch(n){this.qe=[],o.a.logData({errorName:"ShortTextGradingBasisJsonParseFailure",errorInfo:{gradingBasisLength:e.GradingBasis.length,nonAsciiDetected:t.doesContainNonAsciiCharacters(e.GradingBasis)}})}else this.qe=[]}var e=t.prototype;return e.serialize=function(){return JSON.stringify(this.qe)},e.getAnswers=function(){return r.clone(this.qe)},e.areAnyAnswersDefined=function(){return 0!==this.qe.length},e.addAnswer=function(t,e){return!this.Ve(t)&&(!this.ze(t)&&(this.qe.push(new u(t,void 0,e)),!0))},e.updateAnswer=function(t,e,n){if(this.Ve(e))return!1;if(this.ze(e,t))return!1;var r=this.Ge(t);if(r<0)return!1;var i=this.qe[r];return this.qe[r]=new u(e,i.id,n),!0},e.deleteAnswer=function(t){var e=this.Ge(t);e>=0&&this.qe.splice(e,1)},e.isCorrect=function(t){return!this.Ve(t)&&(t=(t+="").trim().toUpperCase(),null!=r.find(this.qe,(function(e){return e.answer.trim().toUpperCase()===t})))},e.ze=function(t,e){var n=(t+="").toUpperCase();return null!=r.find(this.qe,(function(t){return t.answer.toUpperCase()===n&&t.id!==e}))},e.Ve=function(t){return null==t||""===t},e.Ge=function(t){return r.findIndex(this.qe,(function(e){return e.id===t}))},t.doesContainNonAsciiCharacters=function(t){for(var e=0;e<t.length;e++)if(t.charCodeAt(e)>127)return!0;return!1},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(2),i=n(3),o=n(4),u=n(0),c=n(8),s=n(21),a=n(67),f=n(87),l=n(7),h=n(12),d=n(81),m=n(20),b=function(){function t(t){this.He=[],this.We=this.We.bind(this),this.Je=t}var e=t.prototype;return t.getBranchedSections=function(e,n){for(var r=[],o=[],u=0,c=function(){var c=e[u];if(i.findIndex(r,(function(t){return t.Section===c.Section}))>=0)return"break";for(var s=[],a=void 0,f=c.TopQuestionMasters[0],l=function(){if(i.include(o,f))return"break";o.push(f),s.push(f);var t=n(f,c.TopQuestionMasters),r=t.TargetElement;r instanceof m.d?f=r:(r&&d.a.isSection(r.Model.Type)?a=i.findIndex(e,(function(t){return t.Section===r})):"End"===t.Type&&(a=-1),f=null)};f;){if("break"===l())break}r.push({Section:c.Section,TopQuestionMasters:s}),u=void 0!==a?a:t.getNextSectionFromSection(c,e)};u<=e.length-1&&u>=0;){if("break"===c())break}return r},e.calculateQuestionRuntimeList=function(e){var n=[],r=this.Ke(e);this.formRuntimeMaster.IsDisableBranching||(r=t.getBranchedSections(r,this.We));var i=this.He,o=this.Xe(r,n);if(this.Je||t.isBranchingResultChanged(i,o)){this.He=o;var u=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){u.QuestionRuntimeMasters=n,u.BranchChangeVersion=(u.BranchChangeVersion||0)+1}))}},e.hasPrevSection=function(){return this.Ye()>0},e.gotoPrevSection=function(){var t=this.Ye();if(t>0){var e=this.He[t-1];this.formRuntimeMaster.Model.RuntimeSectionId=e.Section&&e.Section.Model.Id}},e.hasNextSection=function(){return this.Ye()<this.He.length-1},e.gotoNextSection=function(){var t=this.Ze();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t)},e.getAllSections=function(){return this.He},e.getCurrentSection=function(){return this.tn(this.formRuntimeMaster.Model.RuntimeSectionId)},e.isFirstPage=function(){var t=this.getCurrentSection();return 0===this.He.indexOf(t)},t.isBranchingResultChanged=function(t,e){if(t.length!==e.length)return!0;for(var n=0;n<t.length;n++){if(t[n].Section!==e[n].Section||t[n].TopQuestionMasters.length!==e[n].TopQuestionMasters.length)return!0;for(var r=0;r<t[n].TopQuestionMasters.length;r++)if(t[n].TopQuestionMasters[r]!==e[n].TopQuestionMasters[r])return!0}return!1},e.We=function(t,e){var n=this.formRuntimeMaster.getOrCreateQuestionRuntime(t),r=n.Model.BranchingType,i=n.Model.BranchedElement;return i instanceof m.d&&-1===e.indexOf(i)&&(i=e[e.indexOf(t)+1]),{TargetElement:i,Type:r}},e.Xe=function(t,e){var n=this;return t.map((function(t){return{Section:t.Section,TopQuestionMasters:t.TopQuestionMasters.map((function(t){var r=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);return e.push(r),t.SubQuestionMasters.forEach((function(t){var r=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);e.push(r)})),r}))}}))},t.getNextSectionFromSection=function(t,e){var n=t.Section,r=n&&n.Model.BranchInfo;if(r){if(r.ToTheEnd)return-1;var o=i.findIndex(e,(function(t){return t.Section&&t.Section.Model.Id===r.TargetQuestionId}));if(o>=0)return o}return i.findIndex(e,t)+1},e.tn=function(t){var e=this,n=i.find(this.He,(function(e,n){return t?e.Section&&t===e.Section.Model.Id:0===n}));return t&&!n&&(n=this.He[0],setTimeout((function(){e.formRuntimeMaster.Model.RuntimeSectionId=null}))),n},e.Ye=function(){return i.indexOf(this.He,this.getCurrentSection())},e.Ke=function(t){var e=this.formRuntimeMaster.Form;return e.hasSection()?e.FormElementManager.getSectionNodes():[{TopQuestionMasters:t.filter((function(t){return!t.Model.GroupId}))}]},e.Ze=function(){var t=this.Ye();if(t<this.He.length-1&&t>=0){var e=this.He[t+1];return e.Section&&e.Section.Model.Id}},t}();function v(t){var e=new b(Object(c.d)());return e.formRuntimeMaster=t,e}var g=n(73),p={QuestionRuntimeMasters:u.a.collectionOf(u.a.reference()),RuntimeSectionId:u.a.string(),UploadingFileCount:u.a.number(),BranchChangeVersion:u.a.number()},O=function(t){function e(e,n){var r=t.call(this)||this;return r.en={},r.nn=new f.a.CallbackManager,r.rn=function(){return r.nn.trigger()},r.in=function(t){return r.replaceAnswerTagsWithValue(t.Master)},r.un=function(t){return r.cn(t)},r.sn=function(){return r.cn()},r.an=function(){return r.fn.callOnceLater()},r.fn=new f.a.CallLater((function(){return r.ln()}),0),r.hn=e,r.dn=v(r),n=n||{},r.bn=n.disableShuffle,r.vn=n.disableBranching,r.cn(),r.fn.callImmediately(),r.Model.UploadingFileCount=0,o.a.getCollectionMasterFromModel(e.Model.Questions).observe(r.un),e.observe(r.sn,[h.a.Schema.HasValidBranching,h.a.Schema.Settings.ShuffleQuestionOrder]),r}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.hn},enumerable:!1,configurable:!0}),n.ElementManager=function(){return this.dn},Object.defineProperty(n,"IsDisableBranching",{get:function(){return this.vn},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Answers",{get:function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return t.Question.hasAnswer()})).map((function(t){return t.getAnswerEntity()}))},set:function(t){var e=this,n={};i.forEach(t,(function(t){return n[t.QuestionId]=t.Answer})),this.bulkEdit((function(){e.hn.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){t.Model.Answer=n[t.Question.Model.Id]}))})),this.fn.flush()},enumerable:!1,configurable:!0}),n.TopQuestionRuntimeMasters=function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return!t.Question.Model.GroupId}))},n.CurrentRuleManager=function(){return!1},n.isDefaultAnswer=function(){var t=this.hn.getDefaultResponse();return o.a.convertToArray(this.Model.QuestionRuntimeMasters).every((function(e){var n=e.Question.Model.Id;return t[n]===e.Model.Answer}))},n.updateWithResponse=function(t){var e=this,n={};t&&t.Answers&&i.forEach(t.Answers,(function(t){return n[t.QuestionId]=t})),this.bulkEdit((function(){e.hn.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){var e=t.Question.Model.Id,r=n[e];t.bulkEdit((function(){t.Model.Answer=r&&r.Answer,t.Model.AnswerEntity=r}))}))})),this.cn()},n.setQuizResults=function(t){var e=this;t.forEach((function(t){var n=e.en[t.id];n&&(n.Model.QuizResult={IsAnswerCorrect:t.isAnswerCorrect,AnswerHints:t.answerHints,IsAnswerKeys:t.answerKeys,Choices:i.map(n.Question.Model.Choices,(function(t){return t.Description})),GradingBasis:t.gradingBasis})}))},n.clearQuizResult=function(){for(var t in this.en)this.en[t].Model.QuizResult=void 0},n.resetQuestions=function(){},n.getQuestionResponseFromQueryString=function(){},n.calculateQuizResultFromModel=function(){o.a.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(t){return t.calculateQuizResultFromModel()}))},n.formsProQuestionVisiblityCheck=function(t){0},n.getQuestionsWithWrongAnswer=function(t){if(t.length<=0)return[];var e=this.TopQuestionRuntimeMasters(),n=i.findIndex(e,(function(e){return e.Question.Model.Id===t[0].Question.Model.Id}))+1;return t.map((function(t,e){return t.verifyAnswer()?-1:e+n})).filter((function(t){return t>0}))},n.getOrCreateQuestionRuntimeById=function(t){var e=this.hn.getQuestionById(t);return e&&this.getOrCreateQuestionRuntime(e)},n.observeAnswerChange=function(t){this.nn.register(t)},n.unobserveAnswerChange=function(t){this.nn.unregister(t)},n.release=function(){var t=function(t){var n=e.en[t];n.unobserve(e.an),n.unobserve(e.rn),n.release()},e=this;for(var n in this.en)t(n);o.a.getCollectionMasterFromModel(this.hn.Model.Questions).unobserve(this.un),this.hn.unobserve(this.sn)},n.getOrCreateQuestionRuntime=function(t){var e=t.Model.Id;return this.en[e]||(this.en[e]=this.gn(t)),this.en[e]},n.gn=function(t){var e=new g.a(t,this);return e.observe(this.an,[g.a.Schema.BranchedElement,g.a.Schema.BranchingType]),e.observe(this.rn,[g.a.Schema.Answer]),e},n.cn=function(t){var e,n=this,o=this.hn.Model.Settings,u=this.hn.FormElementManager;this.pn=u.TopQuestionMasters;var c=this.Form.hasSection();if(!c&&!this.bn&&!this.hn.Model.HasValidBranching&&o.ShuffleQuestionOrder)if(o.ShuffleAllQuestions||null==o.ShuffleAllQuestions)this.pn=i.shuffle(this.pn);else if(Object(a.c)(o.LockGivenQuestionsStartDisplayOrder)&&Object(a.c)(o.LockGivenQuestionsEndDisplayOrder)){var s=o.LockGivenQuestionsStartDisplayOrder-1,f=o.LockGivenQuestionsEndDisplayOrder-1,l=this.pn.splice(s,f-s+1);this.pn=i.shuffle(this.pn),(e=this.pn).splice.apply(e,Object(r.f)([s,0],l))}c?u.getSectionNodes().forEach((function(t){return n.On(t.TopQuestionMasters)})):this.On(this.pn),t&&(t.AddedModels.length||t.RemovedModels.length)&&this.fn.callOnceLater()},n.On=function(t){var e=this;t.forEach((function(n,r){var i=e.getOrCreateQuestionRuntime(n);i.bulkEdit((function(e){e.NextQuestionInOrder=t[r+1],e.NextQuestionInitialized=!0})),"Specified"===i.Model.BranchingType&&!i.Model.BranchedElement&&Object(c.d)()&&i.updateBranchedQuestion(),n.SubQuestionMasters.forEach((function(t){return e.getOrCreateQuestionRuntime(t)}))}))},n.ensureProRuleManager=function(){var t=this,e=this.hn;return this.jn?$.Deferred().resolve("").promise():l.a.getFormsProBranching(e,Object(s.b)().Model,!0,!0).done((function(){t.jn=FormsPro.getRuleManager(t.hn,t.Model.QuestionRuntimeMasters,t)}))},n.wn=function(t,e,n){},n.ln=function(){this.dn.calculateQuestionRuntimeList(this.pn)},n.replaceAnswerTagsWithValue=function(t){},n.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var t=this.Model.QuestionRuntimeMasters;o.a.convertToArray(t).filter((function(t){return"Question.FileUpload"===t.Question.Model.Type})).forEach((function(t){return t.Model.Answer=void 0}))},e}(o.a.createObjectMasterClass("FormRuntime",p))},function(t,e,n){"use strict";n.d(e,"a",(function(){return T})),n.d(e,"b",(function(){return k}));var r,i=n(2),o=n(3),u=n(118),c=n(42),s=n(11),a=n(24),f=n(8),l=n(59),h=n(35),d=n(5),m=n(41),b=n(10),v=n(26),g=n(25),p=(n(7),n(72)),O=n(70),j=n(99),w=n(69),I=n(39),S=n(55);var F={},y={},N=null;function T(t,e){var n;e=e||{};var u,b=$.Deferred(),T=t.qosEventName,C=-1!==(Object(l.a)("ThrottledQosEventNames")||[]).indexOf(T),L=!e.disableLog,M=-1;!Object(f.c)("ThrottledLogging")||L&&!C||(N||(N=setInterval((function(){o.keys(F).forEach((function(t){F[t]=!0}))}),6e5)),void 0===F[T]||F[T]?(L=!0,M=null!==(n=y[T])&&void 0!==n?n:0,F[T]=!1,y[T]=0):(L=!1,void 0!==y[T]?++y[T]:y[T]=1));if(L){u=new p.a(T);var x=o.clone(t.qosExtraData);M>=0&&(x=Object(i.a)({SkippedCount:M},x)),o.extend(u.Data,{extraData:x}),u.start(),t.headers["X-CorrelationId"]=u.CorrelationId,t.headers["X-UserSessionId"]=Object(O.b)()}e.disableXMsHeader||(t.headers["x-ms-form-request-source"]=function(){var t="ms-formweb";if(Object(a.j)()){var e=Object(a.b)();e&&(t="ms-"+e.toLowerCase()),Object(d.a)().isOembedSPO&&(t="forms-webpart")}return Object(d.a)().isSonarServer&&(t="ms-sonar"),t}(),function(t){if(!r){if(Object(f.c)("LeverageServerRingLogic")&&Object(d.a)().ring&&!Object(s.u)())return $.Deferred().resolve(Object(d.a)().ring.toLowerCase()).promise();r="USGovGccProd"===Object(s.d)()?$.Deferred().resolve("gcc").promise():Object(I.f)()||Object(h.d)()?$.Deferred().resolve("msa").promise():Object(I.g)()||Object(h.e)()?$.Deferred().resolve("msft").promise():Object(I.e)()||Object(h.f)()?$.Deferred().resolve("fastfood").promise():$.Deferred().resolve("business").promise()}return r}().done((function(e){t.headers["x-ms-form-request-ring"]=e})));var D=-1,R=Object(l.a)("DatabaseUnavailableRetryTimes")||10,E=function(){D++,function(t,e,n,r){void 0===r&&(r=!1);t.blobResponseType?function(t,e,n){var r=new XMLHttpRequest,i=t.requestUri;if(r.onreadystatechange=function(){if(null!=r&&4===r.readyState){var o=r.status,u=r.statusText;1223===o&&(o=204,u="No Content");var c=r.response;if(o>=200&&o<=299)r=null,e(c);else{var s=function(t){for(var e={},n=0,r=t.getAllResponseHeaders().split(/\r?\n/);n<r.length;n++){var i=r[n];if(i){var o=i.split(": ");e[o[0]]=o[1]}}return e}(r);r=null,n({message:"HTTP request failed",request:t,response:{requestUri:i,statusCode:o,statusText:u,headers:s,body:c}})}}},r.open(t.method||"GET",i,!0),r.responseType="blob",t.headers)for(var o in t.headers)r.setRequestHeader(o,t.headers[o]);r.send(t.body)}(t,e,r?n:i):P(t,e,r?n:i);function i(r){Object(c.d)(r)?Object(g.a)().AuthContext.refreshToken().done((function(){Object(m.e)((function(){t.headers.__RequestVerificationToken=Object(d.a)().antiForgeryToken,function(){var t=$.Deferred();if(Object(d.a)().userInfo.UserId)return t.resolve().promise();return Object(m.g)((function(){return t.resolve()}),(function(){return t.resolve()})),t.promise()}().always((function(){return P(t,e,n)}))}),v.d)})):n(r)}}(t,(function(t){b.resolve(t)}),(function(n){var r,i=k(t.isSensitiveUri?"":t.requestUri.toString(),n),o=parseInt(i.statusCode),c=i.innerCode,s=!1,a=0;if(0===o||502===o||503===o)r="Forms_Http_"+o,s=D<2;else if(6503===c||624===c||647===c)r="CDB_Http_"+c,s=D<2;else if(645===c||646===c){Object(g.a)().RetryingRecoverableError=!0,r="CDB_Http_"+c,s=D<R;var f=[2,16,32,64],l=D>=f.length?64:f[D];e.hasPrefetch&&(l*=2),a=1e3*Math.min(l,64)*(.8+.4*Math.random())}s?(u&&u.log({resultCode:r,extraData:{RetryCount:D,RetryInterval:a,ServiceError:i}}),setTimeout(E,a)):b.reject(n)}),e.skipExpiredTokenCheck)};return E(),u?b.promise().done((function(e){var n={};if(n.resultCode=e&&e.response?e.response.statusCode:"",n.resultType="Success","Form.Create"===t.qosEventName){var r=Object(S.e)(e);n.extraData={FormId:r.id,XLWorkbookId:r.xlWorkbookId||void 0,Origin:Object(j.a)()||void 0,RetryCount:D||void 0},o.extend(n.extraData,t.qosExtraData)}u.end(n)})).fail((function(e){var n=k(t.requestUri.toString(),e);u.end({resultCode:e&&e.response?e.response.statusCode:"",resultType:Object(w.b)(n)?"ExpectedFailure":"Failure",extraData:{ServiceError:n,RetryCount:D||void 0}})})):b.promise()}function k(t,e){var n=Object(S.b)(e);return{statusCode:e&&e.response?e.response.statusCode:"",sourceUrl:t,correlationId:e&&e.response?Object(b.c)(e.response.headers,"X-CorrelationId"):"",statusText:e&&e.response?e.response.statusText:"",innerCode:n?n.innerCode:-1,innerMessage:n?n.innerMessage:"",failureReason:e&&e.response?Object(b.c)(e.response.headers,"X-FailureReason"):"",failureType:n?n.type:void 0}}function P(t,e,n){Object(u.a)().then((function(){return odatajs.oData.request(t,e,n)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),i=n(43),o=n(30),u=n(16),c=function(){function t(t){this.In={correlationId:Object(o.b)(),duration:0,eventName:t,eventType:"qos_event",extraData:void 0},this.Sn=null}var e=t.prototype;return Object.defineProperty(e,"CorrelationId",{get:function(){return this.In.correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraData",{get:function(){return this.In.extraData},set:function(t){this.In.extraData=t},enumerable:!1,configurable:!0}),e.start=function(){this.Sn=Object(i.b)();var t=this.pe(this.In,"Start");Object(u.a)(t)},e.end=function(t){var e=this.pe(t,"End");Object(u.a)(e)},e.log=function(t){var e=this.pe(t,"Log");Object(u.a)(e)},e.pe=function(t,e){var n=r.clone(this.In);switch(null!==this.Sn&&"Start"!==e&&(n.duration=Object(i.b)()-this.Sn),t.logLevel&&(n.logLevel=t.logLevel),t.extraData&&(n.extraData=t.extraData),e){case"Start":n.eventName+="."+e;break;case"Log":n.eventName+="."+e,t.resultCode&&(n.eventName+="."+t.resultCode);break;case"End":t.resultType&&(n.eventName+="."+t.resultType)}return n},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),i=function(){};!function(t){var e=function(){function t(t,e){void 0===e&&(e=0),this.Fn=t,this.yn=e}var e=t.prototype;return e.callOnceLater=function(){var t=this;0!==this.yn&&null!=this.Nn&&this.clear(),null==this.Nn&&(this.Nn=window.setTimeout((function(){t.callImmediately()}),this.yn))},e.flush=function(){null!=this.Nn&&(this.clear(),this.Fn())},e.callImmediately=function(){null!=this.Nn&&this.clear(),this.Fn()},e.clear=function(){clearTimeout(this.Nn),this.Nn=void 0},t}();t.CallLater=e;var n=function(){function t(){this.Tn=[]}var e=t.prototype;return e.register=function(t){this.Tn.push(t)},e.unregister=function(t){this.Tn=r.without(this.Tn,t)},Object.defineProperty(e,"trigger",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),e.clear=function(){this.Tn=[]},e.Pn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Tn.forEach((function(e){return e.apply(void 0,t)}))},t}();t.CallbackManager=n}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return l}));var r=n(2),i=n(3),o=n(4),u=n(6),c=n(7),s=n(38),a=n(20),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(e,"MinimumOptionsForDropDown",{get:function(){return 7},enumerable:!1,configurable:!0}),e.getElementTypeName=function(){return"Question.Choice"},e.createDefaultDefinition=function(){var t=[{Description:Object(u.a)().fiknfhm.format(1),IsGenerated:!0},{Description:Object(u.a)().fiknfhm.format(2),IsGenerated:!0}];return{Type:e.getElementTypeName(),Title:Object(u.a)().nfkdbdh,Choices:t,ChoiceType:a.a.SingleChoice,OptionDisplayStyle:a.c.ListAll,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&t.OptionDisplayStyle!==a.c.Dropdown},n.verify=function(t){return!this.Model.Required||t&&"[]"!==t?t&&t.length>e.MaxAnswerLength?a.e.MultiChoiceQuestionLengthLimitError:a.e.Success:a.e.RequiredError},n.isEmpty=function(t){return this.Model.ChoiceType===a.a.SingleChoice?!t:!t||"[]"===t},n.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case a.a.SingleChoice:return Object(u.a)().lhfalpf;case a.a.MultiChoice:return Object(u.a)().flpohgm;default:throw Error("Choice Question Type Not Supported")}},n.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==a.a.SingleChoice},n.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===a.a.SingleChoice},n.getSnapshotWithoutBranchInfo=function(){var e=t.prototype.getSnapshotWithoutBranchInfo.call(this);return e.Choices=o.a.convertToArray(e.Choices).map((function(t){return delete(t=i.clone(t)).BranchInfo,t})),e},n.resetBranchInfo=function(){var e=this;t.prototype.resetBranchInfo.call(this),o.a.convertToArray(this.Model.Choices).filter((function(t){return e.getBranchInfoMaster(t.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},n.insertChoice=function(t,e){var n=this.Model.Choices,r=i.find(n,(function(t){return t.IsGenerated}));if(!r||e&&""!==r.Description){var u=o.a.Collection.addItems(n,[{Description:t,IsMathOption:e}]);r=u[0]}else{var s=o.a.getObjectMasterFromModel(r);Object(c.c)((function(){s.bulkEdit((function(){r.Description=t,r.IsGenerated=null,r.IsMathOption=e}))}),c.e)}return r},n.hasCorrectAnswers=function(t){return t?i.some(t.IsAnswerKeys):i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))},n.isCorrectAnswer=function(t){var e=l(t,this.Model),n=o.a.convertToArray(this.Model.Choices).filter((function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();return i.isEqual(n,e.SelectedOptions.sort())},n.justifyQuestionInfo=function(){var t=this.Master.Model;if(null==t.OptionDisplayStyle){var n=t.ChoiceType===a.a.SingleChoice&&!t.IsMathQuiz&&!t.AllowOtherAnswer&&t.Choices.length>=e.MinimumOptionsForDropDown;t.OptionDisplayStyle=n?a.c.Dropdown:a.c.ListAll}},n.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===a.c.Dropdown},n.setAnswerKey=function(t,e){var n=this;this.Master.bulkEdit((function(){t.IsAnswerKey=e,n.Model.ChoiceType===a.a.SingleChoice&&t.IsAnswerKey&&o.a.convertToArray(n.Model.Choices).forEach((function(e){e.IsAnswerKey&&e!==t&&(e.IsAnswerKey=!1)}))}))},n.createQuizResult=function(t){if(this.Model.IsQuiz){var e=o.a.convertToArray(this.Model.Choices);return e.some((function(t){return t.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(t),AnswerHints:e.map((function(t){return t.AnswerHint})),IsAnswerKeys:e.map((function(t){return t.IsAnswerKey})),Choices:e.map((function(t){return t.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},n.autoGradeAnswer=function(e){if(i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))){var n=this.Model.Point?this.Model.Point:0;e.Score=this.isCorrectAnswer(e.Answer)?n:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getBranchingResult=function(e){var n=this;if(this.Model.ChoiceType!==a.a.SingleChoice)return t.prototype.getBranchingResult.call(this,e);var r=o.a.convertToArray(this.Model.Choices),u=r.filter((function(t){return t.BranchInfo&&o.a.getObjectMasterFromModel(t.BranchInfo).isValid()})),c=o.a.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===u.length&&!c.isValid())return t.prototype.getBranchingResult.call(this,e);var s,f=r.filter((function(t){return n.Cn(e,t)})),l=i.intersection(f,u);l.length>0||f.length>0?s=(l[0]||f[0]).BranchInfo:this.isEmpty(e)||(s=this.Model.BranchInfoForOtherChoice);return s?this.getBranchInfoMaster(s).getBranchingResult():{Type:"Pending"}},n.Cn=function(t,e){return e.Description===t},e.MaxAnswerLength=4e3,e}(s.a);function l(t,e){var n=e.ChoiceType===a.a.SingleChoice;if(null!=t){var r=o.a.convertToArray(e.Choices).map((function(t){return t.Description}));if(!n||!e.AllowOtherAnswer&&!i.contains(r,t))try{var u=JSON.parse(t);if(Array.isArray(u)){if(!u.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:u}}else if(i.isObject(u)){var c=i.values(u);if(!c.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:n&&c.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:c}}}catch(t){}}return{IsSingleChoiceAnswer:n,IsLegacyChoiceAnswer:!1,SelectedOptions:null==t?[]:[t]}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(2),i=n(1),o=n(68),u=n(5),c=n(6),s=n(9),a=n(56),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.Ln=new Image,e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.ThemeMaster;e&&(this.Mn=function(e){e.NewValues.Name===Object(c.a)().kifggfi&&e.NewValues.BackgroundImage!==t.state.ImageUrl?t.setState({ImageUrl:e.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):t.forceUpdate()},e.observe(this.Mn))},n.componentWillUnmount=function(){var t=this.props.ThemeMaster;this.ce=!1,t&&t.unobserve(this.Mn)},n.render=function(){var t,n=this,r=this.props.ThemeMaster;if(!(t=Object(s.n)()&&Object(u.a)().themeInfo?e.getSPOTheme(Object(u.a)().themeInfo):r&&r.Model))return null;var o=t.Name,a=t.PrimaryColor,f=t.SecondaryColor,l=t.BackgroundColor,h=t.BackgroundImage;h&&h.match("url((.*))")&&(h=h.substring(4,h.length-1)),o===Object(c.a)().kifggfi&&h&&(this.state.IsBackgroundImgCached||(this.Ln.src=h,this.Ln.onload=function(t){n.ce&&n.setState({ImageUrl:h,IsBackgroundImgCached:!0})},h+="_mo"));var d="";return d+=".office-form-theme-primary-color { color:"+a+"; }",d+=".office-form-theme-secondary-color { color:"+f+"; }",d+=".office-form-theme-primary-background { background:"+a+"; color:#FFFFFF; }",d+=".office-form-theme-secondary-background { background:"+f+"; }",d+=".office-form-theme-primary-foreground, ",d+=".office-form-theme-primary-foreground a, ",d+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",d+=".office-form-theme-primary-foreground.rateit .rateit-hover",d+="{ color:"+a+"; } ",d+=".office-form-theme-border-top { border-top-color:"+a+"; }",d+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:"+a+"; }",d+=".office-form-theme-spinner { border-color:"+a+" #C7E0F4 #C7E0F4;}",d+=".office-form-theme-border { border-color:"+a+";}",d+=".office-form-theme-interactive-background.active { background-color:"+a+"; }",d+=".office-form-theme-interactive-background:hover { background-color:"+f+"; }",d+=".office-form-theme-interactive-background:focus { background-color:"+f+"; }",d+=".office-form-theme-interactive-background:active { background-color:"+f+"; }",d+=".office-form-theme-button-lightbackground { color:"+a+"; }",d+=".office-form-theme-button-lightbackground.active { background-color:"+f+"; }",d+=".office-form-theme-interactive-color { color:"+a+"; }",d+=".office-form-theme-interactive-color:hover { color:"+f+"; }",d+=".office-form-theme-interactive-color:focus { color:"+f+"; }",d+=".office-form-theme-interactive-color:active { color:"+f+"; }",d+=".office-form-theme-button { color: white; background:"+a+"; }",d+=".office-form-theme-button:hover { background:"+f+"; }",d+=".office-form-theme-button:focus { background:"+f+"; }",d+=".office-form-dark-theme-button {color:"+f+"}",d+=".office-form-dark-theme-button:hover { color:"+f+"; }",d+=".office-form-dark-theme-button:focus { color:"+f+"; }",d+=".office-form-theme-page-background-active.active { background :"+a+"; color: #FFFFFF; }",d+=".office-form-theme-page-foreground-active.active, ",d+=".office-form-theme-select-color.active *{ color: "+a+"; }",d+=".office-form-theme-toggle.active { background: "+a+"; border-color:"+a+"; }",d+=".office-form-theme-border { border-color:"+a+"; }",d+=".office-form-theme-outline { outline-color:"+a+"; }",d+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+a+"; outline-color:"+a+"; }",d+=".office-form-theme-button-foreground.active:hover { background: "+f+"; outline-color:"+f+"; }",d+=".office-form-theme-quiz-point { color:"+f+"; }",d+=".office-form-theme-quiz-totalPoints-bar {color:"+a+"; }",d+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+l+"; outline: 1px solid transparent; }",d+=".office-form-theme-image-container-border { border: 3px solid "+l+"; }",d+=".office-form-sortable-chosen .office-form-sort-item { background: "+a+"; color:white; }",d+=".office-form-theme-sort-item { color: white; background:"+a+"; }",d+=".office-form-theme-sort-item:hover { background:"+f+"; }",d+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus{ border-color: "+a+"; outline-color:"+a+"; }",d+=".office-form-theme-bgcolor-hover:hover { background:"+l+"; }",d+=".office-form-theme-button-color:hover *{ color:"+f+"; }",d+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+f+"; background-color:"+l+";}",d+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+a+"; background-color:"+l+"; color:"+a+";}",d+=".office-form-insight-theme-control .simple-data-control-content { color : "+a+"; }",d+=".office-form-insight-theme-control .simple-data-control-description { color : "+a+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+f+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+f+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+f+"; }",d+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+a+"; }",d+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover{color:"+f+"; }",d+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+a+"; }",d+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+f+"; }",d+=".office-form-theme-spo-link { color:"+a+"; }",d+=".office-form-theme-spo-link:hover { color:"+f+"; }",Object(s.n)()||(h?(d+=".thank-you-page-content { opacity:.97; }",d+=".introduction-for-responser-container { opacity:.97; }",Object(s.k)()?(d+=".office-form-theme-page-background { background-color:"+l+"; }",d+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(d+=".office-form-theme-page-background { background-image: url("+h+"); }",d+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),d+=".preview-mobile-container.office-form-theme-page-background { background:"+l+"; }",d+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(d+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",d+=".office-form-theme-page-background { background-color:"+l+"; }")),h&&o!==Object(c.a)().kifggfi?d+=".office-form-theme-shadow { box-shadow : none; }":d+=".office-form-theme-shadow { box-shadow: 0 0 11px rgba(0,0,0,.12); }",o===Object(c.a)().kifggfi&&(d+=".office-form-body { opacity: 0.97; }"),i.createElement("style",null,d)},e.getSPOTheme=function(t){var e=Object(o.d)(t);return{BackgroundColor:Object(o.e)(e),BackgroundImage:null,Name:a.a,PrimaryColor:e,SecondaryColor:Object(o.f)(e),Thumbnail:null}},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),i=n(12),o=n(5),u=n(107);function c(t,e){var n;if(Object(u.b)(t))n=t;else if(t){var c=t;if(c.isFieldReady(i.a.Schema.OwnerId)&&!c.IsGroupForm&&c.Model.OwnerId!==Object(o.a)().userInfo.UserId)return!1;c.isFieldReady(i.a.Schema.Category)&&(n=c.Model.Category)}return!!n&&r.contains({Poll:["Settings.AllowResponderGetAllResponses","DisableEditForm","ResponsePage.PollView"],"Teams Poll":["DisableEditForm"]}[n],e)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return m}));var r=n(2),i=n(1),o=n(27),u=n(11),c=n(8),s=n(21),a=n(60),f=n(33),l=n(22);function h(t){var e;return e=Object(c.c)("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",i.createElement("div",{className:"image-spinner",id:t&&d(t)},i.createElement("div",{className:e}))}function d(t){return"imageSpinner-"+t.ResourceId}var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.xn=function(){return e.forceUpdate()},e.Dn=function(){return e.Rn()},e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(s.f)().Schema,e=Object(s.g)().Schema;this.props.ImageSettings.observe(this.xn),this.props.Image.observe(this.xn,[t.ResourceUrl,t.ContentType,t.OriginalFileName]),this.props.ImageSettings.observe(this.Dn,[e.ContainerHeight,e.ContainerWidth,e.Left,e.Top]),this.props.Image.observe(this.Dn,[t.AltText]),this.En()},n.componentDidUpdate=function(){this.En()},n.componentWillUnmount=function(){this.ce=!1,this.props.ImageSettings.unobserve(this.xn),this.props.Image.unobserve(this.xn),this.props.ImageSettings.unobserve(this.Dn),this.props.Image.unobserve(this.Dn)},n.render=function(){var t=this,e=this.props.Image.Model,n=this.props.ImageSettings.validateImageSettings(!0),r=0;return i.createElement("img",{src:e.ResourceUrl,title:e.AltText,alt:e.AltText,height:n.ContainerHeight+"px",width:n.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){l.a.logData({name:"Image.ImageOnLoad.Success",extraData:{imageType:t.props.ImageType,location:"1"}})},onError:function(n){if(r<3&&"Response"===Object(u.n)()){var i=o.findDOMNode(t);r++;var c=e.ResourceUrl+"?"+r;window.setTimeout((function(){$(i).attr("src",c)}),1e3)}else l.a.logData({name:"Image.ImageOnLoad.Failure",extraData:{imageSrc:e.ResourceUrl,imageType:t.props.ImageType,location:"1"}})}})},n.En=function(){var t=this,e=this.props.Image&&this.props.Image.Model;if(e&&e.ResourceUrl&&!this.An()){var n=o.findDOMNode(this),r=0;n&&this.props.ImageSettings&&(n.onload=function(){return t.Rn()},n.onerror=function(i){if(r<3&&"Response"===Object(u.n)()){r++;var o=e.ResourceUrl+"?"+r;window.setTimeout((function(){$(n).attr("src",o)}),1e3)}else{l.a.logData({name:"Image.CanvasOnLoad.Failure",extraData:{imageSrc:n.src,imageType:t.props.ImageType,location:"1"}});var c=document.getElementById(d(e));c&&$(c).css("display","none"),$(n).css("visibility","visible")}})}},n.Rn=function(){if(this.ce){var t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.An()){var e=o.findDOMNode(this);if($(e).siblings("canvas").remove(),e&&this.props.ImageSettings)try{var n=document.createElement("canvas"),r=this.props.ImageSettings.validateImageSettings(!0);null!=t.AltText&&(n.title=t.AltText),n.tabIndex=-1;var i=1*r.NaturalWidth/r.ActualWidth,u=Math.abs(r.Left*i);u=Math.floor(Math.min(u,r.NaturalWidth));var c=Math.abs(r.Top*i);c=Math.floor(Math.min(c,r.NaturalHeight));var s=r.ContainerWidth*i||r.NaturalWidth;s=Math.floor(Math.min(s,r.NaturalWidth));var f=r.ContainerHeight*i||r.NaturalHeight;f=Math.floor(Math.min(f,r.NaturalHeight));try{var h=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;h=Math.ceil(Math.max(h,i)),n.width=Math.floor(r.ContainerWidth*h),n.height=Math.floor(r.ContainerHeight*h),n.getContext("2d").drawImage(e,u,c,s,f,0,0,n.width,n.height)}catch(t){$(e).css("visibility","visible");var m=t.message||void 0,b=t.stack||void 0;return void l.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:m+" "+b,Exception:"DrawImageCanvas"}})}var v=document.getElementById(d(t));v&&$(v).css("display","none"),$(e).css("display","none"),$(e).parent().append(n),l.a.logData({name:"Image.CanvasRender.Success",extraData:{imageType:this.props.ImageType,location:"1"}}),Object(a.d)()}catch(t){m=t.message||void 0,b=t.stack||void 0;throw l.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:m+" "+b,Exception:"CreateImageCanvas"}}),t}}}},n.An=function(){var t=this.props.Image.Model,e=this.props.ImageSettings.Model;return Object(c.c)("RemoveImageTargetResourceId")?t.ImageProcessingStatus!==f.b.Idle:t.ResourceId!==e.TargetResourceId||t.ImageProcessingStatus!==f.b.Idle},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r,i=n(2),o=n(1),u=n(8),c=n(10),s=n(9),a=n(7),f=n(37),l=n(17),h=n(34),d=(n(24),n(35)),m=n(5);var b=n(18),v=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!1,n.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},n._n=n._n.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.ce=!0,b.a.Resolve("IBootEvent").addBootCompleteListener((function(){return t._n()}))},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t={className:Object(s.n)()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"};return o.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},o.createElement("a",Object(i.a)({},t),this.props.LocalizedStrings.pcpodhj))},n._n=function(){var t=this;(function(){if(!r){r=$.Deferred();var t=void 0,e=Object(d.a)();if((null==e?void 0:e.isFieldReady(e.Schema.PrivacyUrl))&&e.Model.PrivacyUrl&&(t=e.Model.PrivacyUrl),!t){var n=Object(d.c)();Object(h.b)().getPrivacySettings(n&&n.OrgId,Object(m.a)().userInfo.TenantId).then((function(t){return r.resolve(t&&t.privacyUrl)}),(function(t){return r.resolve(void 0)}))}}return r.promise()})().done((function(e){t.ce&&t.setState({PrivacyUrl:e||""})}))},e}(l.a),g=n(133),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Un=!1,e}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props.TopExtraContent&&o.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),n=Object(c.a)("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className);this.Un&&Object(u.c)("FormsProCustomFooter"),this.Un&&Object(u.c)("FormsProCustomFooter");return o.createElement(f.a.Consumer,null,(function(r){var i=r.LocalizedStrings;return o.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo"},o.createElement("div",{className:n},e,Object(a.c)((function(){return function(t,e,n){switch(n){case"ShowStatement":return o.createElement("div",{className:"office-form-footer-block"},t);case"ShowStatementWithNotice":return o.createElement("div",{className:"office-form-footer-block"},e);default:return null}}(i.lnkgbjp,i.ngbeege,t.props.FooterType)||!1}),a.e),Object(a.c)((function(){return t.$n(i)}),a.e),function(){if(Object(u.d)())return o.createElement("div",{id:"form-bottom-sentinel",className:"office-form-bottom-sentinel"})}()))}))},n.$n=function(t){var e,n,r,u;return o.createElement("div",{className:"office-form-footer-block"},(e=t.hipklgl,Object(s.n)()?(r=e,u={className:Object(s.n)()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},o.createElement("div",{className:"office-form-footer-inline-without-margin"},o.createElement("a",Object(i.a)({},u),r))):(n=e,o.createElement("div",{className:"office-form-footer-inline-without-margin"},n)))," | ",o.createElement(v,{LocalizedStrings:t})," | ",o.createElement(g.a,{FormMaster:this.props.FormMaster,LocalizedStrings:t,ForceUseCommercialTermsLink:this.props.ForceUseCommercialTermsLink}))},n.Bn=function(t){},e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(1),o=n(3),u=n(10),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(t.className=Object(u.a)(t.className,this.props.ValidationStyle)),this.props.Hidden&&(t.style=t.style||{},t.style.display="none"),i.createElement.apply(i,Object(r.f)(["div",t],this.createReactNodes()))},n.createReactNodes=function(){throw Error("to be overridden.")},e}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){this.prefetchDeferred=$.Deferred(),this.cache=t}var e=t.prototype;return e.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},e.getPromise=function(){return this.prefetchDeferred.promise()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=n(1),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){return i.createElement("span",{className:"required-star"})},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(23),i=(n(124),n(3),n(4),n(24),n(5),n(54),n(21),n(87)),o=(n(15),n(12),n(53),{});new i.a.CallbackManager;var u=function(){function t(t,e){this.Qn=[],this.qn=t,e=e||{},this.Vn=e.deferredTimeInMs||100,this.zn=e.maxCount||10}var e=t.prototype;return e.insert=function(t){var e=this,n=$.Deferred();return this.Qn.push({Arguments:t,Deferred:n}),this.Qn.length>=this.zn?this.Gn():void 0===this.Hn&&(this.Hn=window.setTimeout((function(){return e.Gn()}),this.Vn)),n.promise()},e.Gn=function(){var t=this.Qn;this.Qn=[],void 0!==this.Hn&&(window.clearTimeout(this.Hn),this.Hn=void 0),0!==t.length&&this.qn(t.map((function(t){return t.Arguments}))).done((function(e){if(t.length!==e.length)throw Error("All the elements needs to be listed in result array.");e.forEach((function(e,n){e.Succeeded?t[n].Deferred.resolve(e.Value):t[n].Deferred.reject(e.Error)}))})).fail((function(e){t.forEach((function(t){t.Deferred.reject(e)}))}))},t}(),c={};function s(t,e){return c.hasOwnProperty(e)||(c[e]=new u((function(t){return function(t,e){var n=t.length,i=(u=e,o[u]);var u;if(i)return Object(r.b)(i).copyLocaleResources(e,t).then((function(){for(var t=[],e=0;e<n;++e)t.push({Succeeded:!0,Value:void 0});return t}),(function(t){for(var e=[],r=0;r<n;++r)e.push({Error:t,Succeeded:!1});return e}));return $.Deferred().resolve().promise()}(t,e)}))),c[e].insert(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r,i=n(2),o=n(4),u=n(0),c=n(6),s=n(23);!function(t){t[t.NotStarted=1]="NotStarted",t[t.Opened=2]="Opened",t[t.Expired=3]="Expired",t[t.Closed=4]="Closed"}(r||(r={}));var a={LockGivenQuestionsEndDisplayOrder:u.a.number(),LockGivenQuestionsStartDisplayOrder:u.a.number(),FormClosed:u.a.boolean(),FormClosedMessage:u.a.string(),FormClosedMessageChanged:u.a.boolean(),TimerEnabled:u.a.boolean(),TimerEnabledStart:u.a.boolean(),TimerEnabledEnd:u.a.boolean(),StartTime:u.a.string(),EndTime:u.a.string(),RequiresUniqueResponse:u.a.boolean(),IsAnonymous:u.a.boolean(),NotRecordIdentity:u.a.boolean(),ShuffleAllQuestions:u.a.boolean(),ShuffleQuestionOrder:u.a.boolean(),ShowGradedResults:u.a.boolean(),ShowGradedScores:u.a.boolean(),RespondInAppOnly:u.a.boolean(),AllowCopy:u.a.boolean(),ShareToken:u.a.string(),ManualGradingEnabled:u.a.boolean(),IsQuizMode:u.a.boolean(),EmailNotification:u.a.boolean(),AllowResponderGetAllResponses:u.a.boolean(),ShowQuestionNumbers:u.a.boolean(),IsEmailableEntityCreationEnabled:u.a.boolean(),EmailableEntity:u.a.string()},f=function(t){function e(n){var r=t.call(this,n)||this;return r.addRule({Name:"updateClosedMessage",InterestedFields:[r.Schema.FormClosed],onChange:e.updateClosedMessage}),r.addRule({Name:"updateAllowCopy",InterestedFields:[r.Schema.ShareToken],onChange:e.updateAllowCopy}),r}Object(i.c)(e,t);var n=e.prototype;return e.serialize=function(t){var e=o.a.convertToSourceData(t,this.Schema),n=0;return Object.keys(e).forEach((function(t){null==e[t]?delete e[t]:++n})),n>0?JSON.stringify(e):null},n.getFormStatus=function(){var t=this.Model;if(t.FormClosed)return r.Closed;if(t.TimerEnabled){var e=Date.now();if(null!=t.StartTime&&Date.parse(t.StartTime)>e)return r.NotStarted;if(null!=t.EndTime&&Date.parse(t.EndTime)<e)return r.Expired}return r.Opened},n.getFormClosedMessage=function(){var t=this.Model;switch(this.getFormStatus()){case r.Closed:return t.FormClosedMessage;case r.NotStarted:return Object(c.a)().ogpknli.format(new Date(t.StartTime).toLocaleString());case r.Expired:return Object(c.a)().mobpoef;default:return}},n.setSharingStatus=function(t,e){var n=this,r=this.Parent,i=Object(s.b)(r);return r.existingOnServerSide().then((function(){return i.changeSharingStatus(r.Model.Id,e)})).then((function(t){n.Model.ShareToken=t}))},e.updateClosedMessage=function(t){if(-1===t.FieldSchemas.indexOf(e.Schema.FormClosedMessage)){var n=t.Master.Model;n.FormClosed?null!=n.FormClosedMessage&&Object(c.c)().done((function(t){return n.FormClosedMessage=t.fbnjcle})):n.FormClosedMessage=null}},e.updateAllowCopy=function(t){var e=t.Master.Model;e.AllowCopy=!!e.ShareToken},e}(o.a.createObjectMasterClass("FormSettingsMaster",a))},function(t,e,n){(function(e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,o=void 0,u=void 0,c=function(t,e){m[i]=t,m[i+1]=e,2===(i+=2)&&(u?u(b):j())},s="undefined"!=typeof window?window:void 0,a=s||{},f=a.MutationObserver||a.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(b,1)}}var m=new Array(1e3);function b(){for(var t=0;t<i;t+=2)(0,m[t])(m[t+1]),m[t]=void 0,m[t+1]=void 0;i=0}var v,g,p,O,j=void 0;function w(t,e){var n=this,r=new this.constructor(F);void 0===r[S]&&D(r);var i=n._state;if(i){var o=arguments[i-1];c((function(){return M(i,r,o,n._result)}))}else C(n,r,t,e);return r}function I(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(F);return N(e,t),e}l?j=function(){return e.nextTick(b)}:f?(g=0,p=new f(b),O=document.createTextNode(""),p.observe(O,{characterData:!0}),j=function(){O.data=g=++g%2}):h?((v=new MessageChannel).port1.onmessage=b,j=function(){return v.port2.postMessage(0)}):j=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(b)}:d()}catch(t){return d()}}():d();var S=Math.random().toString(36).substring(2);function F(){}function y(e,n,r){n.constructor===e.constructor&&r===w&&n.constructor.resolve===I?function(t,e){1===e._state?k(t,e._result):2===e._state?P(t,e._result):C(e,void 0,(function(e){return N(t,e)}),(function(e){return P(t,e)}))}(e,n):void 0===r?k(e,n):t(r)?function(t,e,n){c((function(t){var r=!1,i=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?N(t,n):k(t,n))}),(function(e){r||(r=!0,P(t,e))}),t._label);!r&&i&&(r=!0,P(t,i))}),t)}(e,n,r):k(e,n)}function N(t,e){if(t===e)P(t,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=e),null===r||"object"!==i&&"function"!==i)k(t,e);else{var n=void 0;try{n=e.then}catch(e){return void P(t,e)}y(t,e,n)}var r,i}function T(t){t._onerror&&t._onerror(t._result),L(t)}function k(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&c(L,t))}function P(t,e){void 0===t._state&&(t._state=2,t._result=e,c(T,t))}function C(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+1]=n,i[o+2]=r,0===o&&t._state&&c(L,t)}function L(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,u=0;u<e.length;u+=3)r=e[u],i=e[u+n],r?M(n,r,i,o):i(o);t._subscribers.length=0}}function M(e,n,r,i){var o=t(r),u=void 0,c=void 0,s=!0;if(o){try{u=r(i)}catch(t){s=!1,c=t}if(n===u)return void P(n,new TypeError("A promises callback cannot return that same promise."))}else u=i;void 0!==n._state||(o&&s?N(n,u):!1===s?P(n,c):1===e?k(n,u):2===e&&P(n,u))}var x=0;function D(t){t[S]=x++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(F),this.promise[S]||D(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&k(this.promise,this._result))):P(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===I){var i=void 0,o=void 0,u=!1;try{i=t.then}catch(t){u=!0,o=t}if(i===w&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(n===E){var c=new n(F);u?P(c,o):y(c,t,i),this._willSettleAt(c,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===t?P(r,n):this._result[e]=n),0===this._remaining&&k(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;C(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),E=function(){function e(t){this[S]=x++,this._result=this._state=void 0,this._subscribers=[],F!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){N(t,e)}),(function(e){P(t,e)}))}catch(e){P(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return E.prototype.then=w,E.all=function(t){return new R(this,t).promise},E.race=function(t){var e=this;return r(t)?new e((function(n,r){for(var i=t.length,o=0;o<i;o++)e.resolve(t[o]).then(n,r)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},E.resolve=I,E.reject=function(t){var e=new this(F);return P(e,t),e},E._setScheduler=function(t){u=t},E._setAsap=function(t){c=t},E._asap=c,E.polyfill=function(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=E},E.Promise=E,E},t.exports=r()}).call(this,n(139),n(140))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(24),i=n(47),o=n(14);function u(){var t;if(t=Object(r.b)())return t;var e="origin",n=Object(o.c)()[e];return n||(e="oembedsso",Object(o.c)()[e]?"Forms WebPart":Object(i.d)()?"PowerPoint":null)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(1),o=n(7),u=n(17),c=n(125),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.Html;!Object(o.b)((function(){return!0}))&&t.RenderHtml||(e=Object(c.a)(t.Html));var n=Object(o.c)((function(){return e}),o.e);return i.createElement("span",{dangerouslySetInnerHTML:{__html:n}})},e}(u.a);function a(t){return i.createElement(f,Object(r.a)({},t))}var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this;return"RichText"===(this.props.RenderMode||"PlainText")?Object(o.c)((function(){return i.createElement(s,{Html:t.props.Text})}),o.e):i.createElement("span",null,this.props.Text)},e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(24);function i(t,e,n,i){if(Object(r.l)()){var o=$("<a></a>");return o.attr("href",t),e||(e="_blank"),o.attr("target",e),o[0].click(),o.remove(),null}return e||n||i?n||i?i?window.open(t,e,n,i):window.open(t,e,n):window.open(t,e):window.open(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return h}));var r=n(2),i=n(1),o=n(32),u=n(31);function c(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,148))];case 1:return[2,{default:t.sent().PhishingReviewPageNavBar}]}}))}))}function s(t){var e=Object(u.a)(s,c);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}function a(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,149))];case 1:return[2,{default:t.sent().WarningBar}]}}))}))}function f(t){var e=Object(u.a)(f,a);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}function l(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,150))];case 1:return[2,{default:t.sent().PhishingWarningPage}]}}))}))}function h(t){var e=Object(u.a)(h,l);return i.createElement(o.a,null,i.createElement(e,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return U}));var r=n(2),i=n(1),o=n(3),u=n(90),c=n(11),s=n(8),a=n(28),f=n(71),l=n(5),h=n(6),d=n(10),m=n(21),b=n(9),v=n(114),g=n(34),p=n(78),O=n(12),j=n(20),w=n(33),I=n(40),S=n(62),F=n(75),y=n(115),N=n(7),T=n(91),k=n(29),P=n(88);function C(t){var e,n,r,o=t.Master.Question.Model,u=t.Master.SubQuestionRuntimeMasters,c=u[u.length-1];if(t.IsStudentViewMode){if(!(l=(c||t.Master).getScore())&&!o.Point)return;var s=o.Point?o.Point:"-",a=null!=l?l:"-",f=Object(h.a)().njmfajk.format(a,s);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(h.a)().dbchgho.format(f))}if(o.IsQuiz&&!t.HiddenPoint){if(!o.Point)return;if(!t.ShowDesignInfo&&t.ShowQuizResult){var l;a=null!=(l=(c||t.Master).getScore())?l:"-",f=Object(h.a)().njmfajk.format(a,o.Point);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(h.a)().dbchgho.format(f))}return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(e=o.Point,n=Object(h.a)().mhgobkp,r=Object(h.a)().fgbjcbj,(1===e?n:r).format(e)))}}function L(t){var e=t.Master.Model,n=t.Master.Question.Model,r=n.Type===P.a.getElementTypeName(),i="Question.TextField"===n.Type&&!n.Multiline,o="Question.Ranking"===n.Type,u=r||i||o;return!!(n.IsQuiz&&t.ShowQuizResult&&u&&e.QuizResult)&&!e.QuizResult.IsAnswerCorrect}var M=n(58),x=n(134),D=n(116),R=n(117),E=n(17),A=n(113),_=n(112),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Wn=i.createRef(),e.Jn=9,e.Kn=16,e.Xn=o.uniqueId("question"),e.Yn=400,e.Zn=function(){var t={chunks:e.getFormattedDataForImmersiveReader(),title:""},n={uiLang:Object(c.f)()||navigator.language};Object(g.b)().getImmersiveReaderToken().then((function(e){e&&ImmersiveReader&&ImmersiveReader.launchAsync(e,null,t,n)}))},e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.update=function(){return t.forceUpdate((function(){var e=t.props.onHeightChange;e&&e()}))};var e=this.props.Master;e.Question.Form.observe(this.update,[O.a.Schema.HasQuestionMedia]),e.observe(this.update),e.Question.observe(this.update),this.er=Object(y.a)(),this.er.observe(this.update,[this.er.Schema.FormsTenantSettings]);var n=Object(m.f)().Schema;e.Question.ImageInfoMaster.observe(this.update,[n.ResourceUrl,n.ContentType,n.OriginalFileName]),e.Question.ImageSettingsMaster.observe(this.update),this.nr(this.props)},n.componentWillReceiveProps=function(t){this.nr(t)},n.componentWillUnmount=function(){var t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.er.unobserve(this.update),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},n.componentDidMount=function(){var t=$(this.Wn.current),e=t.find(".office-form-question-formula span"),n=t.find(".office-form-question-choice-formula span"),r=t.find(".design-formula-mixer span");Object(f.a)(t.find("span").not(e).not(n).not(r))},n.render=function(){var t={className:"__question__ office-form-question",ref:this.Wn};if("has-error"===this.getValidationStyle()||L(this.props)){var e=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";t.className=Object(d.a)(t.className,e)}var n=this.rr(),o=null;return void 0!==n&&(t.className=Object(d.a)(t.className,"office-form-studentview-question"),o=i.createElement("div",{className:"office-form-feedback-marginbottom-box"})),i.createElement("div",Object(r.a)({},t),this.ir(),this.createQuestionContent(),n,o)},n.createWrongResultLabel=function(){return function(t){if(!t.IsMobile){var e=[];if(L(t)){var n=Object(k.b)({Accessible:!0,HTMLAttributes:{"aria-label":Object(h.a)().mlggnjb.format(t.Ordinal),className:"validation-error-message-wrong-Icon office-form-answerkey"},IconName:"Cancel"});e=[i.createElement("div",{className:"validation-error-circle-big"}),i.createElement("div",{className:"validation-error-circle-small"}),n]}return i.createElement.apply(i,Object(r.f)(["div",{"aria-live":"assertive",role:"alert"}],e))}}(this.props)},n.createReactNodes=function(){throw Error("to be overridden.")},n.createQuestionContent=function(){var t={className:"office-form-question-content office-form-theme-focus-border"},e=this.props.HTMLAttributes;e&&(t=Object(d.f)(e,t));var n=Object(d.a)("office-form-question-element",this.or()?"with-image":""),o=null;return this.isRequiredQuestionError()&&(o=Object(M.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.bfojhmp})),i.createElement("div",Object(r.a)({},t),this.createWrongResultLabel(),this.cr(),i.createElement("div",{className:n},this.createReactNodes()),o)},n.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===j.e.RequiredError&&(e=j.e.RequiredError)})),e===j.e.RequiredError},n.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===j.e.RequiredError&&(e=j.e.RequiredError)})),e===j.e.Success?"has-success":"has-error"},n.getQuestionId=function(){return this.Xn},n.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.Xn+"-required":void 0},n.getQuestionTypeId=function(){return this.Xn+"-questiontype"},n.getElementProps=function(t){var e={"aria-describedby":this.sr(),"aria-labelledby":Object(d.a)(this.lr(),this.dr(),this.getRequiredId(),this.getQuestionTypeId())};return t?Object(d.f)(t,e):e},n.getFormattedDataForImmersiveReader=function(){var t=this.props.Master.Question.Model,e=[];if(e.push({content:this.props.Ordinal+". "+t.Title+(t.Required?" *":"")+"\n"}),t.Point){var n=C(this.props);e.push({content:n.props.children.toString()+"\n\n"})}else e.push({content:"\n"});if(t.Subtitle){var r=t.Subtitle;if("undefined"!=typeof MathJax){var i=MathJax.Hub.getAllJax(null),u=o.find(i,(function(e){return e.originalText===t.Subtitle}));if(u){var c=u.root&&u.root.toMathML&&u.root.toMathML();c&&(c=c.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;"+Object(d.b)(c,!0)+"&#60;![endif]--\x3e")}}e.push({content:""+r,mimeType:"text/html"}),e.push({content:"\n\n"})}var s=document.createElement("i");return s.textContent=Object(d.b)(this.props.LocalizedStrings.glhejpl,!0),e.push({content:s.outerHTML,mimeType:"text/html"}),e},n.nr=function(t){var e=t.Master,n=t.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),n&&(this.questionLocalizedItemMaster=S.a.getQuestionResourceMaster(n,e.Question.Model.Id,e.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[F.a.Schema.title,F.a.Schema.subtitle]))},n.rr=function(){var t=this.props.Master.SubQuestionRuntimeMasters,e=t[t.length-1],n=(e&&e.Model||this.props.Master.Model).AnswerEntity,r=n&&n.Feedback;if(this.props.IsStudentViewMode&&r){var o={HTMLAttributes:{className:Object(d.a)("feedback-icon forms-icon-size16x16",Object(b.g)()?"edge":void 0,Object(b.h)()?"ie":void 0),role:"presentation"},IconName:"Chat"};return i.createElement("div",{className:"office-form-feedback-box"},Object(k.b)(o),i.createElement("div",{className:"office-form-feedback-content"},Object(x.a)({content:r})))}},n.br=function(){var t=this,e=this.props.Master.Question.Model,n=this.questionLocalizedItemMaster,r=n&&n.Model,o=this.props.Master.Question.Form.Model.HasQuestionMedia,c=r&&r.title||e.Title,a=Object(N.c)((function(){return c}),N.e),f=!this.props.HideMedia&&(e.ImageInfo&&e.ImageInfo.ResourceUrl||o)?"office-form-question-title with-image":"office-form-question-title",l=this.props.Master.Question.Form,h=Object(u.a)(l,"ResponsePage.PollView"),d=Object(N.c)((function(){return!(t.or()||h)}),N.e),m={"aria-level":2,className:f,id:this.dr(),role:"heading"},b=e.Required?this.props.LocalizedStrings.mdbicgo:void 0,v=null;b&&(v=i.createElement("div",{key:"accessibilityNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},b)));var g=this.vr(),p=this.gr(),O=null;p&&(O=i.createElement("div",{key:"questionTypeNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},p)));var j={children:[g,v,O,C(this.props)],HTMLAttributes:m,key:this.getQuestionId().toString(),Label:a,Ordinal:this.props.Ordinal,ShowOrdinal:d,ShowRequiredStar:e.Required,Theme:this.props.Theme};return Object(s.c)("InformUserWhenUploadFileControl")?this.getLabel(j):Object(M.a)(j)},n.getLabel=function(t){return Object(M.a)(t)},n.gr=function(){var t=this.props.Master.Question.Model,e="";switch(t.Type){case"Question.Choice":e=t.ChoiceType===j.a.MultiChoice?this.props.LocalizedStrings.flpohgm:this.props.LocalizedStrings.lhfalpf;break;case"Question.DateTime":e=this.props.LocalizedStrings.phcdjjp;break;case"Question.Rating":e=this.props.LocalizedStrings.nngbaol;break;case"Question.TextField":e=t.Multiline?this.props.LocalizedStrings.emlmoca:this.props.LocalizedStrings.goinnmm;break;case"Question.Ranking":e=this.props.LocalizedStrings.kfpfphf;break;case"Question.MatrixChoiceGroup":e=this.props.LocalizedStrings.ofmmaji}return e},n.pr=function(){return i.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},i.createElement("span",{id:this.lr()},this.props.Ordinal))},n.cr=function(){var t,e,n,o,u=this.props.Master.Question,c=u.Model,s=u.Form.Model.HasQuestionMedia,f={},l="office-form-question-subtitle",h=this.props.IsMobile||Object(b.r)()||c.ImageSettings.Layout===I.a.Horizontal&&c.ImageSettings.Size===I.c.Large,m=u.hasValidVideoUrl(),g=h||m;if(this.props.HideMedia||m||!(c.ImageInfo&&c.ImageInfo.ResourceUrl||s||c.ImageInfo.ImageProcessingStatus===w.b.Uploading||c.ImageInfo.ImageProcessingStatus===w.b.Picking)){if(!this.props.HideMedia&&m){var O=Object(b.k)();l="office-form-question-subtitle with-video";var j=c.VideoInfo;if(f.className=Object(d.a)(f.className,"question-title-container office-form-theme-video-question-background"),Object(v.a)(j.Url,u.Form))o=i.createElement(A.a,{IsMobile:O,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:j.Url});else{var S={allowFullScreen:!0,frameBorder:"0",height:this.Or(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:j.Url,width:"100%"};t=i.createElement("div",{className:"office-form-question-video-container"},i.createElement("iframe",Object(r.a)({},S)))}}}else{f.className="question-title-container office-form-theme-image-question-background",l="office-form-question-subtitle with-image";var F=h?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(c.ImageInfo&&c.ImageInfo.ResourceUrl){var y=u.ImageSettingsMaster.validateImageSettings(),k={className:F,style:h?void 0:{width:"{0}px".format(y.ContainerWidth)}},P=Object(T.b)(c.ImageInfo);t=i.createElement("div",Object(r.a)({},k),i.createElement(T.a,{Image:u.ImageInfoMaster,ImageSettings:u.ImageSettingsMaster,ImageType:"Question"}),P,i.createElement(_.a,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(c.ImageInfo.ImageProcessingStatus===w.b.Uploading||c.ImageInfo.ImageProcessingStatus===w.b.Picking){k={className:F,style:{height:"{0}px".format(Object(a.g)()),width:"{0}px".format(Object(a.h)())}};t=i.createElement("div",Object(r.a)({},k),Object(T.b)())}}if(this.jr())if(c.IsMathQuiz&&!c.IsPlainTextInMathField){var C=Object(p.c)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:c.Subtitle,onRenderComplete:this.props.onHeightChange});e=i.createElement("div",{className:"office-form-question-formula"},C)}else{var L=this.questionLocalizedItemMaster,x=L&&L.Model,D=Object(N.c)((function(){return x&&x.subtitle||c.Subtitle}),N.e);n=Object(M.a)({HTMLAttributes:{className:l,id:this.sr()},HtmlContent:!1,Label:D})}return i.createElement("div",{className:"question-title-box"},i.createElement("div",Object(r.a)({},f),g?void 0:t,g?void 0:o,this.wr()?this.pr():void 0,this.br(),n,g?t:void 0,g?o:void 0,e))},n.wr=function(){var t=this;this.props.Master.Question.Form;return Object(N.c)((function(){return t.or()}),N.e)},n.vr=function(){return!Object(b.h)()&&Object(s.c)("ImmersiveReaderInForms")&&this.props.ShouldShowImmersiveReaderButtons?i.createElement("button",{className:"immersive-reader-button","data-locale":Object(c.f)()||navigator.language,"aria-label":Object(h.a)().fnkbjlg,onClick:o.debounce(this.Zn,this.Yn,!0)}):null},n.ir=function(){var t,e=this,n=this.props.Master.Question.Model;return n.CoAuthors&&n.CoAuthors.length>0?n.CoAuthors[n.CoAuthors.length-1].userId!==Object(l.a)().userInfo.UserId&&(t=o.map(n.CoAuthors,(function(t){if(t.userId!==Object(l.a)().userInfo.UserId){var n={ariaLabel:e.props.LocalizedStrings.mamhmjl.format(t.displayName||t.userId,e.props.Ordinal||0),displayText:Object(R.a)(t.displayName,t.firstName,t.lastName),email:t.email,isCoAuthUser:!0,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId};return i.createElement(D.a,Object(r.a)({},n))}}))):t=void 0,i.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},t)},n.Or=function(){if(Object(b.k)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(this.Kn/this.Jn)}return Object(a.c)()},n.lr=function(){return this.or()?this.Xn+"-ordinal":void 0},n.dr=function(){return this.Xn+"-title"},n.sr=function(){return this.jr()?this.Xn+"-subtitle":void 0},n.or=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},n.jr=function(){var t=this.props.Master.Question.Model;return t.ShowSubtitle&&!!t.Subtitle},e}(E.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(1),o=n(3),u=n(10),c=(n(7),n(105)),s=n(29);function a(t){var e,n,a=o.clone(t)||{};switch(a.HTMLAttributes=o.clone(a.HTMLAttributes)||{},t.GlyphButtonStyle){case 1:case"Vertical":a.HTMLAttributes.className=Object(u.a)(a.HTMLAttributes.className,"glyph-button-control-vertical");break;case 2:case"GlyphOnly":case 0:case"Horizontal":default:a.HTMLAttributes.className=Object(u.a)(a.HTMLAttributes.className,"glyph-button-control-horizontal")}if(!a.HTMLAttributes.title&&t.Text&&(a.HTMLAttributes.title=t.Text),!a.HTMLAttributes["aria-label"]&&t.Text&&(a.HTMLAttributes["aria-label"]=t.Text),t.Icon){var f={HTMLAttributes:{className:t.IconClassName},IconName:t.Icon,key:"icon"};e=i.createElement(s.a,Object(r.a)({},f))}switch(a.ButtonStyle=t.ButtonStyle,"GlyphOnly"!==t.GlyphButtonStyle&&2!==t.GlyphButtonStyle&&(n=i.createElement("span",{className:t.TextClassName,key:"text"},t.Text)),t.GlyphLocation){case 1:case"Right":a.children=[n,t.children,e];break;case 0:default:a.children=[e,n,t.children]}return Object(c.b)(a)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));var r=n(2),i=n(1),o=n(27),u=n(3),c=n(10);function s(t){return i.createElement(a,Object(r.a)({},t))}var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=u.extend({},this.props.HTMLAttributes);switch(t.className=Object(c.a)(t.className,"button-control"),t["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(t.className=Object(c.a)(t.className,"active")),this.props.ButtonStyle){case"LightBackground":t.className=Object(c.a)(t.className,"light-background-button");break;case"DarkBackGround":t.className=Object(c.a)(t.className,"dark-background-button")}return i.createElement("button",Object(r.a)({},t),i.createElement("div",{className:"button-content"},this.props.children))},n.focus=function(){o.findDOMNode(this).focus()},n.setTabIndex=function(t){o.findDOMNode(this).setAttribute("tabIndex",t.toString())},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(6);function i(t){var e=Object(r.a)();switch(t){case"1001":return e.amjjada;case"10203":return e.lgaafpj;case"10204":return e.glggglg;case"10205":return e.oiefooi;case"10206":return e.pbeonmg;case"10207":return e.hhjeaef;case"10208":return e.mdgbnhb;case"10300":return e.ibgmmkp;case"10301":return e.bhlobcb;case"1204":return e.ipdnnle;case"15001":return e.ehcoplh;case"15003":return e.fpfcpap;case"15429":return e.nfhpmbf;case"1624":return e.pgcphgj;case"20000":return e.jkkaadi;case"20001":return e.dfekdao;case"5001":return e.mlnkpma;case"5002":return e.plfohai;case"5003":return e.hehenig;case"5004":return e.bmpbppl;case"5005":return e.pjmlelp;case"5006":return e.ngkbaep;case"5109":return e.jneecfi;case"5114":return e.cdkfjhm;case"5117":return e.dbenokf;case"5203":return e.gckahld;case"5204":return e.agbicjp;case"5205":return e.iflnbfb;case"5206":return e.iehbngm;case"5207":return e.hoobfjn;case"5208":return e.jfijdbj;case"5209":return e.hbphmfn;case"5302":return e.hkfhifn;case"532":return e.njbfklb;case"533":return e.pkhhcnk;case"534":return e.aihplji;case"535":return e.kbmlaep;case"536":return e.piigooe;case"537":return e.piipaba;case"5400":return e.mmjpojj;case"5401":return e.fhohedh;case"5402":return e.agekjjl;case"5403":return e.khlaeab;case"5501":return e.hhomccl;case"5503":return e.ldhkllp;case"5504":return e.logabhi;case"5550":return e.ogjmamm;case"5551":return e.nkggojp;case"5552":return e.ednojag;case"5553":return e.hjjbjkg;case"5554":return e.ncjgihc;case"5556":return e.ghojedk;case"5557":return e.loicicf;case"5558":return e.gknigab;case"5559":return e.akidnil;case"5560":return e.hphkplf;case"600":return e.dkgljdb;case"601":return e.cdhohgc;case"602":return e.bomaaio;case"603":return e.pghnjhl;case"604":return e.mfbmiin;case"605":return e.fnaofdc;case"606":return e.dpnkgnm;case"607":return e.bplmiie;case"608":return e.heboagg;case"609":return e.dhhlebm;case"610":return e.eehjhmi;case"6100":return e.gdegaca;case"6102":return e.ckbjpeb;case"6103":return e.nadfahn;case"6105":return e.gfjmldn;case"611":return e.mhkjkcj;case"613":return e.jlockkp;case"614":return e.knfodag;case"615":return e.ifhencf;case"620":return e.lkeckpk;case"624":return e.nbhgonc;case"625":return e.dgcgecp;case"6252":return e.gbmikjb;case"6254":return e.dehfdah;case"636":return e.dcjcpka;case"642":return e.oihgfbn;case"645":return e.bhdclbh;case"650":return e.ombbabj;case"651":return e.ijjimol;case"652":return e.lloaghf;case"653":return e.kmiabml;case"654":return e.ikepmcd;case"655":return e.hngmgcg;case"656":return e.igopcmj;case"657":return e.chaidho;case"658":return e.kcpjjbp;case"6611":return e.kfipeaa;case"6612":return e.gelgocg;case"6613":return e.elokhbn;case"6614":return e.fdnkpmg;case"6700":return e.pphfmcp;case"6701":return e.blngpgn;case"6702":return e.pmgcmej;case"6705":return e.ahlpmjc;case"674":return e.jbadljl;case"700":return e.oipjmdg;case"701":return e.mfijbdg;case"702":return e.jfjakee;case"703":return e.lklhodc;case"704":return e.ekdkcgc;case"705":return e.combdkk;case"707":return e.lmljaef;case"709":return e.fedkdkk;case"710":return e.cmeopoo;case"711":return e.jegicbk;case"712":return e.mpnjjej;case"714":return e.ffhplgo;case"715":return e.kdidfpl;case"717":return e.gmgbcbn;case"751":return e.pjjjoja;case"752":return e.bbbdmmb;case"754":return e.njclgnd;case"755":return e.jdgflin;case"756":return e.epfopbk;case"812":return e.mafihie;case"824":return e.kndcbfg;default:return""}}},function(t,e,n){"use strict";function r(t){return"number"==typeof t}function i(t){return"string"==typeof t}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(5);function i(){return Object(r.a)().isHashResourceEnabled?"GetHashResourceStrings":"GetResourceStrings"}function o(){var t=Object(r.a)().resourceStringsLoadedInServer;return Object(r.a)().isLoadResourceStringInServerEnabled&&t&&"object"==typeof t}},function(t,e,n){"use strict";var r;function i(t){r=t}function o(){return r?r():$.Deferred().reject("GetAddinAccessTokenFailed").promise()}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(1),o=n(51),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.src,n=Object(r.e)(t,["src"]);return i.createElement("img",Object(r.a)({src:Object(o.a)(e)},n))},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(2),i=n(1),o=n(27),u=n(3),c=n(10),s=n(17),a=n(29);function f(t){return i.createElement(l,Object(r.a)({},t))}var l=function(t){function e(n){var r=t.call(this,n)||this;r.Ir=u.uniqueId(e.name),r.Sr=r.Ir+"_placeholder",r.Fr=i.createRef(),r.yr=r.yr.bind(r),r.Nr=r.Nr.bind(r);var o=r.Tr(),c=u.findIndex(o,(function(t){return t.Value===r.props.Value}));return r.kr=c<0?void 0:o[c].Key,r.state={Expanded:!1},r}Object(r.c)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,n){var r=e.GetSelectOptions(t),i=u.findIndex(r,(function(e){return e.Value===t.Value}));this.kr=i<0?void 0:r[i].Key},n.componentDidUpdate=function(){if(this.Pr(),this.state.Expanded){if(this.Cr(),this.props.NeedScroll){var t=this.Fr.current;if(t){var e=$(".office-form-content"),n=t.getBoundingClientRect().bottom,r=e.height()-n;if(r<70){var i=o.findDOMNode(this.refs.menu);e.scrollTop(e.scrollTop()+i.offsetHeight-r)}}}var u=this.refs[this.kr];if(u){var c=o.findDOMNode(u);c&&c.focus()}}},n.Cr=function(){var t=document.getElementById(this.Ir),e=window.getComputedStyle(t),n=t.offsetWidth,r=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||r.offsetWidth<n)&&(r.style.width=n+"px"),r.style.top=t.offsetHeight-parseInt(e.borderTopWidth)+"px",r.style.left="-"+e.borderLeftWidth},n.render=function(){var t=this,e=u.extend({},this.props.HTMLAttributes),n=Object(c.f)(e,{"aria-describedby":this.Sr,"aria-expanded":this.state.Expanded,"aria-label":e["aria-label"]||this.props.Label||this.props.Placeholder,className:"select-control",id:this.Ir,onBlur:this.yr,onClick:e.disabled?void 0:function(){return t.Lr()},onKeyDown:this.Nr,ref:this.Fr,role:"combobox",tabIndex:e.disabled?-1:0});return i.createElement("div",Object(r.a)({},n),this.Mr(),this.xr())},e.GetSelectOptions=function(t){var e=t.SelectOptions;if(e)return e;var n=t.SelectOptionGroups;return u.flatten(n.map((function(t){return t.SelectOptions})))},n.Tr=function(){return e.GetSelectOptions(this.props)},n.Dr=function(){return!!this.Rr()},n.Rr=function(){return this.props.SelectOptionGroups},n.Mr=function(){var t,e=this,n=this.Tr(),r=u.findIndex(n,(function(t){return void 0===e.kr?t.Value===e.props.Value:t.Key===e.kr}));r>=0&&(t=this.props.DisplayValue?this.props.Value:n[r].DisplayContent||n[r].DisplayName),t||(t=this.props.Placeholder||"");var o=this.kr?"select-placeholder-text":"select-placeholder-text default",c=this.state.Expanded?"off":"polite",s=this.props.PlaceholderIcon&&i.createElement("div",{className:"select-placeholder-icon"},i.createElement(a.a,{IconName:this.props.PlaceholderIcon}));return i.createElement("div",{className:"select-placeholder"},s,i.createElement("span",{"aria-live":c,id:this.Sr,className:o,role:"textbox","aria-label":this.Er(n[r])},t),this.Ar())},n.Er=function(t){return this.props.DisplayValue&&this.props.Value?this.props.Value.toString():t&&t.DisplayName?t.DisplayName:this.props.Placeholder||""},n.Ar=function(){var t={HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return i.createElement(a.a,Object(r.a)({},t))},n.xr=function(){var t=this;if(this.state.Expanded){var e={className:"select-option-menu-container",ref:"menu",onWheel:function(e){e.preventDefault();var n=e.deltaY,r=o.findDOMNode(t.refs.menu),i=r.scrollTop+n;if(n>=0){var u=r.scrollHeight-r.clientHeight;r.scrollTop=Math.min(i,u)}else r.scrollTop=Math.max(i,0)},role:"listbox"};return i.createElement("ul",Object(r.a)({},e),this._r())}},n._r=function(){var t=this;return this.Dr()?this.Rr().map((function(e,n){return t.Ur(e,n)})):this.$r(this.Tr())},n.Ur=function(t,e){var n=!(!t.SelectOptions.length||!t.DisplayName)&&i.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+e},t.DisplayName);return i.createElement(i.Fragment,{key:"group_"+e},n,this.$r(t.SelectOptions))},n.$r=function(t){var e=this;return t.map((function(t){return e.Br(t)}))},n.Br=function(t){var e=this,n=t.Key===this.kr,u={"aria-selected":n,"aria-disabled":t.Disabled,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:n?0:-1,key:t.Key,ref:t.Key&&t.Key.toString(),role:"option"};t.AriaLabel&&(u["aria-label"]=t.AriaLabel),t.Disabled?u.className=Object(c.a)(u.className,"disabled"):u.onClick=function(n){o.findDOMNode(e).focus(),e.kr&&e.kr===t.Key||e.props.onValueChange(t.Value),e.setState({Expanded:!1}),n.stopPropagation()};var s,f="select-option-state forms-icon-size14x14";this.props.PlaceholderIcon&&(f=Object(c.a)(f,"hasPlaceholderIcon")),this.props.AllowWrap||(s=i.createElement(a.a,{HTMLAttributes:{className:f},IconName:"CheckMark"})),n&&(u.className=Object(c.a)(u.className,"selected"));var l=t.DisplayContent;return l||(l=i.createElement("span",null,t.DisplayName)),i.createElement("li",Object(r.a)({},u),i.createElement("div",{className:"select-option-content"},s,l))},n.yr=function(t){var e=o.findDOMNode(this),n=Object(c.d)(t);e.contains(n)||this.setState({Expanded:!1})},n.Nr=function(t){var e=this;switch(t.stopPropagation(),t.keyCode){case 32:this.setState({Expanded:!0}),t.preventDefault();break;case 13:this.Lr(!0),t.preventDefault();break;case 9:this.state.Expanded&&(this.setState({Expanded:!1},(function(){e.Fr.current&&e.Fr.current.focus()})),t.preventDefault());break;case 27:this.state.Expanded&&this.setState({Expanded:!1},(function(){e.Fr.current&&e.Fr.current.focus()})),t.preventDefault();break;case 37:case 39:this.state.Expanded||(37===t.keyCode?this.Qr():this.qr()),t.preventDefault();break;case 38:case 40:t.altKey?this.setState({Expanded:!this.state.Expanded}):38===t.keyCode?this.Qr():this.qr(),t.preventDefault()}},n.Qr=function(){for(var t=this,e=this.Tr(),n=u.findIndex(e,(function(e){return e.Key===t.kr}));n>0;){var r=e[n-1];if(!r.Disabled){this.props.onValueChange(r.Value);break}n--}},n.qr=function(){for(var t=this,e=this.Tr(),n=u.findIndex(e,(function(e){return e.Key===t.kr}));n<e.length-1;){var r=e[n+1];if(!r.Disabled){this.props.onValueChange(r.Value);break}n++}},n.Lr=function(t){var e=this.Tr();this.state.Expanded?o.findDOMNode(this).focus():t&&void 0===this.kr&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},n.Pr=function(){if(this.state.Expanded){var t=$(o.findDOMNode(this.refs.menu)),e=t.find(".select-option.selected");Object(c.h)(e,t)}},n.focus=function(){o.findDOMNode(this).focus()},e}(s.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(1),o=n(24),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){return Object(o.e)()?i.createElement("div",{className:"image-alternative-text"},this.props.children):null},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(29);function o(t){var e=r.createRef(),n=r.createRef(),o=t.IsMobile,u=t.VideoUrl,c=o?"mobile-youtube":"pc-youtube";return c=t.InDesignMode?"design-question-title-youtube-placeholder "+c:"office-form-title-youtube-placeholder "+c,r.createElement("div",{className:c},r.createElement("div",{className:"question-title-youtube-title"},r.createElement("a",{className:"question-title-youtube-link",href:u,target:"_blank"},u)),r.createElement("div",{className:"question-title-youtube-tip"},r.createElement("span",{className:"question-title-youtube-tip-text"},t.LocalizedStrings.kngohab),!o&&r.createElement(i.a,{HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var t=$(e.current),r=$(n.current);t&&r&&r.css({left:t.offset().left+t.width()/2,top:t.offset().top+t.width()/2})},ref:e},IconName:"Info"}),r.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:n},t.LocalizedStrings.kolbhcm)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n(3);var r=n(61),i=n(115),o=n(8);function u(t,e){return!c(e)&&Object(r.d)(t)}function c(t){return!Object(o.c)("YouTubeAdminControl")||(Object(i.a)().Model.FormsTenantSettings.bingImageSearch||t&&t.isFieldReady(t.Schema.TenantSwitches)&&1===t.Model.TenantSwitches)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(11),i=n(21);function o(){return Object(r.q)()?Object(i.h)():Object(i.b)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(1),o=n(68),u=n(29),c=function(t){function e(e){return t.call(this,e)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=this.Vr(),e=this.props.displayText?this.props.displayText.toLocaleUpperCase():Object(u.b)({HTMLAttributes:{className:"author-notification-icon"},IconName:"Contact"}),n={backgroundColor:t.backgroundColor,color:t.textColor},o={"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:n,title:this.props.tooltip};return i.createElement("div",Object(r.a)({},o),i.createElement("span",{"aria-hidden":!0},e))},e.createColor=function(t){for(var n=0,r=t.length-1;r>=0;r--){var i=t.charCodeAt(r),o=r%8;n^=(i<<o)+(i>>8-o)}var u=n%e.COLOR_SWATCHES_LOOKUP.length;return e.COLOR_SWATCHES_LOOKUP[u]},n.Vr=function(){var t=this.props,n="",r="";t.backgroundColor&&(n=Object(o.a)(t.backgroundColor)),t.textColor&&(r=Object(o.a)(t.textColor));var i=t.email||t.name;return""!==r&&""!==n||!i||(n=n||e.createColor(i),r=r||Object(o.a)(Object(o.b)(Object(o.c)(n)))),{backgroundColor:n=n||e.defaultBackgroundColor,textColor:r=r||e.defaultTextColor}},e.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],e.defaultBackgroundColor=e.COLOR_SWATCHES_LOOKUP[0],e.defaultTextColor="#FFFFFF",e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(9),i=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{-퟿-￿]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),u=new RegExp("\\s+","gi"),c=new RegExp("[ء-ي٠-٩]"),s=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),a=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function f(t,e){var n=t.replace(/\s/,"");return e?n[n.length-1]:n[0]}function l(t,e){var n=t.replace(/\s/,"");return n.length<=2?e?n[0]:n[n.length-1]:e?n.substr(0,2):n.substr(n.length-2,n.length)}function h(t,e){var n="",r=t.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),e&&n.length>1?n.charAt(1)+n.charAt(0):n}function d(t){return t=(t=(t=(t=t.replace(i,"")).replace(o,"")).replace(u," ")).trim()}function m(t,e){return null==t?"":(arguments.length<2&&(e=Object(r.p)()),t=d(t),c.test(t)?f(t,!!e):s.test(t)||a.test(t)?l(t,!!e):h(t,!!e))}function b(t,e,n){return m(t?t.trim():((e||"")+" "+(n||"")).trim())}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r,i=n(8),o=n(76),u=n(18);function c(){return r||(r=Object(i.a)()?new Promise((function(t,e){Object(o.a)("aria-odata").then(t,(function(t){u.a.Resolve("IErrorHandler").handleJavaScriptLoadError(t)}))})):Promise.resolve()),r}},function(t,e,n){"use strict";n.d(e,"a",(function(){return J}));var r=n(1),i=n(2),o=n(32),u=n(31);function c(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(6).then(n.bind(null,172))];case 1:return[2,{default:t.sent().DateTimeRenderer}]}}))}))}function s(t){var e=Object(u.a)(s,c);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}function a(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(7).then(n.bind(null,167))];case 1:return[2,{default:t.sent().FileUploadRenderer}]}}))}))}function f(t){var e=Object(u.a)(f,a);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}function l(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(8).then(n.bind(null,170))];case 1:return[2,{default:t.sent().LikertRenderer}]}}))}))}function h(t){var e=Object(u.a)(h,l);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}function d(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(9).then(n.bind(null,171))];case 1:return[2,{default:t.sent().NPSRenderer}]}}))}))}function m(t){var e=Object(u.a)(m,d);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}function b(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(10).then(n.bind(null,165))];case 1:return[2,{default:t.sent().RankingRenderer}]}}))}))}function v(t){var e=Object(u.a)(v,b);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}function g(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(11).then(n.bind(null,166))];case 1:return[2,{default:t.sent().RatingRenderer}]}}))}))}function p(t){var e=Object(u.a)(p,g);return r.createElement(o.a,null,r.createElement(e,Object(i.a)({},t)))}var O=n(3),j=n(4),w=n(90),I=n(8),S=n(28),F=n(30),y=n(10),N=n(78),T=n(88),k=n(20),P=n(75),C=n(73),L=n(7),M=n(58),x=n(111),D=n(79),R=n(100),E=n(29),A=function(t){function e(e){var n=t.call(this,e)||this;return n.zr=n.zr.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t=this.props.Choice,e=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(e=Object(y.a)(e,"active"));var n=Object(y.a)("office-form-question-choice-row",this.props.ClassNameForLabel),o=Object(L.c)((function(){return t.Description}),L.e);return r.createElement("div",{className:e},r.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},r.createElement("label",{className:n},r.createElement("input",Object(i.a)({"aria-checked":this.props.IsChecked,"aria-label":o,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.zr,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.Gr())),this.Hr())},n.Gr=function(){var t,e;switch(this.props.AnswerType){case"Correct":e="CheckMark",t=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":t=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",e=this.props.IsMobile?"Cancel":""}if(e)return Object(E.b)({HTMLAttributes:{className:Object(y.a)(t,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer},IconName:e})},n.Hr=function(){if(this.props.AnswerHint){var t=void 0;return t="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",t=Object(y.a)("office-form-answerhint",t),r.createElement("div",{className:t},this.props.AnswerHint)}},n.zr=function(){this.props.onChange(this.props.Choice.Description)},e}(n(17).a),_=n(103),U="6c660282-db72-436c-87bb-8272cba504d3",$=function(t){function e(e){var n=t.call(this,e)||this;n.Wr=r.createRef(),n.Jr=Object(F.b)();var i=n.Kr(),o=n.Xr(),u=n.Yr();return n.state={ChoiceOptions:o,IsOtherOptionSelected:!!i.OtherAnswer,LocalizedOptions:n.questionLocalizedItemMaster&&n.questionLocalizedItemMaster.Model.option,OptionsOrder:u,OrderedChoices:O.map(u,(function(t){return o[t]})),OtherOptionText:i.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:i.SelectedOptions},n.ke=n.ke.bind(n),n.Zr=n.Zr.bind(n),n.ti=n.ti.bind(n),n.ei=n.ei.bind(n),n.ni=n.ni.bind(n),n.ri=n.ri.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.ti),this.props.ShowQuizResult&&this.props.Master.observe(this.ni,[C.a.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.ei,[P.a.Schema.choicesV1])},n.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.ei),this.props.Master.Question.unobserve(this.ti),this.props.ShowQuizResult&&this.props.Master.unobserve(this.ni,[C.a.Schema.Answer]),t.prototype.componentWillUnmount.call(this)},n.componentWillReceiveProps=function(e){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.ei),t.prototype.componentWillReceiveProps.call(this,e),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.ei,[P.a.Schema.choicesV1])},n.shouldComponentUpdate=function(t,e){var n=!O.isEqual(t,this.props),r=!O.isEqual(e,this.state);return n||r},n.createReactNodes=function(){var t=this.props.Master.Question,e=t.Model,n=e.ChoiceType===k.a.SingleChoice;return this.props.ExpandAll||!t.showAsDropdown()||!Object(I.c)("DropDownInMobile")&&this.props.IsMobile||e.IsQuiz&&this.props.ShowQuizResult?[this.ii(n),this.oi()]:[this.ui()]},n.getFormattedDataForImmersiveReader=function(){var e=t.prototype.getFormattedDataForImmersiveReader.call(this),n=null,r=document.createElement("ul");return O.forEach(this.state.OrderedChoices,(function(t){var e=document.createElement("li"),i=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){n=n||MathJax.Hub.getAllJax(null);var o=O.find(n,(function(e){return e.originalText===t.Description}));if(o){var u=o.root&&o.root.toMathML&&o.root.toMathML();u&&(u=u.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;"+Object(y.b)(u,!0)+"&#60;![endif]--\x3e")}}e.innerHTML=i||Object(y.b)(t.Description,!0),r.appendChild(e)})),r.appendChild(document.createElement("br")),e.splice(e.length-1,0,{content:r.outerHTML,mimeType:"text/html"}),e},n.ni=function(){var t=this.Kr();this.setState({IsOtherOptionSelected:!!t.OtherAnswer,OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.ci=function(t){},n.si=function(){var t,e=this,n=[],r=this.props.Master.Question.Model.ChoiceType===k.a.SingleChoice,i=this.state.SelectedOptions;i&&i.forEach((function(t){return n.push(t)}));var o=this.state.OtherOptionText;if(Object(L.c)((function(){e.state.IsOtherOptionSelected&&o&&-1===n.indexOf(o)&&n.push(o)}),L.e),r)t=n[0];else if(n.length){var u=this.ai(n);t=JSON.stringify(u)}this.props.Master.Model.Answer=t},n.ii=function(t){var n=this,o=this.props.Master.Question.Model,u=this.state.OrderedChoices.length+(o.AllowOtherAnswer?1:0),c=this.props.Master.Question.Form,s=Object(w.a)(c,"ResponsePage.PollView"),a=Object(y.a)(this.props.IsMobile&&!s?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),f=this.state.OrderedChoices.map((function(i,o){var c,s=-1!==n.state.SelectedOptions.indexOf(i.Description),f=n.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(n.props.Master.Question.Model.IsMathQuiz&&i.IsMathOption){var l=Object(N.c)({DisableLinebreaks:n.props.DisableFormulaLinebreak,Formula:i.Description,onRenderComplete:n.props.onHeightChange});c=r.createElement("div",{className:"office-form-question-choice-formula"},l)}else{f=Object(y.a)(f,"office-form-question-choice-text-row");var h,d=n.questionLocalizedItemMaster;if(d){var m=d.getChoiceV1LocalizedMaster(n.state.OptionsOrder[o]);h=m&&m.Model.description}var b={RenderMode:"RichText",Text:h||i.Description};c=r.createElement("span",{className:"office-form-question-choice-text-span"},Object(R.a)(b))}var v,g=e.getAnswerKeyMark(n.props,i,s);switch(g){case"Correct":v=n.props.LocalizedStrings.hbfefki;break;case"Wrong":v=n.props.LocalizedStrings.fhofbje}var p={name:n.Jr};return t&&O.extend(p,{"aria-posinset":o+1,"aria-setsize":u}),r.createElement(A,{AnswerHint:e.getAnswerHintLabel(n.props,i,s),AnswerType:g,ToolTipForAnswer:v,Choice:i,ClassNameForLabel:f,ContainerClassName:a,Disabled:n.props.Disabled,HTMLPropsForInput:p,IsChecked:s,IsMobile:n.props.IsMobile,IsSingleChoice:t,key:o,LocalizedStrings:n.props.LocalizedStrings,onChange:n.ke},c)})),l=this.getElementProps({key:"choicequestion-choices",role:t?"radiogroup":"group"});return r.createElement("div",Object(i.a)({},l),f,this.li(t))},n.di=function(){this.props.Master.Model.Answer||this.props.Master.Model.Visible||this.ti()},n.li=function(t){var e=this.props.Master.Question.Form,n=Object(w.a)(e,"ResponsePage.PollView");if(this.props.Master.Question.Model.AllowOtherAnswer){var o={className:this.props.IsMobile&&!n?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return Object(I.c)("CheckBoxAlignmentIssueControl")?r.createElement("div",Object(i.a)({},o),r.createElement("div",{className:"radio"},r.createElement("label",null,this.mi(t),this.bi()))):r.createElement("div",Object(i.a)({},o),this.mi(t),this.bi())}},n.mi=function(t){var e=this.state.ChoiceOptions,n={"aria-label":this.props.LocalizedStrings.pekgkfg,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:t?this.Jr:void 0,onChange:this.Zr,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return t&&(n.role="radio",n.type="radio",n["aria-posinset"]=e.length+1,n["aria-setsize"]=e.length+1),r.createElement("input",Object(i.a)({},n))},n.Zr=function(){var t,e=this,n=this.state.IsOtherOptionSelected,r=O.clone(this.state.SelectedOptions);if(!n){this.props.Master.Question.Model.ChoiceType===k.a.SingleChoice&&(r=[]);var i=this.Wr.current;i&&i.focus()}t=Object(I.c)("CheckBoxAlignmentIssueControl")?!n:!n&&!!this.state.OtherOptionText,this.setState({IsOtherOptionSelected:t,SelectedOptions:r},(function(){return e.si()}))},n.bi=function(){var t={"aria-label":this.props.LocalizedStrings.chpgibd,className:"office-form-other-answer-textbox"},e={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:Object(S.j)(),onValueChange:this.ri,Options:{HTMLPropsForInnerElement:t},Placeholder:this.props.LocalizedStrings.chpgibd,ref:this.Wr,Value:this.state.OtherOptionText||""};return Object(D.a)(e)},n.ri=function(t){var e=this,n=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===k.a.SingleChoice&&(n=[]),this.setState({IsOtherOptionSelected:!!t,OtherOptionText:t,SelectedOptions:n},(function(){return e.si()}))},n.ti=function(){var t=this.Kr();this.setState({ChoiceOptions:this.Xr(),OptionsOrder:this.Yr(),OrderedChoices:this.gi(),OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.ei=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},n.ke=function(t){var e=this,n=O.clone(this.state.SelectedOptions),r=this.props.Master.Question.Model.ChoiceType===k.a.SingleChoice,i=this.state.IsOtherOptionSelected,o=!1;if(r){if(t===n[0])return;i=!1,n=[t]}else{var u=n.indexOf(t);-1===u?n.push(t):n.splice(u,1),o=JSON.stringify(n).length>T.a.MaxAnswerLength}this.setState({IsOtherOptionSelected:i,ReachMaxLengthLimit:o,SelectedOptions:n},(function(){return e.si()}))},n.oi=function(){if(this.state.ReachMaxLengthLimit)return Object(M.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.lnbimpn})},n.ui=function(){var t,e,n=this,i=this.props.Master,o=i.Question.Model,u=this.state.OrderedChoices.map((function(t,e){var r,i=n.questionLocalizedItemMaster;if(i){var o=i.getChoiceV1LocalizedMaster(n.state.OptionsOrder[e]);r=o&&o.Model.description}return{DisplayName:r||t.Description,Key:j.a.getObjectMasterFromModel(t).getInstanceId(),Value:t.Description}})),c=i.Model.Answer;o.AllowOtherAnswer&&u.push(this.pi()),this.state.IsOtherOptionSelected&&(c=U),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(t=this.Oi()),e=function(t){return n.ji(t)};var s=Object(x.a)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:o.Hint||this.props.LocalizedStrings.iiebfei}),key:"choicequestion-dropdown",onValueChange:e,Placeholder:o.Hint||this.props.LocalizedStrings.iiebfei,SelectOptions:u,Value:c,NeedScroll:Object(I.c)("DropDownInMobile")&&this.props.IsMobile});return r.createElement("div",{className:this.getValidationStyle()},s,t)},n.ji=function(t){var e=this,n=t===U,r=n?[]:[t];Object(L.c)((function(){e.setState({IsOtherOptionSelected:n,SelectedOptions:r},(function(){return e.si()}))}),L.e)},n.pi=function(){return{DisplayName:this.props.LocalizedStrings.chpgibd,Key:U,Value:U}},n.Oi=function(){var t=this,e={"aria-label":this.props.LocalizedStrings.ajmpnbh,className:"office-form-other-answer-textbox"},n={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(e){t.setState({OtherOptionText:e,SelectedOptions:[]},(function(){return t.si()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:this.props.LocalizedStrings.ajmpnbh,ref:this.Wr,Value:this.state.OtherOptionText};return Object(D.a)(n)},n.ai=function(t){var e=this.props.Master.Question.Model.Choices,n=O.map(e,(function(t){return t.Description}));return t.sort((function(t,e){return n.indexOf(t)-n.indexOf(e)}))},e.isQuizResultAnswerKey=function(t,e){if(!t||!t.IsAnswerKeys)return!1;var n=t.Choices;return!!n&&t.IsAnswerKeys[n.indexOf(e.Description)]},e.getAnswerKeyMark=function(t,n,r){var i=t.Master,o=i.Model.QuizResult,u=i.Question,c=e.isQuizResultAnswerKey(o,n);return n.IsAnswerKey&&t.ShowDesignInfo&&u.Model.IsQuiz||c?"Correct":r&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(t){return t}))&&!c?"Wrong":"Normal"},e.getAnswerHintLabel=function(t,e,n){var r=t.Master.Model.QuizResult;if(!t.ShowDesignInfo&&n&&r){var i=r.Choices,o=i?i.indexOf(e.Description):-1;return r.AnswerHints&&r.AnswerHints[o]}},n.Xr=function(){var t=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(t.Choices.length-1),j.a.convertToArray(t.Choices)},n.gi=function(){var t=this;return O.map(this.state.OptionsOrder,(function(e){return t.state.ChoiceOptions[e]}))},n.Yr=function(){for(var t=this.props.Master.Question.Model,e=[],n=0;n<t.Choices.length;n++)e[n]=n;return this.props.ShowQuizResult||!t.ShuffleOptions||this.props.DisableShuffle?e:O.shuffle(e)},n.Kr=function(){var t,e=this.props.Master,n=e.Model,r=e.Question.Model,i=r.ChoiceType===k.a.SingleChoice,o=[],u=Object(T.b)(n.Answer,r).SelectedOptions;u.length>0&&(i?[n.Answer]:u).forEach((function(e){-1!==O.findIndex(r.Choices,(function(t){return t.Description===e}))?o.push(e):r.AllowOtherAnswer&&(t=e)}));return{OtherAnswer:t,SelectedOptions:o}},e}(_.a),B=n(67),Q=n(9),q=n(83),V=n(16),z=n(104),G=k.e,H=!1,W=function(t){function e(e){var n=t.call(this,e)||this;return n.wi="presentation",n.Ii=n.Ii.bind(n),n.Si=n.Si.bind(n),n.Fi=n.Fi.bind(n),n.yi=n.yi.bind(n),n.Ni(),n}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t,e,n=this,i=this.props.Master.Model,o=this.props.Master.Question,u=o.Model,c=this.oi();if(this.props.PrintView)t=r.createElement("div",{className:"textbox-printview",key:"printView"},i.Answer);else{var s=void 0,a=void 0;if(u.IsMathQuiz&&!u.Multiline){var f=this.Ti(!0),l=u.InputSwitcherDisabled||!u.IsMathInputDefault,h=this.props.Disabled||l?void 0:this.ki(),d=void 0,m=void 0;if(i.AnswerEntity)d=i.AnswerEntity.IsMathAnswer,m=i.AnswerEntity.Answer;else d=!u.IsAnswerPlainText,m=Object(Q.w)(i.Answer||"{}").Answer||"";if(d){var b=u.InputSwitcherDisabled?this.props.LocalizedStrings.eiodbcm:this.props.LocalizedStrings.ajmpnbh,v={onBlur:this.Fi},g=r.createElement(N.a,{Disabled:this.props.Disabled,HTMLAttributes:v,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.Ii,Placeholder:b,QuestionId:u.Id,Value:m},h);a=r.createElement("div",{className:"office-form-response-question-math-container"},g,f)}else{var p=Object(D.a)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.Fi},key:"textmathquestion-textfield",Label:void 0,MaxLength:Object(S.a)(),MinimalHeight:40,onValueChange:this.Ii,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:this.props.LocalizedStrings.ajmpnbh||"",Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:m});a=r.createElement("div",{className:"office-form-response-question-math-textfield"},p,h,f)}e=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},a)}else{b=Object(L.c)((function(){return u.IsNumber?o.getNumberValidationErrorMessage(n.props.LocalizedStrings):u.Placeholder||n.props.LocalizedStrings.ajmpnbh}),L.e);s=Object(D.a)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.Fi,onFocus:this.yi},key:"textquestion-textfield",Label:void 0,MaxLength:Object(S.a)(),onValueChange:function(t){return i.Answer=t},Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:b,TextFieldType:u.Multiline?2:0,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:i.Answer});f=this.Ti();e=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},s,f)}}return[t,e,this.Pi(),c]},n.ki=function(){var t,e,n=this.props.Master.Question.Model,r="design-question-choice-to-math-button";return this.props.IsMobile&&(r=Object(y.a)(r,"isMobile")),n.IsAnswerPlainText?(t={"aria-label":this.props.LocalizedStrings.dhjmdak,className:r,onClick:this.Si(),title:this.props.LocalizedStrings.edeheno},e="NumberField"):(t={"aria-label":this.props.LocalizedStrings.lhbijek,className:r,onClick:this.Si(),title:this.props.LocalizedStrings.ikpfpbb},e="TextField"),Object(z.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,Icon:e,IconClassName:"design-question-choice-to-math-button-icon"})},n.Si=function(){var t=this;return function(e){var n=t.props.Master.Question.Model,r=t.props.Master.Model,i=Object(Q.w)(r.Answer||"{}");n.IsAnswerPlainText=!n.IsAnswerPlainText;var o={Answer:i.Answer,IsMath:!n.IsAnswerPlainText};r.Answer=JSON.stringify(o),Object(V.a)({eventName:n.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",eventType:"engagement_event",extraData:{location:"TextField.Response",questionId:n.Id}}),t.forceUpdate()}},n.Ni=function(){var t=this.props.Master.Question.Model,e=this.props.Master;if(t.IsMathQuiz){if(e.Model.Answer){var n=Object(Q.w)(e.Model.Answer||"{}");if(void 0!==n.IsMath)return void(t.IsAnswerPlainText=!n.IsMath)}t.IsAnswerPlainText=!t.IsMathInputDefault}else t.IsAnswerPlainText=!0},n.Ii=function(t){var e=this.props.Master.Model,n={Answer:t,IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};e.Answer=JSON.stringify(n)},n.Fi=function(){var t=this.props.Master.Model,e=this.props.Master.Question;if(e.Model.IsNumber){var n=t.Answer;e.verify(n)!==G.Success||e.Model.IsMathQuiz||Object(L.c)((function(){return t.Answer=Object(B.a)(n)}),L.e)}},n.yi=function(){this.props.Master.Model.ShowPhishingFormWarning=!0,H||(H=!0,Object(V.a)({eventName:"ResponsePage.Phshing.Warning",eventType:"engagement_event"}))},n.oi=function(){var t=this.props.Master.Model,e=this.props.Master.Question,n=e.verify(t.Answer);if(t.Answer&&n!==G.Success){var r;switch(n){case G.NumberValidationError:case G.RegExValidationError:r=e.getNumberValidationErrorMessage();break;case G.MathLengthError:r=this.props.LocalizedStrings.capdcaj;break;default:return}return Object(M.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:r})}},n.Ti=function(t){var n=this.props.Master,o=this.props.Master.Question,u=o.Model;if(this.props.ShowQuizResult&&!u.Multiline&&u.IsQuiz){var c=e.isAnswerCorrect(n);if(null!==c&&(c||this.props.IsMobile)){var s=t?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(s=Object(y.a)(s,"isMobile"));var a,f=c?this.props.LocalizedStrings.hbfefki:this.props.LocalizedStrings.fhofbje,l={HTMLAttributes:{className:Object(y.a)("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",c?"image-button-answerkey":"image-button-checked-wrong-answer"),title:f},IconName:c?"CheckMark":"Cancel"},h=n.Model.Answer;if(a=h,!h||Object(F.a)(h))a=u.Placeholder||this.props.LocalizedStrings.ajmpnbh;else if(o.Model.IsMathQuiz){var d=Object(Q.w)(h||"{}");a=d.IsMath?Object(N.c)({Formula:null==d.Answer?h:d.Answer}):null==d.Answer?h:d.Answer}var m={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.wi};return r.createElement("div",{className:s},r.createElement("span",Object(i.a)({},m),a),Object(E.b)(l))}}},e.isAnswerCorrect=function(t){var e=t.Model;return null!=e.QuizResult?e.QuizResult.IsAnswerCorrect:new q.a(t.Question.Model).areAnyAnswersDefined()?t.Question.isCorrectAnswer(e.Answer):null},n.Pi=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;if(this.Ci()){var n=null!=e?e:t,i=new q.a(n);if(i.areAnyAnswersDefined()){var o,u=i.getAnswers();if(u.some((function(t){return t.isMath}))){for(var c=[],s=0,a=u;s<a.length;s++){var f=a[s];if(f.isMath){var l=Object(N.c)({Formula:f.answer});c.push(r.createElement("div",{className:"correct-answer-list-formula-element"},l))}else c.push(f.answer);c.push(this.props.LocalizedStrings.namllgi)}c.pop(),o=r.createElement("div",{className:"correct-answer-list-formula-container"},c)}else o=O.map(u,(function(t){return t.answer})).join(this.props.LocalizedStrings.namllgi);var h={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.wi},IconName:""};return r.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},Object(E.b)(h),r.createElement("b",null,this.props.LocalizedStrings.djonanp," "),o)}}},n.Ci=function(){var t=this.props.Master.Model,e=this.props.Master.Question.Model,n=this.props.Master.Model.QuizResult;return!(e.Multiline||!e.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==n)&&((null==n||!n.IsAnswerCorrect)&&!(null==n&&this.props.Master.Question.isCorrectAnswer(t.Answer))))},e}(_.a);function J(t){var e,n=t.Master.Question.Model.Type;switch(n){case"Question.Choice":e=$;break;case"Question.TextField":e=W;break;case"Question.Rating":return p(t);case"Question.Ranking":return v(t);case"Question.NPS":return m(t);case"Question.MatrixChoiceGroup":return h(t);case"Question.FileUpload":return f(t);case"Question.DateTime":return s(t)}if(e)return r.createElement(e,t);throw Error('Type "'+n+'" has not been found.')}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(2),i=n(1),o=n(8),u=n(28),c=n(21),s=n(33),a=n(16),f=n(10),l=n(17),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t,e=this.props.Ignorable?Object(f.a)(this.props.ClassName,"optional-cell"):this.props.ClassName;return t=Object(o.c)("FromsSpinnerControl")?"common-spinner-circle":"loading-spinner-animation",i.createElement("div",{className:e},i.createElement("div",{className:t}),this.Li())},n.Li=function(){if(this.props.LoadingDescription)return i.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},e}(l.a),d=n(112),m=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ImageLoadStatus:0,RetryCount:0},n.Mi=n.Mi.bind(n),n.xi=n.xi.bind(n),n.Di=n.Di.bind(n),n}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(c.f)().Schema;this.props.ImageInfoMaster.observe(this.Di,[t.AltText,t.ResourceId,t.ResourceUrl])},n.componentWillUnmount=function(){this.Ri&&window.clearTimeout(this.Ri),this.props.ImageInfoMaster.unobserve(this.Di)},n.render=function(){var t,n;this.props.FullFilled?(t="100%",n="auto"):(t=this.props.ImageWidth||Object(u.h)(),n=this.props.ImageHeight||Object(u.g)());var r,o,c=this.state.RetryCount,s=this.props.ImageInfoMaster.Model,a=s.ResourceUrl;2===this.state.ImageLoadStatus&&c>0&&(a+="?"+c),this.Ei()?o=e.createSpinner():1===this.state.ImageLoadStatus&&(r="visiable");var f=s.AltText||"";return i.createElement("div",{className:"office-form-title-image-box"},i.createElement("img",{alt:f,className:r,height:n,onError:this.xi,onLoad:this.Mi,src:a,title:f,width:t}),o,i.createElement(d.a,null,this.props.ImageInfoMaster.Model.AltText))},n.Ei=function(){var t=this.props.ImageInfoMaster.Model,e=this.props.ImageSettingMaster.Model,n=this.state.ImageLoadStatus;return Object(o.c)("RemoveImageTargetResourceId")?1!==n||t.ImageProcessingStatus!==s.b.Idle:1!==n||t.ResourceId!==e.TargetResourceId||t.ImageProcessingStatus!==s.b.Idle},e.createSpinner=function(){var t;if(Object(o.c)("FromsSpinnerControl")){t=i.createElement(h,Object(r.a)({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}))}else t=i.createElement("div",{className:"spinner-tile-animation"});return i.createElement("div",{className:"image-spinner"},t)},n.Mi=function(){Object(a.a)({eventName:"Image.ImageOnLoad.Success",eventType:"engagement_event",extraData:{imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:1})},n.xi=function(){var t=this,e=this.state.RetryCount;e<3?this.Ri=window.setTimeout((function(){return t.setState({RetryCount:++e})}),1e3):(Object(a.a)({eventName:"Image.ImageOnLoad.Failure",eventType:"engagement_event",extraData:{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:2}))},n.Di=function(){this.forceUpdate()},e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(2),i=n(1),o=n(3),u=n(11),c=n(8),s=n(71),a=n(10),f=n(9),l=n(34),h=n(32),d=n(31);function m(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(1).then(n.bind(null,168))];case 1:return[2,{default:t.sent().TitleOverflowMenu}]}}))}))}function b(t){var e=Object(d.a)(b,m);return i.createElement(h.a,null,i.createElement(e,Object(r.a)({},t)))}var v=n(7),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ai=i.createRef(),e.Yn=400,e.Zn=function(){var t=[];t.push({content:e.props.Title}),t.push({content:"\n"}),t.push({content:e.props.SubTitle});var n={chunks:t,title:""},r={uiLang:Object(u.f)()||navigator.language};Object(l.b)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,n,r)}))},e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){Object(s.a)($(this.Ai.current))},n.componentDidUpdate=function(){Object(s.a)($(this.Ai.current))},n.render=function(){var t=o.extend({},this.props.HTMLAttributes);return t.className=Object(a.a)(t.className,"office-form-title-container"),i.createElement("div",Object(r.a)({},t),this.cr(),this._i(),"Bottom"===this.props.MediaLayout?this.props.children:void 0,this.Ui())},n.cr=function(t){var e,n="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(n=n+" "+this.props.MediaLayout.toLowerCase(),e=this.props.children),i.createElement("div",{className:n},e,this.$i())},n.$i=function(){var t=this,e=o.extend({},this.props.HTMLPropsForInnerElement);return e.className=Object(a.a)("office-form-title",e.className,"heading-"+(this.props.Heading||1),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title"),Object(v.c)((function(){return i.createElement("div",Object(r.a)({},e),i.createElement("span",null,t.props.Title),t.vr(),e.children)}),v.e)},n.Ui=function(){return Object(c.c)("ImmersiveReaderMobileToggle")?this.props.Heading>1?null:b({ImmersiveReaderToggleProps:Object(r.a)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile}):null},n.vr=function(){var t;return!Object(f.h)()&&Object(c.c)("ImmersiveReaderInForms")&&(null===(t=this.props.ImmersiveReaderToggleProps)||void 0===t?void 0:t.ShouldShowImmersiveReaderButtons)?i.createElement("button",{className:"immersive-reader-button","data-locale":Object(u.f)()||navigator.language,onClick:o.debounce(this.Zn,this.Yn,!0)}):null},n._i=function(){var t=this;return this.props.SubTitle?Object(v.c)((function(){return i.createElement("div",{className:"office-form-subtitle heading-"+(t.props.Heading||1),ref:t.Ai},i.createElement("span",null,t.props.SubTitle))}),v.e):void 0},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(1),o=n(3),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Bi=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.LazyRendering&&(this.Bi.current&&console.log(this.Bi.current),window.setTimeout((function(){return t.setState({Mounted:!0})})))},n.render=function(){var t=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":t.role="alert";break;case"Log":t.role="log",t["aria-live"]=t["aria-live"]||"polite",t["aria-relevant"]=t["aria-relevant"]||"additions text";break;case"Marquee":t.role="marquee";break;case"Status":t.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(t["aria-label"]=void 0,t.children=null,t.ref=this.Bi,i.createElement("div",Object(r.a)({},t))):i.createElement("div",Object(r.a)({},t),this.props.children)},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return O}));var r=n(2),i=n(4),o=n(0),u=n(30),c=n(80),s=n(46),a=n(64),f=n(63),l=n(50),h=n(19),d=n(48),m=n(23),b=n(15),v=function(){function t(t,e){this.Qi=t,this.I=Object(m.b)(this.Qi.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.Qi.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.Qi.QuestionId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ChoiceId",{get:function(){return this.Qi.Model.Id},enumerable:!1,configurable:!0}),e.add=function(t){if(this.Qi.Form.SyncContext===b.a.DesignTimeForm)return this.I.createQuestionChoice(this.FormId,this.QuestionId,t);Object(h.b)("Trying to create a choice out of design time.")},e.delete=function(t){if(this.Qi.Form.SyncContext===b.a.DesignTimeForm)return this.I.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);Object(h.b)("Trying to delete a choice out of design time.")},e.query=function(t){return this.I.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},e.update=function(t,e){if(this.Qi.Form.SyncContext===b.a.DesignTimeForm){if(t)return this.I.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,t);try{throw Error("patch choice body null error")}catch(t){d.a.logData({errorName:"DataSourceUpdatingChoiceNull",errorInfo:{stack:t.stack}})}return $.Deferred().resolve().promise()}Object(h.b)("Trying to update a choice out of design time.")},t}(),g={Id:o.a.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:o.a.string({SourceFieldName:"description"}),CustomProperties:o.a.string({SourceFieldName:"customProperties"}),Description:o.a.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:o.a.string({SourceFieldName:"formsProDisplayRTText"}),Order:o.a.number({SourceFieldName:"order"}),Key:o.a.string({SourceFieldName:"key"}),IsGenerated:o.a.boolean({IsLocalField:!0}),IsMathOption:o.a.boolean({IsLocalField:!0}),BranchInfo:o.a.fromMasterClass((function(){return c.a}),{IsLocalField:!0}),SavingState:o.a.reference({IsLocalField:!0})};function p(t){return i.a.getObjectMasterFromModel(t)}var O=function(t){function e(n){var r=this,i=$.Deferred();return r=t.call(this,n,{Scheduler:new s.a(e.name),MasterReady:i.promise()})||this,Object(l.b)(r),r.fieldsReady([r.Schema.Id,r.Schema.Key]).done((function(){r.Model.Key||(r.Model.Key=Object(u.b)())})),r.qi(n),i.resolve(),r}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.Question.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n.qi=function(t){this.Vi=new a.a(this,e.Schema.CustomProperties,e.CustomPropertiesFieldSet),t.InitialData&&this.isFieldReady(e.Schema.CustomProperties)&&(t.ExistingInDataSource||t.InitialData.CustomProperties?this.Vi.deserialize():this.Vi.serialize())},Object.defineProperty(e,"CustomPropertiesFieldSet",{get:function(){return e.customPropertiesFieldSet||(e.customPropertiesFieldSet=new f.a([e.Schema.BranchInfo,e.Schema.IsGenerated,e.Schema.IsMathOption])),e.customPropertiesFieldSet},enumerable:!1,configurable:!0}),e}(i.a.createObjectMasterClass("ChoiceV2Master",g,(function(t,e){return new v(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(2),i=n(4),o=n(0),u=n(8),c=n(5),s=n(15),a=n(12),f=n(56),l={BackgroundColor:o.a.string({IsLocalField:!0}),BackgroundImage:o.a.string({IsLocalField:!0}),Name:o.a.string(),PrimaryColor:o.a.string({IsLocalField:!0}),SecondaryColor:o.a.string({IsLocalField:!0}),Thumbnail:o.a.string({IsLocalField:!0})},h=function(t){function e(e){var n=t.call(this,e)||this;if(e.MasterTreeReady){var r=a.a.Schema;e.MasterTreeReady.then((function(){return n.Form.fieldsReady([r.Theme])})).then((function(){return n.Form.ensureFieldsReady([r.PrimaryCustomizedThemeColor,r.SecondaryCustomizedThemeColor,r.TertiaryCustomizedThemeColor,r.Background])})).done((function(){return n.zi()}))}return n}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),n.isCustomized=function(){return this.Model.Name===f.a},n.getCustomizedTheme=function(){var t=this.Form.Model;return{BackgroundColor:t.TertiaryCustomizedThemeColor||f.b.BackgroundColor,BackgroundImage:t.Background.ResourceUrl,Name:f.a,PrimaryColor:t.PrimaryCustomizedThemeColor||f.b.PrimaryColor,SecondaryColor:t.SecondaryCustomizedThemeColor||f.b.SecondaryColor,Thumbnail:null}},n.zi=function(){var t=this;this.addRule({Name:"calculate theme basing on name",onChange:function(e){e.BeingDeleted||t.Gi()}});var e=a.a.Schema;this.Form.observe((function(){return t.Gi()}),[e.PrimaryCustomizedThemeColor,e.SecondaryCustomizedThemeColor,e.TertiaryCustomizedThemeColor,e.Background.ResourceUrl]),this.Gi()},n.Gi=function(){var t=this,e=this.Model.Name;switch(e){case f.a:this.setData(this.getCustomizedTheme());break;case f.c:this.setData(f.b);break;default:if(Object(u.c)("LoadThemeInServer")){var n=Object(c.a)().themeConfig;if(n&&"object"==typeof n&&n[e]&&"object"==typeof n[e])return void this.setData(n[e])}this.Hi(e).then((function(e){return t.setData(e)}))}},n.Hi=function(t){return this.Form.SyncContext!==s.a.ResponseTimeForm?Object(f.d)(t):Object(f.e)(t)},e}(i.a.createObjectMasterClass("FormTheme",l))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),i=function(){function t(){}return t.tagNames=["strong","em","u","sup","sub","a"],t.openingTags=r.map(t.tagNames,(function(t){return"<"+t+">"})),t.closingTags=r.map(t.tagNames,(function(t){return"</"+t+">"})),t.encodedOpeningTags=r.map(t.tagNames,(function(t){return"&lt;"+t+"&gt;"})),t.encodedClosingTags=r.map(t.tagNames,(function(t){return"&lt;/"+t+"&gt;"})),t}();function o(t){return function(t){var e=document.createElement("span");return e.innerHTML=t,t=e.innerHTML}(function(t){var e=r.escape(t);return i.tagNames.forEach((function(t,n){e=e.replaceAll(i.encodedOpeningTags[n],i.openingTags[n]).replaceAll(i.encodedClosingTags[n],i.closingTags[n])})),e}(t))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return Dt})),n.d(e,"a",(function(){return Rt}));var r,i=n(2),o=n(1),u=n(27),c=n(3),s=n(4);!function(t){t[t.DesignPage=0]="DesignPage",t[t.DesignPageRtl=1]="DesignPageRtl",t[t.ResponsePage=2]="ResponsePage",t[t.ResponsePageRtl=3]="ResponsePageRtl",t[t.MobileDesignPage=4]="MobileDesignPage",t[t.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(r||(r={}));var a,f=n(22),l=n(5),h=n(51);function d(t){return function(t){var e=$.Deferred();void 0===a&&(a={DesignPage:Object(h.b)(Object(l.a)().scriptName+".min.css",!0),DesignPageRtl:Object(h.b)(Object(l.a)().scriptName+".rtl.min.css",!0),MobileDesignPage:Object(h.b)(Object(l.a)().scriptName+".min.css",!0),MobileDesignPageRtl:Object(h.b)(Object(l.a)().scriptName+".rtl.min.css",!0),ResponsePage:Object(h.b)(Object(l.a)().responsePageCssName+"min.css",!0),ResponsePageRtl:Object(h.b)(Object(l.a)().responsePageCssName+"rtl.min.css",!0)});var n=a[r[t]];if(!n)throw Error("No path for "+r[t]);var i=document.getElementsByTagName("head")[0];if(!i)return e.reject(Error("No head element found!")).promise();var o=document.createElement("link");o.rel="stylesheet",o.href=n;var u=document.getElementById("form-page-css"),c=$(u).attr("href");if(c&&n.toLowerCase()===c.toLowerCase())return e.resolve().promise();return i.removeChild(u),o.id="form-page-css",o.onload=function(){return e.resolve()},o.onerror=function(){i.removeChild(o),e.reject(Error("Failed to load css file: "+n)),f.a.logData({extraData:{name:r[t],url:n},name:"Error.CssLoadingError.FailedToLoadCss"})},i.appendChild(o),e.promise()}(t)}var m=n(11),b=n(8),v=n(35),g=n(76),p=n(71),O=n(6),j=n(47),w=n(10),I=n(60),S=n(9),F=n(39),y=n(132),N=n(77),T=n(102),k=n(129),P=n(32),C=n(31);function L(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,169))];case 1:return[2,{default:t.sent().ReportPage}]}}))}))}function M(t){var e=Object(C.a)(M,L);return o.createElement(P.a,null,o.createElement(e,Object(i.a)({},t)))}function x(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,164))];case 1:return[2,{default:t.sent().ThankYouPage}]}}))}))}function D(t){var e=Object(C.a)(D,x);return o.createElement(P.a,null,o.createElement(e,Object(i.a)({},t)))}var R=n(15),E=n(12),A=n(62),_=n(84),U=(n(73),n(25)),B=n(7),Q=n(48),q=n(16),V=n(93),z=n(95);var G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e=t.RadioCheckbox?"radio":"checkbox",n=t.Options,r=n&&n.classNameForInnerDiv,i=Object(w.a)(e,n&&n.classNameForInnerLabel),u=t.Disabled,c=t.HelpText||void 0,s=Object(w.f)(n&&n.HTMLPropsForInnerElement,{checked:t.Value,disabled:u,type:e,onChange:this.ke.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:t.CheckboxAutoFocus}),a=o.createElement("div",{className:i},o.createElement("label",{disabled:u},o.createElement("input",s),o.createElement("span",{className:this.props.SpanClassName},t.Description),t.ShowRequiredStar?o.createElement(z.a):void 0));return[o.createElement("div",{className:r,id:t.Id,disabled:u,title:c},a,t.children)]},n.ke=function(t){this.props.onValueChange(t.nativeEvent.target.checked)},e}(V.a),H=n(29),W=n(111),J=n(122);var K=n(74),X={af:"Afrikaans","am-et":"አማርኛ (ኢትዮጵያ)‎",ar:"العربية","as-in":"অসমীয়া (ভাৰত)‎","az-latn-az":"azərbaycan (Azərbaycan)‎",be:"Беларуская",bg:"български","bn-bd":"বাংলা (বাংলাদেশ)‎","bn-in":"বাংলা (ভারত)‎","bs-latn-ba":"bosanski (Bosna i Hercegovina)‎",ca:"català","ca-es-valencia":"valencià (Espanya)‎",cs:"čeština","cy-gb":"Cymraeg (Y Deyrnas Unedig)‎",da:"dansk",de:"Deutsch",el:"Ελληνικά","en-gb":"English (United Kingdom)‎","en-us":"English (United States)‎",es:"español","es-mx":"español (México)‎",et:"eesti",eu:"euskara",fa:"فارسی",fi:"suomi","fil-ph":"Filipino (Pilipinas)‎",fr:"français","fr-ca":"français (Canada)‎","ga-ie":"Gaeilge (Éire)‎",gd:"Gàidhlig",gl:"galego",gu:"ગુજરાતી","ha-latn-ng":"Hausa (Najeriya)‎",he:"עברית",hi:"हिन्दी",hr:"hrvatski",hu:"magyar",hy:"Հայերեն",id:"Indonesia",is:"íslenska",it:"italiano",ja:"日本語",ka:"ქართული",kk:"қазақ тілі","km-kh":"ភាសាខ្មែរ (កម្ពុជា)‎",kn:"ಕನ್ನಡ",ko:"한국어",kok:"कोंकणी",ky:"Кыргыз","lb-lu":"Lëtzebuergesch (Lëtzebuerg)‎",lo:"ລາວ",lt:"lietuvių",lv:"latviešu","mi-nz":"te reo Māori (Aotearoa)‎",mk:"македонски",ml:"മലയാളം",mn:"монгол",mr:"मराठी",ms:"Melayu","mt-mt":"Malti (Malta)‎","nb-no":"norsk bokmål (Norge)‎","ne-np":"नेपाली (नेपाल)‎",nl:"Nederlands","nn-no":"nynorsk (Noreg)‎","or-in":"ଓଡ଼ିଆ (ଭାରତ)‎",pa:"ਪੰਜਾਬੀ",pl:"polski","prs-af":"درى (افغانستان)‏","pt-br":"português (Brasil)‎","pt-pt":"português (Portugal)‎","quz-pe":"Runasimi (Perú)‎",ro:"română",ru:"русский","sd-arab-pk":"سنڌي (پاکستان)‏","si-lk":"සිංහල (ශ්‍රී ලංකාව)‎",sk:"slovenčina",sl:"slovenščina",sq:"shqip","sr-cyrl-ba":"српски (Босна и Херцеговина)‎","sr-cyrl-rs":"српски (Србија)‎","sr-latn-rs":"srpski (Srbija)‎",sv:"svenska",sw:"Kiswahili",ta:"தமிழ்",te:"తెలుగు",th:"ไทย","tk-tm":"Türkmen dili (Türkmenistan)‎",tr:"Türkçe",tt:"Татар",ug:"ئۇيغۇرچە",uk:"українська",ur:"اُردو","uz-latn-uz":"o‘zbek (Oʻzbekiston)‎",vi:"Tiếng Việt","zh-cn":"中文（中国）‎","zh-hk":"中文（香港特別行政區）‎","zh-tw":"中文（台灣）‎"},Y=["ar","fa","he","prs-af","sd-arab-pk","ug","ur"];function Z(t){return"zh-hk"===t?"zh-tw":t}var tt=n(17),et=function(t){function e(e){var n=t.call(this,e)||this;return n.state={LabelDetailLoaded:!1,LabelsLoaded:!1},n.Wi=function(){return n.forceUpdate()},n.props.FormMaster.observe(n.Wi,[n.props.FormMaster.Schema.DataClassificationLabel]),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.DesignTimeView&&Object(F.b)().done((function(e){t.Ji=Object(S.w)(e),t.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(E.a.Schema.DataClassificationLabel)&&Object(F.a)(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).done((function(e){t.Ki=e,t.setState({LabelDetailLoaded:!0})}))},n.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.Wi,[this.props.FormMaster.Schema.DataClassificationLabel])},n.render=function(){if(!this.props.FormMaster.isFieldReady(E.a.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.Ki))return null;var t=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var e=0,n=this.Ji;e<n.length;e++){var r=n[e];if(r.level===t&&!r.showInFormContent)return null}var i=Object(w.a)(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return o.createElement("div",{className:i},t)},e}(tt.a),nt=n(37);function rt(t){return ot(t,6)}function it(t){var e=ot(t,7);return!e||Object(v.d)()||129!==t&&1!==t&&128!==t||(e=!1),e}function ot(t,e){return!!ut(t,80)||!ut(t,8)&&(128!==t&&ut(t,e))}function ut(t,e){return 0!=(t&e)}function ct(t,e){switch(e){case"Design":case"Analyze":case"ShareForm":return function(t){return ut(t,80)?Object(B.c)((function(){return Object(O.a)().cdfcgmh}),B.e):ut(t,4)?Object(B.c)((function(){return Object(O.a)().mdghfde}),B.e):ut(t,2)?Object(v.d)()?Object(B.c)((function(){return Object(O.a)().ialoiij}),B.e):Object(B.c)((function(){return Object(O.a)().akpmaij}),B.e):ut(t,1)?Object(B.c)((function(){return Object(O.a)().ekneime}),B.e):void 0}(t);case"Response":return function(t){return ut(t,4)?Object(B.c)((function(){return Object(O.a)().konjofi}),B.e):ut(t,2)?Object(B.c)((function(){return Object(O.a)().fmgaldb}),B.e):ut(t,1)?Object(B.c)((function(){return Object(O.a)().mmabjme}),B.e):void 0}(t);default:return}}var st=n(92),at=n(26),ft=n(110),lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ie=o.createRef(),e}return Object(i.c)(e,t),e.prototype.render=function(){var t=o.createElement("div",{className:"introduction-title-container"},o.createElement("div",{className:"introduction-title"},Object(O.a)().cebkooh),o.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:ht},Object(O.a)().ehfdcib)),e={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":Object(O.a)().idhemgj,className:"introduction-create-form",onClick:dt,title:Object(O.a)().idhemgj},ref:this.Ie,Text:Object(O.a)().idhemgj},n=o.createElement(K.a,Object(i.a)({},e));return o.createElement("div",{className:"office-form introduction-for-responser-container"},t,o.createElement("div",{className:"introduction-container"},o.createElement("div",{className:"introduction"},o.createElement(ft.a,{alt:Object(O.a)().obdlbjj,className:"introduction-image",key:"introductionImage1",src:"/Images/MSAIntroduction1.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().obdlbjj)),o.createElement("div",{className:"introduction"},o.createElement(ft.a,{alt:Object(O.a)().dkhdgpc,className:"introduction-image",key:"introductionImage2",src:"/Images/MSAIntroduction2.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().dkhdgpc)),o.createElement("div",{className:"introduction"},o.createElement(ft.a,{alt:Object(O.a)().agknboi,className:"introduction-image",key:"introductionImage3",src:"/Images/MSAIntroduction3.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().agknboi))),o.createElement("div",{className:"introduction-button"},n))},e}(tt.a);function ht(){return Object(q.a)({eventName:"ResponsePage.IntroductionForResponser.TryForms",eventType:"engagement_event"}),Object(at.c)("/Pages/DesignPage.aspx"),!0}function dt(){return Object(q.a)({eventName:"ResponsePage.IntroductionForResponser.Create",eventType:"engagement_event"}),Object(at.c)("/Pages/DesignPage.aspx"),!0}var mt=n(119),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.render=function(){var t="form-renderer-section-breaker";return this.props.HasTheme&&(t=Object(w.a)(t,"office-form-theme-page-background")),o.createElement("div",{className:t})},e}(tt.a),vt=n(28),gt=n(21),pt=n(114),Ot=n(49),jt=n(33),wt=n(40),It=n(113),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.render=function(){var t;return t=this.props.ShowVideoUrl?o.createElement(It.a,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):o.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:e.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%"}),o.createElement("div",Object(i.a)({},this.props.HTMLAttributes),t,this.props.children)},e.calcVideoDisplayHeight=function(){if(Object(S.k)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),9*t/16}return Object(vt.c)()},e}(tt.a),Ft=n(116),yt=n(117),Nt=n(121),Tt=n(120),kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.Xi(this.props)},n.componentWillReceiveProps=function(t){this.Xi(t)},n.componentDidMount=function(){var t=this;this.xn=function(){return t.forceUpdate()};var e=this.props.Master,n=Ot.a.Schema;e.observe(this.xn,[n.Title,n.Subtitle,n.VideoInfo,n.CoAuthors]),e.Form.observe(this.xn,[E.a.Schema.HasQuestionMedia]);var r=Object(gt.g)().Schema;e.ImageSettingsMaster.observe(this.xn,[r.NaturalWidth,r.NaturalHeight,r.ContainerWidth,r.ContainerHeight,r.Size,r.Layout]);var i=Object(gt.f)().Schema;e.ImageInfoMaster.observe(this.xn,[i.ImageProcessingStatus,i.UploadParameters]),this.er=Object(gt.b)(),this.er.observe(this.xn,[this.er.Schema.FormsTenantSettings])},n.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.xn),t.ImageInfoMaster.unobserve(this.xn),t.ImageSettingsMaster.unobserve(this.xn),this.er.unobserve(this.xn)},n.render=function(){var t,e=this.props.Master,n=e.Model,r="Right",i=n.VideoInfo,u=e.ImageInfoMaster,s=e.ImageSettingsMaster,a=u.Model;if(!this.props.HideMedia)if(a.ErrorType||a.ImageProcessingStatus===jt.b.Idle&&!Object(jt.d)(a))e.hasValidVideoUrl()&&(r="Bottom",t=o.createElement(St,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:i.Url,IsMobile:Object(S.k)(),ShowVideoUrl:Object(pt.a)(i.Url,e.Form),LocalizedStrings:this.props.LocalizedStrings}));else{var f=this.Yi(s.Model);r=f.ImageLayout,t=o.createElement(Tt.a,{FullFilled:"Bottom"===r,ImageWidth:f.Width,ImageHeight:f.Height,ImageInfoMaster:u,ImageSettingMaster:s,ImageType:"Section",key:"image"})}var l=c.extend({},this.props.HTMLAttributes);l.className=Object(w.a)(l.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var h,d;if(this.Zi){var m=this.Zi.Model;Object(B.c)((function(){h=m.title||"",d=m.subtitle||""}),B.e)}return Object(B.c)((function(){h=h||n.Title,d=d||n.Subtitle}),B.e),o.createElement(Nt.a,{Heading:2,HTMLAttributes:l,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color"},MediaLayout:r,ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.props.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:null},SubTitle:d,Title:h},t,this.to())},n.Xi=function(t){var e=t.Master,n=e.Form,r=t.LocaleId;this.Zi=r?A.a.getQuestionResourceMaster(r,e.Model.Id,n):void 0},n.to=function(){var t=this,e=this.props.Master.Model.CoAuthors;if(e&&e.length>0&&e[e.length-1].userId!==Object(l.a)().userInfo.UserId)return o.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},c.map(e,(function(e){return t.eo(e)})))},n.eo=function(t){if(t.userId!==Object(l.a)().userInfo.UserId){var e=this.props.LocalizedStrings.ppmkgom.format(t.displayName||t.userId,this.props.Ordinal);return o.createElement(Ft.a,{ariaLabel:e,displayText:Object(yt.a)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.Yi=function(t){return this.props.IsMobile||Object(S.r)()||t.Layout===wt.a.Horizontal&&t.Size===wt.c.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight||Object(vt.g)(),ImageLayout:"Right",Width:t.ContainerWidth||Object(vt.h)()}},e}(tt.a),Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){return o.createElement("div",{className:"form-renderer-section-container",role:"region","aria-label":this.props.SectionMaster.Model.Title},this.createSectionTitle(),o.createElement("div",{className:"form-renderer-section-content"},this.props.children))},n.createSectionTitle=function(){var t=this,e=this.props.SectionMaster.Model;return e.Title||e.Subtitle||e.ImageInfo.ResourceUrl||e.VideoInfo.Url?o.createElement(nt.a.Consumer,null,(function(e){var n=e.LocalizedStrings;return o.createElement("div",{className:"form-renderer-section-title"},o.createElement(kt,{IsMobile:t.props.IsMobile,LocaleId:t.props.LocaleId,LocalizedStrings:n,Master:t.props.SectionMaster,ShouldShowImmersiveReaderButtons:t.props.ShouldShowImmersiveReaderButtons}))})):null},e}(tt.a),Ct=n(89),Lt=n(136),Mt=n(131),xt=n(45);FormsPro.MSRewardsDataState;function Dt(t){return o.createElement(Rt,t)}var Rt=function(t){function e(e){var n=t.call(this,e)||this;n.no=!1,n.io=!1,n.oo=0,n.defaultLanguageId=n.props.Master.Model.DefaultLanguage,n.uo=function(t){n.setState({ShouldShowImmersiveReaderButtons:t||!n.state.ShouldShowImmersiveReaderButtons})},n.co=o.createRef();var r=X;return n.defaultLanguageName=r[n.defaultLanguageId],n.state={IsSmallScreen:$(window).width()<768,SubmitState:0,ShowDuplicateSpinner:!1,ShowErrorPage:!1,ShowPhishingWarningBar:!0,IsStudentViewMode:null!=n.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:n.props.Master.Model.LocaleList.length&&{localeId:n.defaultLanguageId,localeName:n.defaultLanguageName},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1,LocalizedStrings:Object(O.a)(),ShouldShowImmersiveReaderButtons:!Object(b.c)("ImmersiveReaderMobileToggle")||!n.isMobile(),ShowLongOperationMessage:!1,ShowCompletionRate:!1,CompletionRate:0,WrongQuestionCount:0,SubmitButtonDependencyReady:!Object(b.b)()},n.so=n.so.bind(n),n.xn=n.xn.bind(n),n.ao=n.ao.bind(n),n.fo=n.fo.bind(n),n.ho=n.ho.bind(n),n.do=n.do.bind(n),n.mo=n.mo.bind(n),n.bo=n.bo.bind(n),n.vo=n.vo.bind(n),n.po=n.po.bind(n),n.Oo=n.Oo.bind(n),n.jo=n.jo.bind(n),n.wo=n.wo.bind(n),n.Io=n.Io.bind(n),n.So=n.So.bind(n),n.Fo=n.Fo.bind(n),n.yo=e.PhishingReviewUXFactory,e.IncrementalQuestionLoader&&e.IncrementalQuestionLoader.setQuizRenderer(n),Object(b.b)()&&Promise.all([Object(y.a)(),Object(k.a)()]).then((function(){return n.setState({SubmitButtonDependencyReady:!0})})),n}Object(i.c)(e,t);var a=e.prototype;return a.componentWillMount=function(){if(this.formRuntimeMaster=new _.a(this.props.Master,{disableBranching:this.vn()}),this.state.IsStudentViewMode?this.updateWithResponse(this.props.Response):this.No(this.props.PersistedAnswers),this.To(this.props.PersistedSectionId),Object(b.c)("ProgressBar")){this.Po()!==this.state.ShowCompletionRate&&this.setState({ShowCompletionRate:!this.state.ShowCompletionRate});var t=this.Co();t!==this.state.CompletionRate&&this.setState({CompletionRate:t})}this.formRuntimeMaster.observeAnswerChange(this.ao),this.formRuntimeMaster.observe(this.fo,[_.a.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.xn,[_.a.Schema.BranchChangeVersion,_.a.Schema.QuestionRuntimeMasters,_.a.Schema.UploadingFileCount]),window.addEventListener("resize",this.so)},a.componentDidMount=function(){return Object(i.b)(this,void 0,void 0,(function(){var t,e,n,r,o,u,c,a,f=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return Object(I.d)(),this.props.ForcedLocaleId?((t=this.props.Master.Model.LocalizedResources)&&t[0]&&t[0].localeId==this.props.ForcedLocaleId&&this.setState({LocalizedResource:t[0],ShowSpinnerForFirstTimeLoadMultilingual:!1}),[3,8]):[3,1];case 1:return this.state.IsStudentViewMode?(e=this.props.Response.SubmitLanguage)?(n=JSON.parse(e).localeId,[4,this.Lo(n)]):[3,3]:[3,4];case 2:i.sent(),this.ensureLayout(n),i.label=3;case 3:return[3,8];case 4:return(r=this.props.Master.Model.LocaleList).length>0?(o=this.props.Master.SyncContext===R.a.ResponseTimeForm,u=Object(l.a)().cultureInfo.Name.toLowerCase(),(c=s.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:u}))?[4,this.Lo(u)]:[3,6]):[3,8];case 5:return i.sent(),this.ensureLayout(u),[3,7];case 6:this.ensureLayout(this.defaultLanguageId),u!==this.defaultLanguageId&&(a=Z(this.defaultLanguageId),Object(O.b)(a).done((function(t){f.setState({LocalizedStrings:t})}))),i.label=7;case 7:o&&Object(q.a)({eventName:"ResponsePage.MultiLingual.OpenForm",eventType:"engagement_event",extraData:{browserLocaleId:u,defaultLocaleId:this.defaultLanguageId,firstRenderMatched:!!c,localeCount:r.length}}),i.label=8;case 8:return this.Mo(),this.xo(),[2]}}))}))},a.Mo=function(){return Object(i.b)(this,void 0,void 0,(function(){var t,e,n;return Object(i.d)(this,(function(r){switch(r.label){case 0:return[4,this.Do()];case 1:return t=r.sent(),[4,this.Ro()];case 2:return e=r.sent(),[4,this.Eo()];case 3:return n=r.sent(),this.setState({DuplicateNavBar:t,DuplicateMessage:e,ResultContainer:n}),[2]}}))}))},a.setResultContainer=function(t){return Object(i.b)(this,void 0,void 0,(function(){var e,n;return Object(i.d)(this,(function(r){switch(r.label){case 0:return e=this.setState,n={},[4,this.Eo()];case 1:return e.apply(this,[(n.ResultContainer=r.sent(),n),t]),[2]}}))}))},a.componentDidUpdate=function(){Object(I.d)(),Object(p.a)($(".office-form-answerhint")),this.xo()},a.componentWillUnmount=function(){window.removeEventListener("resize",this.so),this.formRuntimeMaster.observe(this.fo),this.formRuntimeMaster.unobserveAnswerChange(this.ao),this.formRuntimeMaster.unobserve(this.xn),this.formRuntimeMaster.release()},a.render=function(){var t=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.Ao();var e,n=this.props.Master.SyncContext===R.a.SharedTimeForm;if(this.state.ShowErrorPage)return Object(N.a)({Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var r={className:Object(B.c)((function(){return"office-form-content office-form-page-padding"}),B.e)};if(this.props.HTMLAttributes&&(r.className=Object(w.a)(r.className,this.props.HTMLAttributes.className)),!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&it(this.props.Master.Model.OnlineSafetyLevel)&&(r.className=Object(w.a)(r.className,"height-with-tip-bar")),n&&(r.className=Object(w.a)(r.className,"share-page")),(this.props.ViewMode===xt.a.Mobile||this.state.IsSmallScreen)&&(r.className=Object(w.a)(r.className,"small-screen")),this.isMobile()&&(r.className=Object(w.a)(r.className,"mobile-view")),3===this.state.SubmitState||4===this.state.SubmitState&&!this.state.ShowQuizResult){var i,u;this.props.Master.Model.Settings.RequiresUniqueResponse||Object(b.c)("HideSubmitAnother")&&Object(l.a)().hideSubmitAnother||(i=function(){return t._o()}),4===this.state.SubmitState&&(u=this.bo);var c=this.state.LocalizedResource.localeId;e=o.createElement(nt.a.Consumer,{children:function(e){return D({FormMaster:t.props.Master,LocaleId:c!==t.defaultLanguageId&&c,LocalizedStrings:e.LocalizedStrings,ShowPromotionMessage:!Object(j.d)(),submitAnother:i,viewResultsHandler:u,CustomStyle:!1,msRewardsThankYouProps:!1})}}),Object(U.a)().Flighting.isEnabled_Deprecated("MSAIntroductionForResponder")&&Object(v.d)()&&!this.isMobile()&&(e=o.createElement("div",null,e,o.createElement(lt)))}else e=this.state.IsReportingView?o.createElement(nt.a.Consumer,{children:function(e){return M({LocalizedStrings:e.LocalizedStrings,FormMaster:t.props.Master})}}):o.createElement("div",null,o.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.Uo(),!this.isMobile()&&this.$o(),Object(B.c)((function(){return t.cr()}),B.e),this.state.ResultContainer,o.createElement("div",{className:"office-form-body"},this.Bo(),this.Qo(),this.qo(),this.Vo(),o.createElement("div",{className:"office-form-button-container"},this.zo(),this.Go(),this.Ho()),this.state.DuplicateMessage,o.createElement("div",{className:this.no?"office-form-error-message-container compact-view":"office-form-error-message-container"},this.Wo(),this.Jo()),this.Ko(),this.Xo())),this.Yo());var s="form-content-container";return this.props.ViewMode===xt.a.Mobile?s="form-content-container mobile-view":this.state.IsSmallScreen&&(s="form-content-container small-screen"),o.createElement(nt.a.Provider,{value:this.state,children:o.createElement("div",{className:s,ref:this.co},this.state.DuplicateNavBar,this.Zo(),this.tu(),this.nu(),o.createElement("div",r,this.props.HeaderMessage&&this.iu(),o.createElement(Ct.a,{ThemeMaster:this.props.Master.ThemeMaster}),this.isMobile()&&this.$o(),e),this.ou(),this.uu())})},a.updateWithResponse=function(t){t&&(this.No(t.Answers),this.formRuntimeMaster.updateWithResponse(t),this.setServerQuizResult(t.QuizResult),this.setState({ShowQuizResult:!0,IsStudentViewMode:!0}),this.setResultContainer())},a.Yo=function(){if(!this.props.MobileReadOnly){var t="ShowStatementWithNotice";return this.props.Master.SyncContext===R.a.ResponseTimeForm&&this.props.Master.Model.Settings.IsAnonymous&&(t="ShowStatement"),o.createElement(st.a,{FormMaster:this.props.Master,FooterType:t,FooterText:!1})}},a.tu=function(){if(this.yo)return this.yo.createPhishingWarningPage(this.props.Master,this.state.IsReportingView)},a.nu=function(){var t=this,e=this.props.Master.Model.OnlineSafetyLevel,n=this.cu()?"ShareForm":"Response";if(it(e)&&!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&!this.su())return o.createElement(nt.a.Consumer,{children:function(r){return Object(T.c)({Info:ct(e,n),TipBarLocation:"Up",TipBarStyle:rt(e)?"RedBackground":"YellowBackground",ShouldClose:!rt(e),HrefInfo:!Object(b.c)("RemoveRuntimeWarningbarReportAbuse")&&r.LocalizedStrings.ohkkmbd,onClickHref:!Object(b.c)("RemoveRuntimeWarningbarReportAbuse")&&t.wo,onClose:t.Io})}})},a.wo=function(){this.setState({IsReportingView:!0})},a.Io=function(){this.setState({ShowPhishingWarningBar:!1})},a.Lo=function(t){var e=this;if(t!==this.defaultLanguageId&&this.props.Master.isFieldReady(E.a.Schema.LocalizedResources))if(this.state.IsStudentViewMode){var n=Z(t);Object(O.b)(n).done((function(n){e.setState({LocalizedStrings:n}),e.au(t)}))}else this.au(t)},a.au=function(t){var e=this;this.props.Master.getLocaleResouceById(t).done((function(t){var n=e.props.Master.Model.LocalizedResources,r=t.localizedResources;s.a.Collection.getItemWithKeyFields(n,{localeId:r[0].localeId})||s.a.Collection.itemsAddedInSource(n,r),e.setState({LocalizedResource:t&&r[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},a.Qo=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?this.fu():o.createElement("div",null,this.lu(this.formRuntimeMaster.TopQuestionRuntimeMasters()))},a.bo=function(){this.setState({ShowQuizResult:!0})},a.Xo=function(){if(this.state.ShowQuizResult&&4===this.state.SubmitState)return o.createElement("div",{className:"office-form-quiz-back-to-result-link"},o.createElement("a",{href:"javascript:void(0)",onClick:this.vo},Object(O.a)().jngjojj))},a.vo=function(){this.setState({ShowQuizResult:!1})},a.iu=function(){return o.createElement("div",{className:"form-header-text-message"},this.props.HeaderMessage)},a.Do=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return!(this.props.Master.SyncContext===R.a.SharedTimeForm)||this.state.IsReportingView?[2]:[4,n.e(14).then(n.bind(null,161))];case 1:return[2,(0,t.sent().createDuplicateNavBarInternal)(this)]}}))}))},a.Zo=function(){var t=this;if(this.yo)return this.yo.createAdminPhishingReviewNavBar(this.props.Master,(function(e){t.error=e,t.setState({ShowErrorPage:!0})}))},a.Ro=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.props.Master.SyncContext!==R.a.SharedTimeForm?[3,2]:[4,n.e(14).then(n.bind(null,161))];case 1:return[2,(0,t.sent().showDuplicateMessageInternal)(this)];case 2:return[2]}}))}))},a.Bo=function(){if(4!==this.state.SubmitState&&!this.state.IsStudentViewMode&&!this.props.MobileReadOnly){var t=[this.du(),this.mu()];return t.some((function(t){return!!t}))?o.createElement.apply(o,Object(i.f)(["div",{className:"office-form-notice-container"}],t)):void 0}},a.du=function(){var t=this,e=this.props.Master.Model.Settings,n=this.props.Master.SyncContext===R.a.SharedTimeForm,r=!this.formRuntimeMaster.ElementManager().isFirstPage();return n||r?void 0:o.createElement(nt.a.Consumer,{children:function(n){var r;if(e.IsAnonymous||e.NotRecordIdentity||t.props.PrintView)r="";else{var i=Object(l.a)().userInfo.GivenName||Object(l.a)().userInfo.DisplayName;i?r=n.LocalizedStrings.dkelneo.format(i):(Q.a.logData({errorName:"MissingUserName",errorInfo:{givenName:!!Object(l.a)().userInfo.GivenName,displayName:!!Object(l.a)().userInfo.DisplayName,userId:!!Object(l.a)().userInfo.UserId}}),r=n.LocalizedStrings.odpppah)}if(4!==t.state.SubmitState)return o.createElement("div",{},o.createElement("span",{className:"office-form-notice-long-text"},r))}})},a.mu=function(){if(!this.props.MobileReadOnly){var t=this.props.Master,e=[];return e=t.hasSection()&&!this.bu()?this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters.map((function(t){return t.Question.Model})):s.a.convertToArray(t.Model.Questions),c.some(e,(function(t){return t.Required}))?o.createElement(nt.a.Consumer,{children:function(t){return o.createElement("div",null,o.createElement("span",{className:"office-form-required-notice-star"}),o.createElement("span",null,t.LocalizedStrings.pfjnaob))}}):void 0}},a.Eo=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.state.IsStudentViewMode||4===this.state.SubmitState?[4,n.e(12).then(n.bind(null,162))]:[3,2];case 1:return[2,(0,t.sent().createResultContainerInternal)(this)];case 2:return[2]}}))}))},a.Wo=function(){var t=this;return o.createElement(nt.a.Consumer,{children:function(e){var n,r=t.vu(),i=r.map((function(t){return e.LocalizedStrings.fodbdkj.format(t)})).join(e.LocalizedStrings.lfignjp);n=t.formRuntimeMaster.ElementManager().hasNextSection()?e.LocalizedStrings.pegibod.format(r.length,i):e.LocalizedStrings.ohffajm.format(r.length,i);var u=Object(H.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),c=!!t.state.ShowValidationStyle&&!!r.length;return o.createElement("div",{className:Object(w.a)("office-form-submit-error",c?"":"NotVisible"),role:"alert"},u,o.createElement("span",{className:"error-message"},c?n:""))}})},a.vu=function(){return this.formRuntimeMaster.Form.hasSection()?this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters):this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters())},a.Ao=function(){if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return o.createElement("div",{className:"multi-lingual-page-loading-background"},o.createElement("div",{className:"page-loading-messagebox",tabIndex:0,"aria-label":Object(O.a)().padfjkn,"aria-live":"polite"},o.createElement("div",{className:"page-loading-animation"},o.createElement("div",{className:"spinner-tile-animation"})),o.createElement("div",{className:"page-loading-message"},Object(O.a)().padfjkn)))},a.$o=function(){if(this.showMultiLingualSelect()){var t=this.props.Master.Model.LocaleList,e=[];e.push({DisplayName:this.defaultLanguageName,Key:"default-language",Value:this.defaultLanguageId}),c.forEach(t,(function(t){e.push({DisplayName:t.localeName||"",Key:t.localeId,Value:t.localeId||""})}));var n="multi-lingual-select-control office-form-theme-secondary-background";this.isMobile()&&(n=Object(w.a)(n,"isMobile"));var r=this.state.LocalizedResource.localeId,i=void 0,o=c.find(e,(function(t){return t.Value===r}));return o&&(i=o.DisplayName),Object(W.a)({HTMLAttributes:{className:n,disabled:this.props.MobileReadOnly},Label:i,onValueChange:this.jo,Placeholder:e[0]&&e[0].DisplayName,PlaceholderIcon:"World",SelectOptions:e,Value:r})}},a.ou=function(){if(this.state.ShowSpinnerWhenChangeLanguage)return o.createElement("div",{className:"multi-lingual-spinner-container"},o.createElement("div",{className:"multi-lingual-blank-page"}),o.createElement("div",{className:"multi-lingual-spinner"},o.createElement("div",{className:"spinner-tile-animation"})))},a.jo=function(t){var e=this;Object(q.a)({eventName:"ResponsePage.MultiLingual.ChangeLanguage",eventType:"engagement_event",extraData:{LocaleId:t}});var n=Z(t);Object(O.b)(n).done((function(r){e.ensureLayout(n),e.setState({LocalizedStrings:r}),e.pu(t)}))},a.pu=function(t){if(t!==this.defaultLanguageId){if(this.props.Master.isFieldReady(E.a.Schema.LocalizedResources)){var e=s.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocalizedResources,{localeId:t});e?this.setState({LocalizedResource:e}):this.Ou(t)}}else this.setState({LocalizedResource:{localeId:this.defaultLanguageId,localeName:this.defaultLanguageName}})},a.Ou=function(t){var e=this;this.setState({ShowSpinnerWhenChangeLanguage:!0}),this.props.Master.getLocaleResouceById(t).done((function(t){s.a.Collection.itemsAddedInSource(e.props.Master.Model.LocalizedResources,t.localizedResources),e.setState({LocalizedResource:t&&t.localizedResources[0],ShowSpinnerWhenChangeLanguage:!1})}))},a.showMultiLingualSelect=function(){return!(!this.props.Master.Model.LocaleList.length||this.state.IsStudentViewMode||!this.bu()&&!this.formRuntimeMaster.ElementManager().isFirstPage())},a.Uo=function(){var t=this.props.Master,e=t.SyncContext===R.a.SharedTimeForm;if(!this.isMobile()&&(this.bu()||this.formRuntimeMaster.ElementManager().isFirstPage())&&(this.props.PrintView||Object(b.c)("DataClassificationRuntime")&&!Object(l.a)().userInfo.IsMsa&&e&&t.isFieldReady(E.a.Schema.DataClassificationLabel)&&t.Model.DataClassificationLabel)){var n=Object(w.a)(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return o.createElement(et,{FormMaster:this.props.Master,HTMLAttributes:{className:n},DesignTimeView:!1})}},a.su=function(){return this.props.Master.SyncContext===R.a.AdminPhishingReviewForm},a.cu=function(){return this.props.Master.SyncContext===R.a.SharedTimeForm},a.ensureLayout=function(t){var e;this.ju((e=t,-1!==Y.indexOf(e.toLowerCase())),t)},a.ju=function(t,e){var n=this,i=this.props.Master.SyncContext===R.a.ResponseTimeForm,o=this.props.Master.SyncContext===R.a.DesignTimeForm&&!Object(S.k)(),u=this.props.Master.SyncContext===R.a.DesignTimeForm&&Object(S.k)(),c=t?"rtl":"ltr";i?($("html").attr("lang",e),$(".form-content").attr("dir",c),d(t?r.ResponsePageRtl:r.ResponsePage).done((function(){return n.forceUpdate()}))):o?($(".form-content").attr({dir:c,lang:e}),d(t?r.DesignPageRtl:r.DesignPage).done((function(){return n.forceUpdate()}))):u&&($(".form-content").attr({dir:c,lang:e}),d(t?r.MobileDesignPageRtl:r.MobileDesignPage).done((function(){return n.forceUpdate()})))},a.cr=function(){var t=this.state.LocalizedResource.localeId;return Object(Lt.a)({Form:this.props.Master,LocaleId:t!==this.defaultLanguageId&&t,IsMobile:this.props.ViewMode===xt.a.Mobile||Object(S.k)(),IsReadOnlyOnMobile:this.props.MobileReadOnly,IsSlimTitle:!this.bu()&&!this.formRuntimeMaster.ElementManager().isFirstPage(),ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:this.uo}})},a.wu=function(){},a.Iu=function(t,e){var n=t.Section,r=t.TopQuestionMasters;if(!n)return this.lu(r);var i=n.Model.Id,u=this.state.LocalizedResource.localeId,c=[];e||c.push(o.createElement(bt,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+i}));var s=this.lu(r);return c.push(o.createElement(Pt,{children:s,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===xt.a.Mobile||Object(S.k)(),LocaleId:u!==this.defaultLanguageId&&u,key:"form-section-container-"+i,SectionMaster:n,ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons})),c},a.fu=function(){var t=this;return this.bu()?[this.formRuntimeMaster.ElementManager().getAllSections().map((function(e,n){return t.Iu(e,0===n)}))]:this.Iu(this.formRuntimeMaster.ElementManager().getCurrentSection(),!0)},a.lu=function(t){var e=this;if(t.length<=0)return null;var n,r=this.state.ShowValidationStyle,i=this.state.ShowQuizResult;Object(B.c)((function(){n=c.indexOf(e.formRuntimeMaster.TopQuestionRuntimeMasters(),t[0])+1}),B.e);var u=this.state.LocalizedResource.localeId;return o.createElement(nt.a.Consumer,{children:function(o){return t.map((function(t,c){var s=t.Question.Model.Id,a={SyncContext:e.props.Master.SyncContext,Master:t,LocaleId:u!==e.defaultLanguageId&&u,LocalizedStrings:o.LocalizedStrings,Ordinal:n+c,Disabled:4===e.state.SubmitState||e.state.IsStudentViewMode||t.Question.hasRuntimeError(),key:s,IsMobile:e.isMobile(),ShowValidationStyle:r,ShowQuizResult:i,ShowPhishingWarning:e.Su(),ShowFileInfo:!!e.props.HeaderMessage,HideMedia:!1,IsStudentViewMode:e.state.IsStudentViewMode,HideDeleteButton:1===e.state.SubmitState||4===e.state.SubmitState||e.state.IsStudentViewMode,increaseUploadingFileCountCallBack:e.ho,decreaseUploadingFileCountCallBack:e.do,setAbuseReportStateCallBack:e.mo,EnableShowHideQuestion:Object(B.c)((function(){return!1}),B.e),ShouldShowImmersiveReaderButtons:e.state.ShouldShowImmersiveReaderButtons};return Object(mt.a)(a)}))},key:"elementRenderers"})},a.Ho=function(){var t=this;return this.Fu()?o.createElement(nt.a.Consumer,{children:function(e){return o.createElement("div",{className:"office-form-bottom-button-div"},Object(K.b)({HTMLAttributes:{"aria-label":e.LocalizedStrings.nekefda,className:"section-next-button office-form-bottom-button office-form-theme-button",disabled:!!t.formRuntimeMaster.Model.UploadingFileCount,onClick:t.Oo},ButtonStyle:"LightBackground",Text:e.LocalizedStrings.nekefda}))}}):null},a.zo=function(){var t=this;if(this.bu()||!this.formRuntimeMaster.ElementManager().hasPrevSection())return null;var e=1===this.state.SubmitState||!!this.formRuntimeMaster.Model.UploadingFileCount;return o.createElement(nt.a.Consumer,{children:function(n){return o.createElement("div",{className:"office-form-bottom-button-div"},Object(K.b)({HTMLAttributes:{"aria-label":n.LocalizedStrings.pefpebc,className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:e,onClick:t.po},ButtonStyle:"LightBackground",Text:n.LocalizedStrings.pefpebc}))}})},a.Jo=function(){var t=this,e=Object(H.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),n=1===this.state.SubmitState&&this.state.ShowLongOperationMessage;if(2===this.state.SubmitState||n)return o.createElement(nt.a.Consumer,{children:function(r){return o.createElement(J.a,{HTMLAttributes:{className:Object(w.a)("office-form-submit-error",n?"submitting-warning":"")},LazyRendering:!0,Role:"Alert"},n?void 0:e,o.createElement("span",{className:"error-message"},n?r.LocalizedStrings.mfhhkkp:t.state.ErrorMessage))}})},a.Fu=function(){return!this.bu()&&this.formRuntimeMaster.ElementManager().hasNextSection()},a.uu=function(){var t,e,n=this.props.Master;if(3===this.state.SubmitState){if(this.state.LocalizedResource&&this.state.LocalizedResource.localeId!==n.Model.DefaultLanguage)t=A.a.getFormResourceMaster(this.state.LocalizedResource.localeId,n).Model.thankYouMessage;t=t||n.Model.ThankYouMessage||this.state.LocalizedStrings.fdofleb,e=this.state.LocalizedStrings.mpacble}return o.createElement("div",{className:"office-form-submit-success-hint","aria-live":"polite"},o.createElement("div",null,e),o.createElement("div",null,t))},a.Go=function(){var t=this;if(!(this.Fu()||4===this.state.SubmitState||this.state.IsStudentViewMode||this.props.MobileReadOnly)){var e=1===this.state.SubmitState,r=e||!this.state.SubmitButtonDependencyReady||this.props.Master.SyncContext===R.a.SharedTimeForm||this.props.Master.SyncContext===R.a.AdminPhishingReviewForm||this.props.DisableSubmitButton||Object(S.o)()||this.formRuntimeMaster.Model.UploadingFileCount||rt(this.props.Master.Model.OnlineSafetyLevel)||!1;return o.createElement(nt.a.Consumer,{children:function(u){return o.createElement("div",{className:"__submit-button-div__ office-form-bottom-button-div"},Object(K.b)({HTMLAttributes:{className:Object(w.a)("__submit-button__ office-form-bottom-button office-form-theme-button",e?"office-form-hide-text":""),disabled:r,title:Object(S.o)()?u.LocalizedStrings.oijphgi:void 0,onClick:function(){return Object(i.b)(t,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,163))];case 1:return(0,t.sent().default)(u,this),[2]}}))}))}},ButtonStyle:"LightBackground",Text:u.LocalizedStrings.mklfooc}),t.yu())}})}},a.yu=function(){var t;if(t=Object(b.c)("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",1===this.state.SubmitState)return o.createElement("div",{className:"submit-spinner"},o.createElement("div",{className:t},o.createElement(J.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:Object(O.a)().ghokihn})))},a.SetMsRewardsThankyouState=function(t){},a._o=function(){var t=this;f.a.logData({name:"ResponsePage.ThanksView.SubmitAnother"}),this.No(),this.To(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:0,ShowLongOperationMessage:!1,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},(function(){t.setState({HideQuestions:!1},e.scrollToTop)}))},a.No=function(t){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=t||[]},a.To=function(t){this.formRuntimeMaster.Model.RuntimeSectionId=t||null},a.setServerQuizResult=function(t){if(t){var e=Object(S.w)(t);Array.isArray(e)&&this.formRuntimeMaster.setQuizResults(e)}else this.formRuntimeMaster.calculateQuizResultFromModel()},a.isMobile=function(){switch(this.props.ViewMode){case xt.a.Desktop:return!1;case xt.a.Mobile:return!0;default:return Object(S.k)()}},a.ao=function(){var t=this.props.persistAnswer;t&&(this.formRuntimeMaster.isDefaultAnswer()?t(void 0):t(s.a.convertToArray(this.formRuntimeMaster.Answers)));var e=this.vu().length;e!==this.state.WrongQuestionCount&&this.setState({WrongQuestionCount:e})},a.fo=function(){var t=this.props.persistSectionId;t&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?t():t(this.formRuntimeMaster.Model.RuntimeSectionId));var e={ShowValidationStyle:!1},n=this.Co();n!=this.state.CompletionRate&&(e.CompletionRate=n),this.setState(e,this.Fo)},a.Fo=function(){Object(Mt.a)(u.findDOMNode(this)),e.scrollToTop()},a.ho=function(){this.formRuntimeMaster.Model.UploadingFileCount++},a.do=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},a.mo=function(){this.setState({IsReportingView:!0})},a.so=function(){Object(S.r)()!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):Object(I.d)()},a.Ko=function(){var t=this;if(this.Su()){var e=!1;if(Object(B.c)((function(){e=Object(b.c)("HideReportAbuse")}),B.e),!e)return o.createElement(nt.a.Consumer,{children:function(e){return o.createElement("div",{className:"office-form-notice-password"},e.LocalizedStrings.hfhnmin,o.createElement("a",{className:Object(S.n)()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return t.setState({IsReportingView:!0})}},e.LocalizedStrings.ohkkmbd))}})}},a.Su=function(){var t=this.props.Master.Model.Settings,e=this.props.Master.SyncContext===R.a.ResponseTimeForm;return!(!t.IsAnonymous||!e||this.state.ShowQuizResult||Object(m.u)()||Object(b.c)("RemoveRuntimeWarningbarReportAbuse")&&rt(this.props.Master.Model.OnlineSafetyLevel))},e.scrollToTop=function(){Object(w.h)($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(w.h)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},a.qo=function(){var t=this,e=this.props.Master.Model,n=e.EmailReceiptEnabled&&!e.Settings.IsAnonymous&&!e.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.Fu();return o.createElement(nt.a.Consumer,{children:function(e){return n&&(r={HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:t.state.EmailReceiptConsent,Description:e.LocalizedStrings.aopligj,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(e){t.setState({EmailReceiptConsent:e})}},o.createElement(G,r));var r}})},a.Vo=function(){var t=this;if(this.state.ShowCompletionRate&&!this.state.ShowQuizResult){var e=o.createElement(nt.a.Consumer,{children:function(e){var n,r,i=e.LocalizedStrings.agcmigi;return"survey"==t.props.Master.Model.Type?i=e.LocalizedStrings.ogdimhj:t.props.Master.SettingMaster.Model.IsQuizMode&&(i=e.LocalizedStrings.ginnggl),n={percentage:t.state.CompletionRate,lowerText:t.state.CompletionRate+"%",totalWidth:300,tooltipText:e.LocalizedStrings.edfcndj.format(t.state.CompletionRate,i)},r=Math.round(n.percentage*n.totalWidth/100),o.createElement("div",{"aria-label":n.tooltipText,title:n.tooltipText},o.createElement("div",{className:"progress-bar",style:{width:n.totalWidth+"px"}},o.createElement("div",{className:"progress-bar-control office-form-theme-primary-background",style:{width:r+"px"}})),o.createElement("div",{className:"progress-bar-text"},n.lowerText))}});return o.createElement("div",{className:"progress-bar-container"},e)}},a.Nu=function(){return!(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters).length>0)||(this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError),!1)},a.po=function(){this.formRuntimeMaster.ElementManager().gotoPrevSection()},a.Oo=function(){(this.props.Master.SyncContext===R.a.SharedTimeForm||this.Nu())&&this.formRuntimeMaster.ElementManager().gotoNextSection()},a.bu=function(){return this.state.ShowQuizResult||this.props.PrintView||this.props.MobileReadOnly},a.xn=function(){this.forceUpdate()},a.So=function(){},a.vn=function(){return this.props.PrintView||this.props.MobileReadOnly},a.xo=function(){var t=this;Object(S.h)()||Object(U.a)().Flighting.isEnabled("ImmersiveReaderInForms")&&Object(F.d)().then((function(e){e&&Object(g.a)("ImmersiveReader").done((function(){if(ImmersiveReader){var e=t.co.current;if(e){for(var n=e.querySelectorAll(".immersive-reader-button img"),r=0;r<n.length;r++){var i=n[r];i.remove?i.remove():i.parentNode&&i.parentNode.removeChild(i)}ImmersiveReader.renderButtons()}}}))}))},a.Po=function(){if(Object(b.c)("ProgressBar")){var t=this.props.Master,e=!!t.isFieldReady(E.a.Schema.ProgressBarEnabled)&&"true"===t.Model.ProgressBarEnabled;return this.Tu=t.FormElementManager.SectionMasters,this.oo=t.FormElementManager.HeaderTopQuestionMasters.length>0?1:0,e&&this.Tu.length+this.oo>1}return!1},a.Co=function(){var t=0;if(this.state.ShowCompletionRate){var e=this.ku(),n=this.Tu.length+this.oo;e&&0!=e&&(t=Math.round(100*e/n)),Object(q.a)({eventName:"ResponsePage.Form.SectionRender",eventType:"engagement_event",extraData:{ProgressBarPercentage:t}})}return t},a.ku=function(){var t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId;if(!e)return 0;var n=t.Form.FormElementManager.getDescriptiveElementMasterById(e);return n?this.Tu.indexOf(n)+this.oo:0},e}(tt.a)},,function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return p})),n.d(e,"d",(function(){return O})),n.d(e,"a",(function(){return j})),n.d(e,"g",(function(){return I})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return y}));var r=n(1),i=n(3),o=(n(6),n(36)),u=n(29),c=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],s=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],a=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],f=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],l=["pdf"],h=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],d=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],m={};c.forEach((function(t){return m[t]="Audio"})),s.forEach((function(t){return m[t]="Excel"})),a.forEach((function(t){return m[t]="Image"})),f.forEach((function(t){return m[t]="PowerPoint"})),l.forEach((function(t){return m[t]="PDF"})),h.forEach((function(t){return m[t]="Video"})),d.forEach((function(t){return m[t]="Word"}));var b={Audio:c,Excel:s,Image:a,PDF:l,PowerPoint:f,Video:h,Word:d},v={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},g={"10MB":10,"100MB":100,"1GB":1e3};function p(t){var e=[];return Object.keys(t).forEach((function(n){t[n]&&(e=e.concat(b[n]))})),e}function O(t){var e=w(t),n={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:e.Color}};return r.createElement(u.a,{HTMLAttributes:n,IconName:e.Name})}function j(t,e){switch(e){case"Audio":return t.nhpokab;case"Excel":return t.dhiakai;case"Image":return t.fkkhill;case"PowerPoint":return t.pcaoepa;case"PDF":return t.blblgmo;case"Video":return t.ofdfnbc;case"Word":return t.pdnjgcf;default:return""}}function w(t){var e=t.split("."),n=e[e.length-1].toLowerCase();return v[m[n]]||{Color:"#666666",Name:"TextDocument"}}function I(t,e){var n=t.Model.Id,r=!!i.find(t.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}));if(S(n)||!r){var u=F(),c=i.find(u,(function(t){return t.FormId===n}));c?c.ShowConfirmDialog=c.ShowConfirmDialog&&e:u.push({FormId:n,ShowConfirmDialog:!0}),Object(o.b)().setItem("officeforms.fileuploaddialogmap",JSON.stringify(u))}}function S(t){var e=i.find(F(),(function(e){return e.FormId===t}));return!!e&&e.ShowConfirmDialog}function F(){var t=[],e=Object(o.b)().getItem("officeforms.fileuploaddialogmap");return e&&(t=JSON.parse(e)),t}function y(t){var e=t.Model.FileTypes;Object.keys(e).forEach((function(t){e[t]=!0}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18);function i(){return r.a.Resolve("IThirdPartyRateIt")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a}));var r=n(11),i=n(5),o=n(14),u=n(26),c=n(42),s=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(c.c)()},e.handleAuthForContentPage=function(t){},e.handleAuthForAddinPage=function(){},e.hasUserLoggedIn=function(){return!!Object(i.a)().userInfo.UserId},e.isValid=function(){return Object(r.o)()},e.redirectToLogin=function(){var t=encodeURIComponent(window.location.href),e=Object(i.a)().userInfo.IsMsa,n="Response"===Object(r.n)(),c=Object(i.a)().signInLink;return!e||n?c=Object(o.d)(c,"state",t):(c=Object(i.a)().signInLinkMsa,c=Object(o.d)(c,"redirecturl",t)),Object(u.f)(c),$.Deferred().promise()},e.refreshToken=function(){return Object(c.g)()},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return Object(u.c)(Object(i.a)().signOutLink).then((function(){return $.Deferred().promise()}))},t}();function a(t){var e;if(t){var n=encodeURIComponent(t);e=window.location.origin+"/?redirecturl="+n+"#Login=True"}else e=window.location.origin+"#Login=True";Object(u.f)(e)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));n(3),n(145);function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t&&document.activeElement&&t.contains(document.activeElement)){var r=$(":focusable");e&&e.forEach((function(t){r=r.not((function(e,n){return t.contains(n)}))}));var i=r.index(document.activeElement);if(!(i<0)){for(var u=i+1;u<r.length;++u){var c=r[u];if(!t.contains(c)&&!o(c))return void r[u].focus()}for(u=i-1;u>=0;--u){c=r[u];if(!t.contains(c)&&!o(c))return void r[u].focus()}}}}function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=$(t).find(":focusable");e&&e.forEach((function(t){r=r.not((function(e,n){return t.contains(n)}))})),r.length>0&&r[0].focus()}function o(t){var e=Number(t.getAttribute("tabindex"));return!isNaN(e)&&e<0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18);function i(){return r.a.Resolve("IThirdPartyDateTimePicker")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(1),o=n(11),u=n(15),c=n(17),s="https://go.microsoft.com/fwlink/?linkid=866263",a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=s;this.props.ForceUseCommercialTermsLink?t=function(){if(Object(o.y)())return"https://portal.office.com/account/#subscriptions";if(Object(o.x)())return"https://portal.office365.us/account/#subscriptions";if(Object(o.w)())return"https://portal.apps.mil/account/#subscriptions";return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}():this.props.FormMaster&&(t=function(t){if(t.SyncContext!==u.a.AdminPhishingReviewForm&&(t.SyncContext===u.a.SharedTimeForm||t.Model.Settings.IsAnonymous||t.Model.Settings.NotRecordIdentity))return s;return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}(this.props.FormMaster));var e={href:t,target:"_blank"};return i.createElement("a",Object(r.a)({},e),this.props.LocalizedStrings.ibclgkh)},e}(c.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(1),o=n(3);function u(t){return i.createElement(c,Object(r.a)({},t))}var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.Pu=function(){var t=this.props.content;return(o.isUndefined(this.props.trim)||this.props.trim)&&(t=t.trim()),t.split("\n")},n.render=function(){var t=this.Pu();return i.createElement("span",null,t.map((function(e,n){var r=n!==t.length-1?i.createElement("br",null):void 0;return i.createElement("span",null,e,r)})))},e}(n(17).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(11),i=n(106),o=n(6);function u(t){var e=Object(o.a)(),n="";if(t)if(t.correlationId){var u=t;u.innerCode&&(n=Object(i.a)(""+u.innerCode)||e.ihekbbk.format(u.innerCode))}else{switch(t.name){case"LoginIECrossZoneError":n=e.hjanpmj.format(window.location.origin,Object(r.b)());break;case"ThirdPartyCookieBlockedError":n=e.cnhhipm.format(Object(r.b)());break;case"AuthNoStorageError":n=e.gfkdhlf;break;case"AADAcquireTokenMfaCheckError":n=e.combdkk;break;case"TeamSiteNoGroupError":n=e.nkcdped}}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));var r=n(2),i=n(1),o=n(28),u=n(5),c=n(10),s=n(21),a=n(12),f=n(33),l=n(40),h=n(62),d=n(25),m=(n(7),n(17)),b=n(121),v=n(120),g=n(8),p=n(71),O=n(91),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ai=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.xn=function(){return t.forceUpdate()};var e=a.a.Schema;this.props.Form.observe(this.xn,[e.Title,e.Description,e.LogoInfo])},n.componentDidMount=function(){Object(p.a)($(this.Ai.current))},n.componentWillUnmount=function(){this.props.Form.unobserve(this.xn)},n.render=function(){var t,e,n=this.props.Form,r=n.Model,o=r.LogoInfo;if(Object(g.c)("RemoveImageTargetResourceId")?r.Logo&&r.Logo.ResourceUrl:r.Logo&&r.Logo.ResourceUrl&&o.TargetResourceId){var u=n.getImageMaster(a.a.Schema.Logo),s=n.getImageSettingsMaster(a.a.Schema.LogoInfo);t=i.createElement("div",{className:"logo-image-container old"},i.createElement(O.a,{Image:u,ImageSettings:s,ImageType:"Logo"}),Object(O.b)(u.Model))}r.Description&&!this.props.IsSmallSize&&(e=i.createElement("div",{className:"office-form-subtitle heading-1",ref:this.Ai},r.Description));var f=Object(c.a)("__title__ office-form-title-container office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size");return i.createElement("div",{className:f},i.createElement("div",{className:"office-form-logo-title"},t,i.createElement("div",{className:"office-form-title heading-1"},i.createElement("span",{role:"heading","aria-level":1},r.Title))),e)},e}(m.a),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.xn=function(){return t.forceUpdate()};var e=a.a.Schema;this.props.Form.observe(this.xn,[e.Title,e.Description]);var n=this.props.Form.getImageSettingsMaster(a.a.Schema.LogoInfo),r=Object(s.g)().Schema;n.observe(this.xn,[r.NaturalWidth,r.NaturalHeight]);var i=this.props.Form.getImageMaster(a.a.Schema.Logo),o=Object(s.f)().Schema;i.observe(this.xn,[o.ImageProcessingStatus,o.UploadParameters])},n.componentWillUnmount=function(){this.props.Form.unobserve(this.xn),this.props.Form.getImageSettingsMaster(a.a.Schema.LogoInfo).unobserve(this.xn),this.props.Form.getImageMaster(a.a.Schema.Logo).unobserve(this.xn)},n.render=function(){var t,e,n,o,u=this.props.Form,s=u.Model,l={className:Object(c.a)("__title__ office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size")},d="Left",m=u.getImageMaster(a.a.Schema.Logo),g=u.getImageSettingsMaster(a.a.Schema.LogoInfo),p=m.Model;if(!p.ErrorType&&(p.ImageProcessingStatus!==f.b.Idle||Object(f.d)(p))){var O=this.Yi(g);d=O.ImageLayout,t=i.createElement(v.a,{ImageWidth:O.Width,ImageHeight:O.Height,ImageInfoMaster:m,ImageSettingMaster:g,ImageType:"Logo"})}var j=this.props.LocaleId;return j&&(e=(o=h.a.getFormResourceMaster(j,this.props.Form)).Model.title||"",n=o.Model.subtitle||""),e=e||s.Title,n=this.props.IsSlimTitle||this.props.IsSmallSize?"":n||s.Description,i.createElement(b.a,{HTMLAttributes:l,HTMLPropsForInnerElement:{"aria-level":1,role:"heading"},MediaLayout:d,SubTitle:n,Title:e,ImmersiveReaderToggleProps:Object(r.a)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile},t)},n.Yi=function(t){if(t.Model.NaturalWidth){var e=t.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:e.ActualHeight,ImageLayout:e.Layout===l.a.Vertical?"Top":"Left",Width:e.ActualWidth}}return{Height:Object(o.h)(),ImageLayout:"Left",Width:Object(o.g)()}},e}(m.a);function I(t){return Object(d.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&Object(u.a)().userInfo.IsMsa?i.createElement(j,Object(r.a)({},t)):i.createElement(w,Object(r.a)({},t))}},,function(t,e){"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/.exec(this.toString());return t&&t.length>1?t[1].trim():""}})},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var s,a=[],f=!1,l=-1;function h(){f&&s&&(f=!1,s.length?a=s.concat(a):l=-1,a.length&&d())}function d(){if(!f){var t=c(h);f=!0;for(var e=a.length;e;){for(s=a,a=[];++l<e;)s&&s[l].run();l=-1,e=a.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function b(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new m(t,e)),1!==a.length||f||c(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=b,i.addListener=b,i.once=b,i.off=b,i.removeListener=b,i.removeAllListeners=b,i.emit=b,i.prependListener=b,i.prependOnceListener=b,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){window.replaceChunkSrc=function(t){return window.OfficeFormServerInfo&&window.OfficeFormServerInfo.ring&&!window.OfficeFormServerInfo.isCdnEnabled?t+"?ring="+window.OfficeFormServerInfo.ring:t}},function(t,e){var n;document.currentScript&&(n=document.currentScript.src);var r=function(){if(r.p)return r.p;var t,e,i;if(n)t=n.slice(0,n.split("?")[0].lastIndexOf("/")+1);else{var o=window.OfficeFormServerInfo||{},u=JSON.parse(decodeURIComponent(o.webSettings||"{}")).CdnEndPoint;o.isCdnEnabled&&u?t=u+"/scripts/dists/":(e=window.location.href,t=(i=/[?&]debug(=([^&#]*)|&|#|$)/.exec(e))&&i[2]&&"true"===decodeURIComponent(i[2].replace(/\+/g," "))?location.protocol+"//"+location.host+"/Scripts/dists/Forms/":location.protocol+"//"+location.host+"/Scripts/dists/")}return r.p=t,r.p};r.p=null,window.setPublicPath=r},function(t,e){String.prototype.format||(String.prototype.format=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}),String.prototype.trimEnd=function(t){for(var e=this.length;--e>=0&&!(t.indexOf(this.charAt(e))<0););return this.substr(0,e+1)},String.prototype.startsWith=function(t){if(null==t||0===t.length)return!0;return!(null==this||this.length<t.length)&&t===this.substr(0,t.length)},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),e)}},function(t,e){window.Forms={Common:{PageMethods:{}},DataProvider:{},DesignPage:{},Event:{EngagementEventDeprecated:{},QosEventDeprecated:{},QosEventNames:{}},Experiment:{},Experimentation:{},FileUploadProcess:{},FormsCdn:{},FormsProRelated:{},Grading:{},MobileDesignPage:{},Models:{FormManager:{}},Mru:{},MultilingualBatchRelated:{},O365ReactShell:{},PrintTemplate:{},Routing:{},Telemetry:{},Templates:{},Themes:{},Utilities:{FormId:{}},UX:{Addin:{},Admin:{},Analysis:{},Controls:{},Designer:{},DesignPage:{},FileUpload:{},FlexPane:{},FormDesignView:{},Intelligence:{},MultiLingual:{},NPS:{},OutlookQuickPoll:{},Phishing:{},PowerPoint:{},RecycleBin:{},Renderer:{},Teaching:{},TermsLink:{},TipBar:{},TopViews:{},Utilities:{}}},window.FormsPro={UX:{}}},function(t,e){function n(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(t){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(t,e){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(i=(r=t.parentNode).name,!(!t.href||!i||"map"!==r.nodeName.toLowerCase())&&(!!(o=$("img[usemap=#"+i+"]")[0])&&n(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u&&t.href||e)&&n(t)}(t,!isNaN($.attr(t,"tabindex")))}})},function(t,e,n){"use strict";n.r(e);var r=/('[^']*'|"[^"]*")/g,i=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,e){var n=t.toString();if(t<0)return n;if(e&&e>n.length)for(;e>n.length;)n="0"+n;return n}function u(t){return r.test(t)?t.substr(1,t.length-2):t}function c(t,e,n){var r={};return null==t||null==e||null==n?r:(e.split(i).forEach((function(e){var i;switch(e){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":i=2;case"yy":case"yyy":case"yyyy":i=i||4,r[e]=function(t,e){e=e||t.length;var n=t.match(/^\d+/g),r=n&&n[0];return r?r.length<=e?r:r.substr(0,e):""}(t,i),i=r[e].length;break;case"tt":i=0,t.toUpperCase().startsWith(n.DateTimeFormat.AMDesignator.toUpperCase())?i=n.DateTimeFormat.AMDesignator.length:t.toUpperCase().startsWith(n.DateTimeFormat.PMDesignator.toUpperCase())&&(i=n.DateTimeFormat.PMDesignator.length),r[e]=t.substr(0,i);break;default:i=0,e=u(e),t.startsWith(e)&&(i=e.length)}t=t.slice(i)})),t.length>0?{}:r)}function s(t,e){var n=parseInt(t.HH||t.H),r=parseInt(t.hh||t.h||t.time||12);if(isNaN(n)&&!isNaN(r)&&r>=1&&r<=12)if(null==t.tt)t.time||(n=0);else switch(t.tt.toUpperCase()){case e.DateTimeFormat.AMDesignator.toUpperCase():n=r%12;break;case e.DateTimeFormat.PMDesignator.toUpperCase():n=r%12+12}var i=parseInt(t.mm||t.m||t.time||0),o=parseInt(t.ss||t.s||0);return isNaN(n)||isNaN(i)?NaN:1e3*(60*(60*n+i)+o)}Date.prototype.toFormatString=function(t,e){var n=this;return null==n||null==t||null==e?null:t.split(i).map((function(t){switch(t){case"d":case"dd":return o(n.getDate(),t.length);case"ddd":return e.DateTimeFormat.AbbreviatedDayNames[n.getDay()];case"M":case"MM":return o(n.getMonth()+1,t.length);case"MMM":return e.DateTimeFormat.AbbreviatedMonthNames[n.getMonth()];case"yy":var r=n.getFullYear(),i=o(r,4);return r>e.Calendar.TwoDigitYearMax-100&&r<=e.Calendar.TwoDigitYearMax?i.slice(2):i;case"yyy":case"yyyy":case"yyyyy":return o(n.getFullYear(),t.length);case"H":case"HH":return o(n.getHours(),t.length);case"h":case"hh":return o((n.getHours()+11)%12+1,t.length);case"m":case"mm":return o(n.getMinutes(),t.length);case"s":case"ss":return o(n.getSeconds(),t.length);case"t":case"tt":var c=n.getHours()<12?e.DateTimeFormat.AMDesignator:e.DateTimeFormat.PMDesignator;return 1===t.length?c.charAt(0):c;default:return u(t)}})).join("")},Date.prototype.toDateShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortDatePattern,t)},Date.prototype.toTimeShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortTimePattern,t)};var a=n(5);Date.parseDate=function(t,e,n){var r=c(t,e,n),i=parseInt(r.yyyy||r.yyy),o=parseInt(r.yy);if(isNaN(i)&&!isNaN(o))if(o>=100)i=o;else{var u=Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax%100;i=o<=u?Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax-u+o:Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax-u-100+o}var f=parseInt(r.MM||r.M),l=r.MMM;isNaN(f)&&l&&(f=n.DateTimeFormat.AbbreviatedMonthNames.indexOf(l)+1);var h=parseInt(r.dd||r.d),d=s(r,n);if(!(isNaN(i)||isNaN(f)||isNaN(h)||isNaN(d))){var m=new Date(i,f-1,h,0,0,0,d);if(m.getFullYear()===i&&m.getMonth()+1===f&&m.getDate()===h)return m}return null},Date.parseTime=function(t,e,n){var r=c(t,e,n);return r.time=!0,s(r,n)};n(138);n(98).polyfill();n(141),n(142),n(143),n(144);var f=n(82),l=n(8),h=n(66),d=n(2),m=n(69),b=n(85),v=n(55),g=n(3),p=n(43);function O(){if(window.performance&&window.performance.getEntriesByType){for(var t=function(){for(var t=[],e=window.performance.getEntriesByType("navigation"),n=0,r=e;n<r.length;n++){var i=r[n],o=j(i);o.redirectStart=Math.round(i.redirectStart),o.redirectEnd=Math.round(i.redirectEnd),o.domainLookupEnd=Math.round(i.domainLookupEnd),o.secureConnectionStart=Math.round(i.secureConnectionStart),o.connectEnd=Math.round(i.connectEnd),o.type=i.type,o.initiatorType=i.initiatorType,o.domComplete=Math.round(i.domComplete),o.domContentLoadedEventStart=Math.round(i.domContentLoadedEventStart),o.domContentLoadedEventEnd=Math.round(i.domContentLoadedEventEnd),o.domInteractive=Math.round(i.domInteractive),o.duration=Math.round(i.duration),t.push(o)}return t}(),e=0,n=window.performance.getEntriesByType("resource");e<n.length;e++){var r=n[e];r&&r.name&&(/(basics|design|response).+\.js/.test(r.name.toLowerCase())&&t.push(j(r)))}return t}}function j(t){return{connectStart:Math.round(t.connectStart),decodedBodySize:t.decodedBodySize||-1,domainLookupStart:Math.round(t.domainLookupStart),encodedBodySize:t.encodedBodySize||-1,fetchStart:Math.round(t.fetchStart),name:(e=t.name,e.substring(e.lastIndexOf("/")+1,e.indexOf("?")>0?e.indexOf("?"):e.length)),requestStart:Math.round(t.requestStart),responseEnd:Math.round(t.responseEnd),responseStart:Math.round(t.responseStart),transferSize:t.transferSize||-1};var e}var w,I={};function S(t,e){I[t]=e}!function(t){t.FP_CreateFormMaster="forms.boot.create.fm",t.FP_ParseFormResponse="forms.boot.parse.rf",t.FP_RenderResponseForm="forms.boot.render.rf",t.FP_ParseResourceString="forms.boot.parse.rs"}(w||(w={}));var F=window.performance;function y(t){F&&F.mark&&F.mark(t)}function N(t,e){F&&F.measure&&F.measure(t,e)}var T=n(16),k=n(42),P=n(41),C=n(14),L=n(26),M=n(94),x=function(t){function e(e,n,r,i){var o=t.call(this,window.FormPrefetchCache.formCache)||this;return o.formMaster=e,o.eventName=n,o.Cu=r,o.Je=i,o.init(),o}Object(d.c)(e,t);var n=e.prototype;return n.onPrefetchSucceed=function(){var t=this;this.Lu(),setTimeout((function(){y("forms.boot.parse.rf.start"),t.updateFormModel(),N(w.FP_ParseFormResponse,"forms.boot.parse.rf.start"),t.prefetchDeferred.resolve()}),0),this.Mu(!0,null)},n.updateFormModel=function(){var t=this.cache.data,e="object"==typeof t?t:JSON.parse(t);if(this.Je){var n=this.Cu.Resolve("IIncrementalQuestionLoader");n.initialize(e,this.formMaster),e=n.getFormForFirstRender()}this.formMaster.Synchronizer.onSourceDataReceived(e)},n.onPrefetchFaied=function(){var t=this;this.Lu(),this.Je&&this.Cu.Resolve("IIncrementalQuestionLoader").initialize(null,this.formMaster);var e=this.cache.error;this.Mu(!1,e),e&&e.response&&401===e.response.statusCode?Object(k.c)().done((function(n){null==n?t.xu(e):t.fallBackToNormalBoot()})):this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;this.formMaster.ensureReadyToResponse().done((function(){return t.prefetchDeferred.resolve()})).fail((function(e){return t.prefetchDeferred.reject(e)}))},n.xu=function(t){var e=this;if(Object(k.d)(t))Object(k.g)().done((function(){Object(P.e)((function(){return e.fallBackToNormalBoot()}),L.d)}));else{var n=Object(v.b)(t);if(!Object(v.f)(n)){switch(n.innerCode){case 10001:this.fallBackToNormalBoot();break;case 15003:return void this.prefetchDeferred.reject(n)}this.fallBackToNormalBoot()}}},n.Mu=function(t,e){var n,r=e&&Object(b.b)(Object(a.a)().prefetchFormUrl,e);n=t?"Success":Object(m.b)(r)?"ExpectedFailure":"Failure";var i={correlationId:this.cache.logData.correlationId,duration:this.cache.logData.duration,eventName:this.eventName+"."+n,eventType:"qos_event",extraData:{queries:t?"":Object(C.c)(),prefetch:!0}};r&&(i.extraData.ServiceError=r),Object(T.a)(i)},n.Lu=function(){this.cache.errorCallback&&(this.cache.errorCallback=null),this.cache.successCallback&&(this.cache.successCallback=null)},e}(M.a),D=n(6),R=function(t){function e(){var e=t.call(this,window.FormPrefetchCache.stringCache)||this;return e.init(),e}Object(d.c)(e,t);var n=e.prototype;return n.onPrefetchSucceed=function(){try{y("forms.boot.parse.rs.start");var t=JSON.parse(this.cache.data).d;0,Object(D.d)(t),N(w.FP_ParseResourceString,"forms.boot.parse.rs.start"),this.prefetchDeferred.resolve(Object(D.a)())}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;Object(D.c)().done((function(){return t.prefetchDeferred.resolve()})).fail((function(e){return t.prefetchDeferred.reject(e)}))},e}(M.a),E=n(108),A=n(9),_=n(18),U=n(118),B=n(4),Q=n(97),q=function(){function t(t){this.Du=[],this.Ru=!1,this.Eu={},this.Au=t}var e=t.prototype;return e.initialize=function(t,e){this.O=t,this.hn=e,t&&!function(t){var e=function(t){return B.a.convertFromSourceData(JSON.parse(t.settings),Q.a.Schema)}(t);return t.allQuestions.length<4||!(!e||!e.ShuffleQuestionOrder)}(t)&&(this.Du=t.questions.sort((function(t,e){return t.order-e.order})),this.O.questions=this._u(1)),this.Uu(t&&t.allQuestions)},e.getFormForFirstRender=function(){return this.O},e.getQuestionsForNextLoad=function(){var t=this.$u()?this.Du.length:1;return this._u(t)},e.onFirstRenderCompleted=function(){this.$u()},e.hasMore=function(){return this.Du.length>0},e.has=function(t){return!!this.Eu[t]},e.Uu=function(t){var e=this;t&&t.length>0&&t.forEach((function(t){t.id&&(e.Eu[t.id]=!0)}))},e.$u=function(){return!!this.Ru||!!this.Bu()&&(this.Ru=!0,this.Au.raiseBootComplete(),!0)},e.Bu=function(){if(0===this.Du.length||(t=document.getElementById("form-bottom-sentinel"),(e=t&&t.getBoundingClientRect())&&e.height+e.top>=window.innerHeight))return!0;var t,e,n=this.Qu();if(!n)return!1;if(function(t){if(t){var e=t.Model.Choices;return e&&e.length>0&&g.some(e,(function(t){return t.BranchInfo&&!(!t.BranchInfo.TargetQuestionId&&!t.BranchInfo.ToTheEnd)}))}}(n))return!0;var r=n.Model.BranchInfo;if(r.ToTheEnd)return!0;var i=this.qu(r.TargetQuestionId)||this.Vu();return!this.zu(i)},e.Qu=function(){var t=this.hn.FormElementManager.TopQuestionMasters;return t&&t.length>0&&t[t.length-1]},e.zu=function(t){var e=this.hn.FormElementManager.SectionMasters;return!e||e.length<2||t&&t.order<e[1].Model.Order},e.qu=function(t){return g.find(this.Du,(function(e){return e.id===t}))},e._u=function(t){return this.Du.splice(0,Math.min(t,this.Du.length))},e.Vu=function(){return this.Du.length>0&&this.Du[0]},t}();var V=n(21),z=function(){function t(t){this.Gu=t,this.Hu=[],this.Wu=!1}var e=t.prototype;return e.initialize=function(t,e){this.Gu.initialize(t,e),this.hn=e,this.Wu=!!t},e.isInitializedWithFormData=function(){return this.Wu},e.normalizeResponses=function(t){return this.Ju=t,this.hn.normalizeResponses(t)},e.setQuizRenderer=function(t){this.Ku=t},e.getFormForFirstRender=function(){return this.Gu.getFormForFirstRender()},e.onFirstRenderCompleted=function(){var t=this;this.Wu&&setTimeout((function(){t.Gu.onFirstRenderCompleted(),t.Xu()}),0)},e.Xu=function(){var t=this,e=function(){var n=t.Gu.getQuestionsForNextLoad();n&&n.length>0&&(t.Yu(n),setTimeout(e,0))};e()},e.Zu=function(){var t=this,e=function(){t.Hu.length>0?(t.tc(t.Hu.shift()),G(e)):t.ec()};e()},e.Yu=function(t){var e;(e=this.Hu).push.apply(e,t),this.Zu()},e.ec=function(){var t=this;this.Gu.hasMore()||G((function(){return t.rc()}))},e.rc=function(){if(this.Ju&&this.Ju.length>0&&this.Ku){var t=this.hn.normalizeResponses(this.Ju);this.Ku.updateWithResponse(t[t.length-1])}},e.tc=function(t){B.a.Collection.itemsAddedInSource(this.hn.Model.Questions,[B.a.convertFromSourceData(t,Object(V.i)().Schema)])},t}();function G(t){window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,17)}var H=n(1),W=n(27),J=n(86),K=n(11),X=n(36),Y=n(30),Z=n(44);function tt(){if(!Object(Z.d)())return $.Deferred().reject();var t=$.Deferred(),e=!Object(Z.a)();e&&function(){Object(Z.e)(!0),Object(Z.f)(!1);var t=function(){var t=et;Object(K.o)()&&(t+="cookieAuth.");return t+Object(Y.b)()}(),e={client_id:Object(K.a)(),msafed:0,prompt:"none",redirect_uri:window.location.origin,resource:Object(K.h)(),response_mode:"form_post",response_type:"token",state:t};Object(X.a)().setItem(nt,t);var n=new J.a("Auth.DetectUserLoggedInAAD");n.start(),window.formDetectUserLoggedInAADCallback=function(t){n.end({resultType:t?"ExpectedFailure":"Success"}),Object(Z.e)(!1),Object(Z.f)(!t)};var r=Object(K.b)()+"common/oauth2/authorize?"+jQuery.param(e);$("body").append('<iframe id="detectAADAuthFrame" style="display:none;" src='+r+"><iframe>")}();var n=window.setInterval((function(){if(!Object(Z.a)())if(window.clearInterval(n),Object(Z.b)())if(e)t.resolve();else{setTimeout(L.d,2e3)}else t.reject()}),100);return t.promise()}var et="form.detectUserLoggedInAAD.",nt="officeforms.auth.state",rt=n(90),it=n(24),ot=n(35),ut=n(76),ct=n(47),st=n(101),at=n(60);function ft(t){var e=$.Deferred(),n=window.location.pathname;return!t!=!n.toLowerCase().startsWith("/FormsPro".toLowerCase())?(n=t?"/FormsPro"+n:n.substring("/FormsPro".length),Object(L.e)(n),e.promise()):e.resolve().promise()}var lt=n(77),ht=n(15),dt=n(12),mt=n(53),bt=n(7),vt=n(126),gt=n(106),pt=n(10),Ot=n(84),jt=n(22),wt=n(29),It=n(58),St=n(79),Ft=n(74),yt=n(17),Nt=n(92),Tt=n(119),kt=n(89),Pt=n(20),Ct=n(104);var Lt=function(t){function e(e){var n=t.call(this,e)||this;return n.ic="#008272",n.state={IsRefreshing:!1},n}Object(d.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){jt.a.logData({name:"ResponsePage.PollResultView.Navigate"})},n.componentDidUpdate=function(){var t=W.findDOMNode(this.refs["vote-detail"]);t&&t.focus()},n.render=function(){var t=this,e=Object(Ct.a)({HTMLAttributes:{className:"poll-top-view-back-button light-background-button",onClick:function(){return t.props.submitAnother()}},Icon:"Back",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",Text:Object(D.a)().pefpebc,TextClassName:"poll-top-view-back-text"});return H.createElement("div",{className:"office-poll-result-container"},H.createElement("div",{className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},H.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"},e),H.createElement("div",{className:"poll-result-container office-form-padding-align"},this.oc(),this.uc(),H.createElement("div",{className:"office-form-info-other"},this.cc()))),H.createElement(Nt.a,{TopExtraContent:this.sc()}))},n.oc=function(){var t=this.props.Form;return H.createElement("div",{className:"office-form-question-title"},t.Model.Questions[0]&&t.Model.Questions[0].Title)},n.uc=function(){var t=this,e=this.props.Form,n=e.Model.Questions[0].ChoiceType===Pt.a.MultiChoice,r=e.Model.Questions[0].AllowOtherAnswer,i=g.map(e.Model.Questions[0].Choices,(function(t){return{option:t.Description,voteCount:0,names:[],voted:!1}}));r&&i.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),g.each(e.Model.Responses,(function(t){var e=t.Answers,o=[];n?g.each(Object(A.w)(e[0].Answer),(function(t){return o.push(t)})):o.push(e[0].Answer);var u=t.ResponderName||t.Responder||Object(D.a)().ebnjeml;u&&g.each(o,(function(t){var e=g.findIndex(i,(function(e){return e.option===t}));r&&-1===e&&(e=i.length-1),-1!==e&&(i[e].voteCount+=1,i[e].names.push(u),"otherOptions"in i[e]&&i[e].otherOptions.push(t),u===Object(a.a)().userInfo.Email&&(i[e].voted=!0))}))})),i.sort((function(t,e){return e.voteCount-t.voteCount}));var o=g.first(i).voteCount,u=i.map((function(e,n){var r=e.voteCount||0,i=0===o?0:80*r/o,u=String(i)+"%",c=String(100-i)+"%",s=H.createElement("span",{className:"office-poll-vote-count-container"},H.createElement("span",{className:"poll-result-vote-count"},Object(D.a)().afbbibd.format(r))),a=H.createElement("div",{className:"poll-result-progressbar-container"},H.createElement("div",{className:"poll-result-progressbar-cell",style:{width:u}},H.createElement("a",{className:"poll-result-progressbar",style:{backgroundColor:t.ic}})),H.createElement("div",{className:"poll-result-progressbar-cell",style:{width:c}},H.createElement("a",{className:"poll-result-progressbar"})));return H.createElement("div",{className:"poll-result-option-container",key:e.option},H.createElement("div",null,e.option,e.voted?H.createElement("span",{className:"poll-result-voted"},Object(D.a)().cahlgdc):void 0,s),a)}));return H.createElement("div",{className:"poll-result-options-container"},u)},n.cc=function(){var t=this;return H.createElement("div",{className:"poll-result-refresh-link"},H.createElement("a",{className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var e=t.props.Form;t.setState({IsRefreshing:!0}),$.when(e.ensureFieldsReady([dt.a.Schema.Questions,dt.a.Schema.DescriptiveElements,dt.a.Schema.Responses]),e.syncRuntimeResponses()).then((function(){t.setState({IsRefreshing:!1})}))}},Object(D.a)().niajjgp),this.yu())},n.sc=function(){var t=this;if(!Object(ct.d)()){var e={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return t.props.beforePromotion&&t.props.beforePromotion(),!0}};return(Object(A.m)()||Object(A.n)()||Object(it.c)())&&(e.href="javascript:void(0)",e.onClick=function(){t.props.beforePromotion&&t.props.beforePromotion();var e=Object(A.e)(),n=Object(it.c)()?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(e);return Object(st.a)(Object(C.a)(n)),!0}),H.createElement("div",null,H.createElement("a",e,Object(D.a)().olehccl))}},n.yu=function(){if(this.state.IsRefreshing)return H.createElement("div",{className:"poll-submit-spinner"},H.createElement("div",{className:"spinner-tile-animation"}))},e}(yt.a),Mt=n(45);function xt(t){return H.createElement(Dt,t)}var Dt=function(t){function e(e){var n=t.call(this,e)||this;return n.ac=function(){return n.so()},n.state={IsSmallScreen:$(window).width()<768,SubmitState:"DetailResult"===Object(C.c)().view?3:0,ShowErrorPage:!1,ResponderEmail:Object(a.a)().userInfo.Email},n}Object(d.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.je=new Ot.a(this.props.Master),this.No(),window.addEventListener("resize",this.ac)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.ac)},n.render=function(){var t,e=this;if(this.state.ShowErrorPage)return Object(lt.a)({Error:this.fc,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var n,r={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===Mt.a.Mobile||this.state.IsSmallScreen)&&(r.className=Object(pt.a)(r.className,"small-screen")),this.lc()&&(r.className=Object(pt.a)(r.className,"mobile-view")),3===this.state.SubmitState){var i=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(i=function(){return e._o()}),n={ShowPromotionMessage:!0,submitAnother:i,beforePromotion:function(){jt.a.logData({name:"ResponsePage.PollResultView.NavigateToPortal"})},Form:this.props.Master},t=H.createElement(Lt,n)}else t=H.createElement("div",null,H.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.cr(),H.createElement("div",{className:"office-form-body"},this.Bo(),H.createElement("div",null,this.lu()),this.hc(),this.Go(),this.dc(),this.Wo(),this.Jo())),H.createElement(Nt.a,{FormMaster:this.props.Master,FooterType:"ShowStatementWithNotice",FooterText:!1}));return H.createElement("div",{className:"form-content-container"},H.createElement("div",r,H.createElement(kt.a,{ThemeMaster:this.props.Master.ThemeMaster}),t))},n.Bo=function(){return H.createElement("div",{className:"office-form-notice-container"},this.du(),this.mu())},n.du=function(){var t=this.props.Master.Model.Settings;if(!t.IsAnonymous&&!t.NotRecordIdentity){var e=Object(a.a)().userInfo.GivenName;return H.createElement("div",{},H.createElement("span",{className:"office-form-notice-long-text"},Object(D.a)().dkelneo.format(e)))}},n.mu=function(){return g.some(this.props.Master.Model.Questions,(function(t){return t.Required}))?H.createElement("div",null,H.createElement("span",{className:"office-form-required-notice-star"}),H.createElement("span",null,Object(D.a)().pfjnaob)):void 0},n.Wo=function(){var t=this.je.getQuestionsWithWrongAnswer(this.je.TopQuestionRuntimeMasters()),e=t.map((function(t){return Object(D.a)().fodbdkj.format(t)})).join(Object(D.a)().lfignjp),n=Object(D.a)().ohffajm.format(t.length,e),r=Object(wt.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),i=!!this.state.ShowValidationStyle&&!!t.length;return H.createElement("div",{className:Object(pt.a)("office-form-submit-error",i?"":"NotVisible"),role:"alert"},r,H.createElement("span",{className:"error-message"},i?n:""))},n.cr=function(){return H.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"})},n.lu=function(){var t=this,e=this.state.ShowValidationStyle;return B.a.convertToArray(this.je.Model.QuestionRuntimeMasters).map((function(n,r){var i=n.Question.Model.Id,o={Master:n,LocalizedStrings:Object(D.a)(),Ordinal:r+1,Disabled:!1,ExpandAll:!0,key:i,IsMobile:t.lc(),ShowValidationStyle:e,ShowQuizResult:!1,HideMedia:!1,IsStudentViewMode:!1};return Object(Tt.a)(o)}))},n.Jo=function(){var t=Object(wt.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),e=2===this.state.SubmitState;return H.createElement("div",{className:Object(pt.a)("office-form-submit-error",e?"":"NotVisible"),role:"alert"},t,H.createElement("span",{className:"error-message"},e?this.state.ErrorMessage:""))},n.hc=function(){var t=this;return H.createElement("div",{className:"design-question-choice-label"},H.createElement("div",{className:"poll-email-label"},Object(D.a)().njpfklc,H.createElement("span",{className:"required-star"})),Object(St.a)({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:Object(D.a)().flomnen,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(e){var n=!e||!e.trim();t.setState({ResponderEmail:e,ShowValidationStyle:n})}}),this.state.ShowValidationStyle?H.createElement("div",{className:"poll-email-validation-error"},Object(It.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:Object(D.a)().alheago,Alert:!0})):void 0)},n.dc=function(){var t=this;return H.createElement("span",{className:"poll-view-result-link"},H.createElement("a",{className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){t.setState({SubmitState:1});var e=t.props.Master;$.when(e.ensureFieldsReady([dt.a.Schema.Questions,dt.a.Schema.DescriptiveElements,dt.a.Schema.Responses]),e.syncRuntimeResponses()).then((function(){t.setState({SubmitState:3})}))}},Object(D.a)().bknogig),this.yu())},n.Go=function(){var t=this,e=1===this.state.SubmitState;return H.createElement("div",{className:"office-form-bottom-button-div"},Object(Ft.b)({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:e,onClick:function(){t.mc();var e=t.props.Master.Model,n=t.je.Answers?B.a.convertToArray(t.je.Answers):[];jt.a.logData({name:"ResponsePage.Form.Submit",extraData:{isPoll:!0,allQuestionCount:e.Questions.length,allAnswersLength:g.reduce(n,(function(t,e){return t+(e&&e.Answer?JSON.stringify(e.Answer).length:0)}),0)}})}},ButtonStyle:"LightBackground",Text:Object(D.a)().khmphfp}))},n.yu=function(){if(1===this.state.SubmitState)return H.createElement("div",{className:"poll-submit-spinner"},H.createElement("div",{className:"spinner-tile-animation"}))},n.bc=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},n.mc=function(){var t=this;if(this.je.getQuestionsWithWrongAnswer(this.je.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError);else if(this.state.ResponderEmail&&this.state.ResponderEmail.trim()&&this.bc(this.state.ResponderEmail.trim())){this.setState({SubmitState:1});var n={StartDate:this.Sn,SubmitDate:new Date,Answers:this.je.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},r=this.props.Master;r.submitResponse(n).done((function(e){$.when(r.ensureFieldsReady([dt.a.Schema.Questions,dt.a.Schema.DescriptiveElements,dt.a.Schema.Responses]),r.syncRuntimeResponses()).then((function(){t.setState({SubmitState:3,ErrorMessage:void 0})}))})).fail((function(e){var n=Object(D.a)(),r="";if(e.innerCode){if(r=Object(gt.a)(""+e.innerCode)||n.gpecfjp,5e3===e.innerCode){var i;i=e.customizedMessage,r=n.aegjfpo.format(i)}10001===e.innerCode&&(r=n.dagikom),631!==e.innerCode&&6503!==e.innerCode||(r=n.ljiidea)}t.setState({SubmitState:2,ErrorMessage:r}),5e3===e.innerCode&&(r=Object(D.a)().opgjdep),jt.a.logData({name:Object(m.a)(e)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",extraData:{Error:Object(m.c)(e),ErrorMessage:r||void 0},correlationId:e&&e.correlationId})}))}else this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError)},n._o=function(){jt.a.logData({name:"ResponsePage.PollResultView.SubmitAnother"}),this.No(),this.je.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:0},e.scrollToTop)},n.No=function(t){this.Sn=new Date,this.je.Answers=t||[]},n.lc=function(){switch(this.props.ViewMode){case Mt.a.Desktop:return!1;case Mt.a.Mobile:return!0;case Mt.a.Auto:return Object(A.k)();default:throw Error("unknown view mode")}},n.so=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},e.scrollToTop=function(){Object(pt.h)($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(pt.h)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},e}(yt.a);function Rt(t,e){var n=Date.now(),r=window.setTimeout((function(){Object(T.a)({eventName:"PageLoadingTimeout."+e,eventType:"engagement_event",extraData:{actualDuration:Date.now()-n,timeoutLimit:15e3}})}),15e3),i=t;i.always?i.always((function(){window.clearTimeout(r)})):t.then((function(){window.clearTimeout(r)}),(function(){window.clearTimeout(r)}))}var Et=n(25),At=function(){function t(t,e){void 0===e&&(e=!0),this.vc=e?Object(X.b)():Object(X.c)(),this.gc=t}var e=t.prototype;return e.pc=function(){return t.KeyPrefixAnswerMap+this.gc+"."+Object(a.a)().userInfo.UserId},Object.defineProperty(e,"Answers",{get:function(){var t=this.vc.getItem(this.pc());if(t){var e=JSON.parse(t);return Array.isArray(e)?e:void(this.Answers=void 0)}},set:function(t){t?this.vc.setItem(this.pc(),JSON.stringify(t)):this.vc.removeItem(this.pc())},enumerable:!1,configurable:!0}),e.Oc=function(){return t.KeyPrefixActiveSection+this.gc+"."+Object(a.a)().userInfo.UserId},Object.defineProperty(e,"SectionId",{get:function(){var t=this.Oc();return this.vc.getItem(t)||null},set:function(t){var e=this.Oc();t?this.vc.setItem(e,t):this.vc.removeItem(e)},enumerable:!1,configurable:!0}),t.KeyPrefixAnswerMap="officeforms.answermap.",t.KeyPrefixActiveSection="officeforms.activesection",t}();function _t(t,e,n,r,i,o){var u=t.Model.Id;Object(ot.h)((function(){return u})),Object(ot.g)((function(){return t}));Object(Y.b)();var c,s,f,d=Object(h.b)("loadForm",e()),m=i;m||(m=Object(h.b)("responseStrings",Object(D.c)())),n?(c=Object(a.a)().useDebugVersionScript?["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date"]:["combined-response"],s=Object(h.b)("scripts",Object(ut.b)(c))):s=$.Deferred().resolve().promise(),m.fail((function(t){Object(at.a)({message:"LoadLocalizedStrings failure, error: "+(t&&t.message)})})).done((function(){return S("resourceStringLoaded",Object(p.b)())})),s.fail((function(t){Object(at.a)({message:"LoadDependencies failure, error: "+(t&&t.message)})})).done((function(){return S("otherJsLoaded",Object(p.b)())}));f=window.setTimeout((function(){Object(Et.a)().RetryingRecoverableError&&$(".page-loading-messagebox").append("<div>"+Object(D.a)().fejajnj+"</div>")}),1e4),d.fail(Qt).fail((function(){})).done((function(){return S("formApiFinished",Object(p.b)())})).then((function(){return ft("survey"===t.Model.Type)})).then((function(){return function(t){Object(at.b)(t);var e=t.SyncContext===ht.a.SharedTimeForm;if(function(t){if(!Object(l.c)("ResponseInApp")||!t.Model.Settings.RespondInAppOnly)return!1;var e=!1;if(void 0===window.browser){if(Object(A.v)()){Object(st.a)("ms-edu-secureassessment:".concat(window.location.href).concat("!enforceLockdown"),"_self","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no"),Ut(!1,Error(Object(D.a)().bojobea),"Information")}else Ut(!1,Error(Object(D.a)().jfhfpmj),"Information");e=!0}else jt.a.logData({name:"ResponsePage.Form.OpenInTakeATest"});return e}(t))return $.Deferred().reject();var n=Object(it.k)()||Object(it.h)()||Object(A.n)();if(window.parent!==window&&!n&&(window.innerWidth<320||window.innerHeight<320||Object(A.f)()))return jt.a.logData({name:"ResponsePage.EmbedView.BlockEmbed",extraData:{iFrameWidth:window.innerWidth,iFrameHeight:window.innerHeight,isAndroid:Object(A.f)()}}),$t(),$.Deferred().reject();if(document.title=Object(bt.c)((function(){return t.Model.Title}),bt.e),e)jt.a.logData({name:"ShareFormPage.Copy.Navigate"});else if(Object(l.c)("ProgressBar")&&t.isFieldReady(dt.a.Schema.ProgressBarEnabled)){var r=!!t.Model.ProgressBarEnabled&&"true"===t.Model.ProgressBarEnabled;r=t.FormElementManager.SectionMasters.length>1&&r,jt.a.logData({name:"ResponsePage.Form.Navigate",extraData:{IsProgressBarVisible:r}})}else jt.a.logData({name:"ResponsePage.Form.Navigate"})}(t)})).then((function(){return!o&&function(t){var e=$.Deferred();t.SettingMaster.Model.IsAnonymous||Object(a.a)().userInfo.UserId?e.resolve():(jt.a.logData({name:"Auth.NoUserInfoForNonanonymousForm"}),Object(L.d)());return e.promise()}(t)})).then((function(){return function(t){var e=Object(C.c)().rid;return null!=e?t.getRuntimeResponse(e).then((function(t){return[t]})):t.Model.Settings.IsQuizMode&&t.SyncContext===ht.a.ResponseTimeForm?Object(h.b)("releasedResponses",t.getReleasedResponsesByResponder(Object(a.a)().userInfo.Email)).done((function(){return S("responseApiFinished",Object(p.b)())})):$.Deferred().resolve().promise()}(t).fail(Qt)})).done((function(e){$.when(m,s).done((function(){Object(h.a)(),function(t){if(t&&t.Model.Questions){var e=t.Model.Questions,n={};g.forEach(e,(function(t){var e=t.Type;e&&(e=e.substr(e.indexOf(".")+1),n[e]?n[e]++:n[e]=1)})),n.Total=e.length,S("questionCount",n)}}(t),t.Model.LocaleList.length&&t.Synchronizer.setFieldsQueryJob([dt.a.Schema.LocalizedResources],$.Deferred().resolve({localizedResources:[]}).promise()),e&&e.length?function(t,e,n){null!=Object(C.c)().rid?jt.a.logData({name:"ResponsePage.ViewResultView.Navigate"}):jt.a.logData({name:"ResponsePage.StudentView.Navigate"});var r=t[t.length-1],i=null;Object(l.d)()&&(i=_.a.Resolve("IIncrementalQuestionLoader"));var o={Master:e,ViewMode:Mt.a.Auto,Response:r,PhishingReviewUXFactory:n,IncrementalQuestionLoader:i};Bt(Object(vt.b)(o))}(e,t,r):function(t,e,n,r){var i=!t.Model.Settings.IsAnonymous,o=new At(t.Model.Id,i),u={PersistedAnswers:o.Answers,PrintView:n,PersistedSectionId:o.SectionId,Master:t,DisableSubmitButton:!1,ViewMode:Mt.a.Auto,persistAnswer:function(e){Object(bt.c)((function(){o.Answers=e}),bt.e),t.SyncContext===ht.a.ResponseTimeForm&&(window.onbeforeunload=e?function(){return""}:null)},persistSectionId:function(t){Object(bt.c)((function(){o.SectionId=t}),bt.e)},ForcedLocaleId:r,PhishingReviewUXFactory:e};Object(rt.a)(t.Model.Category,"ResponsePage.PollView")?"DetailResult"===Object(C.c)().view?$.when(t.ensureFieldsReady([dt.a.Schema.Questions,dt.a.Schema.DescriptiveElements,dt.a.Schema.Responses]),t.syncRuntimeResponses()).then((function(){Object(bt.c)((function(){return Bt(xt(u))}),bt.e)}),Qt):Object(bt.c)((function(){return Bt(xt(u))}),bt.e):Object(bt.c)((function(){return Bt(Object(vt.b)(u))}),bt.e)}(t,r),Object(ct.e)()&&function t(e){e.Synchronizer.query(Object(mt.d)()).done((function(){setTimeout((function(){return t(e)}),1e4)})).fail((function(){setTimeout((function(){return t(e)}),1e4)}))}(t),Object(T.b)()}))})),$.when(s,m,d).always((function(){window.clearTimeout(f),Object(Et.a)().RetryingRecoverableError=!1})),Rt($.when(s,m,d),"ResponsePage_Load")}function Ut(t,e,n){void 0===t&&(t=!0),Object(D.c)().done((function(){var r=Object(lt.a)({Error:e,ErrorType:n,FormId:Object(C.c)().id,IsResponsePage:!0,ShowCreateFormLink:t});Object(bt.d)(),Object(A.n)()&&t?W.render(H.createElement("div",{className:"embed-view-spo"},H.createElement(kt.a),r),document.getElementById("content-root")):W.render(r,document.getElementById("content-root")),Object(T.b)(e)}))}function $t(){Object(D.c)().done((function(){jt.a.logData({name:"ResponsePage.EmbedView.Navigate"});var t=Object(A.n)()?"embed-view office-form-theme-primary-background":"embed-view",e=H.createElement("div",{className:t},H.createElement("div",{className:"embed-view-container"},Object(wt.b)({HTMLAttributes:{className:"embed-view-icon"},IconName:"OfficeFormsLogo"}),H.createElement("span",{className:"embed-view-content"},Object(D.a)().adbfkib),H.createElement("a",{className:"embed-view-content",onClick:function(){jt.a.logData({name:"ResponsePage.EmbedView.OpenInBrowser"});var t=Object(A.e)(),e=window.location.pathname+"?";Object(bt.c)((function(){e+=jQuery.param(t)}),bt.e),Object(st.a)(Object(C.a)(e),"_blank","toolbar=yes, menubar=yes")}},Object(D.a)().einbcak)));Object(A.n)()&&(e=H.createElement("div",{className:"embed-view-spo"},H.createElement(kt.a),e)),Object(bt.d)(),W.render(e,document.getElementById("content-root"))}))}function Bt(t){var e;e=Object(A.n)()?"office-form-theme-page-background office-form-spo-embed":"office-form-theme-page-background",Object(bt.d)(),y("forms.boot.render.rf.start"),W.render(H.createElement("div",{id:"form-container",className:e},H.createElement("div",{className:"form-content"},t)),document.getElementById("content-root")),N(w.FP_RenderResponseForm,"forms.boot.render.rf.start"),function(){var t=!0;if(Object(l.d)()){var e=_.a.Resolve("IIncrementalQuestionLoader");e.isInitializedWithFormData()&&(e.onFirstRenderCompleted(),t=!1)}t&&_.a.Resolve("IBootEvent").raiseBootComplete()}()}function Qt(t){if(t)switch(Object(at.a)(t),t.innerCode){case 639:var e=Object(C.d)(window.location.href,"id",t.innerMessage);e!==window.location.href&&Object(L.c)(e);break;case 5e3:Ut(!0,t);break;case 10001:jt.a.logData({name:"ResponsePage.EmbedView.NeedAuth"}),tt().done((function(){setTimeout((function(){Object(Et.a)().AuthContext.signIn().then(L.b)}))})).fail($t);break;case 15001:Ut(!1,t);break;default:Ut(!0,t)}else Ut(!0,null,"Error")}var qt=function(){function t(){}return t.prototype.handleJavaScriptLoadError=function(t){Ut(!1,t,"Error")},t}(),Vt=n(54),zt=function(){function t(t,e){this.serviceUrl=t,this.ownerServiceUrl=e,this.partialUpdateHttpMethod=Object(Et.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}var e=t.prototype;return t.getQueryParameters=function(t,e,n){if(!e)return t+"$expand=questions";var r="$select="+(e=g.union(["id"],e)).join(","),i={permissions:"permissions",questions:"questions($expand=choices)",permissionTokens:"permissionTokens"},o=e.map((function(t){return i[t]})).filter((function(t){return t}));return o.length&&(r+="&$expand="+o.join(",")),n&&(r+="&$filter="+n.name+"+"+n.operator+"+"+n.value),r&&t+r},e.getImmersiveReaderToken=function(){return this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=ImmersiveReader"}).then((function(t){return t||$.Deferred().reject(new Error("Failed to get ImmersiveReader token via GetTokenForResource")).promise()}))},e.getPrivacySettings=function(t,e){var n={};return t&&(n.ownerTenantId=t),e&&(n.currentUserTenantId=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(n)})},e.reportAbuse=function(t){return this.sendRequest({data:t,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:t.Category},requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report"+window.location.search})},e.getRuntimeResponses=function(t,e){var n=e?"&$filter=responder+eq+'"+encodeURIComponent(e.replace(/\'/g,"''"))+"'":"",r=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:r+"forms('"+t+"')/runtimeresponses?$expand=comments"+n})},e.getRuntimeResponse=function(t,e){var n=Object(C.c)(),r={};return n.GetResponseToken&&(r={GetResponseToken:n.GetResponseToken}),this.sendRequest({headers:r,qosEventName:"RuntimeResponse.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/runtimeresponses("+e+")?$expand=comments"})},e.submitFormResponse=function(t,e){var n=Object(Vt.a)(t),r="AAD";return null==n.OrgId?r="Unknown":n.OrgId.toLowerCase()===Object(K.k)()&&(r="MSA"),this.sendRequest({data:e,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:r},requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses"})},e.getToken=function(){return Object(Et.a)().AuthContext.getFormApiToken()},e.getRuntimeForm=function(e,n){var r=this.getSurveyWebOwnerServiceUrl()+"light/runtimeForms('"+e+"')";return r+=t.getQueryParameters("?",n),this.es6sendRequest({qosEventName:"ResponseForm.Get",requestUri:r},{hasPrefetch:!0})},e.getResponseDetailRuntimeForm=function(e,n){var r=Object(C.c)();if(r.GetResponseToken&&r.rid){var i={GetResponseToken:r.GetResponseToken},o=this.getSurveyWebOwnerServiceUrl()+"light/responseDetailRuntimeForms('"+e+"')/"+r.rid;return o+=t.getQueryParameters("?",n),this.es6sendRequest({headers:i,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:o})}return Promise.resolve(null)},e.getLocaleResource=function(t,e){var n=this.getMultilingualBaseUrl(t)+"/'"+e+"'";return this.sendRequest({headers:{ValidationToken:""},method:"GET",qosEventName:"Locale.Get",requestUri:n})},e.createUploadSession=function(t,e,n){var r=this.getSurveyWebOwnerServiceUrl()+"runtimeForms('"+t+"')/questions('"+e+"')/CreateUploadSession";return this.sendRequest({data:{value:n},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:r})},e.cancelOrDeleteUploadFile=function(t){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:t})},e.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"})},e.getSharedForm=function(t){return this.es6sendRequest({body:'{"value" : "'+Object(C.c)().sharetoken+'"}',headers:{"Content-Type":"application/json;odata.metadata=minimal"},method:"GET",qosEventName:"SharedForm.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"GetSharedForm(formid='"+t+"',token='"+Object(C.c)().sharetoken+"')"})},e.getDataClassificationLabelDetail=function(t,e){return this.jc({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+t+"/"+encodeURIComponent(e)})},e.getMultilingualBaseUrl=function(t){return this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/localeResource"},e.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},e.getSurveyWebServiceUrl=function(){return this.serviceUrl},e.sendRequest=function(t,e){return this.sendRequestInner((function(t){return t&&t.value}),t,e)},e.sendRequestInner=function(t,e,n){var r=this;return this.getToken().then((function(t){return e.headers=$.extend(!0,e.headers,r.getCommonHeaders(t)),Object(b.a)(e,n).then(v.a,v.d)})).then(t)},e.es6sendRequest=function(t,e){var n=this;return new Promise((function(r,i){n.getToken().then((function(o){t.headers=$.extend(!0,t.headers,n.getCommonHeaders(o)),Object(b.a)(t,e).then((function(t){r(Object(v.a)(t).value)}),(function(t){var e=Object(v.c)(t);void 0!==e&&i(e)}))}))}))},e.getCommonHeaders=function(e){var n={__RequestVerificationToken:Object(a.a)().antiForgeryToken,Accept:"application/json",AnalyzerToken:Object(C.c)().AnalyzerToken,Authorization:Object(k.a)(e),ContextParams:Object(C.c)().ctx,ValidationToken:Object(C.c)().vt},r=Object(C.b)().Token;return Object(l.c)("GetShareInvitationKeyFromQuery")?n.ShareInvitationKey=r||Object(C.c)().Token:n.ShareInvitationKey=r,n=g.extend({},n,t.customizedHeaders)},e.jc=function(t,e){return t.headers=$.extend(!0,t.headers,this.getCommonHeaders("")),Object(b.a)(t,e).then(v.e,v.d)},t.customizedHeaders={},t}(),Gt=function(){function t(){}return t.prototype.getMixinFormApi=function(){return zt},t}(),Ht=n(0),Wt={Action:Ht.a.reference(),AllFormList:Ht.a.collectionOf(Ht.a.reference()),AllFormListLoadState:Ht.a.reference(),AllSharedFormList:Ht.a.collectionOf(Ht.a.reference()),Analysis:Ht.a.boolean(),BranchingElementId:Ht.a.string(),CdsInfoAvailableInUrl:Ht.a.boolean(),CdsList:Ht.a.reference(),CdsValidationMap:Ht.a.reference(),CopyFormId:Ht.a.string(),CriticalError:Ht.a.reference(),CurrentProject:Ht.a.reference(),CustomerVoiceEmailTemplates:Ht.a.reference(),CustomerVoiceView:Ht.a.reference(),AllProjects:Ht.a.reference(),DataIdeas:Ht.a.boolean(),DefaultCdsId:Ht.a.string(),DefaultCdsInfoLoadState:Ht.a.reference(),DefaultCdsUrl:Ht.a.string(),DelegateInactiveUser:Ht.a.reference(),EnvironmentListLoadState:Ht.a.reference(),ErrorBarMessage:Ht.a.string(),ExecuteDownloadExcel:Ht.a.boolean(),ExperienceType:Ht.a.reference(),FlexPane:Ht.a.reference(),ForceDesktopView:Ht.a.boolean(),FormCollectionType:Ht.a.reference(),FormId:Ht.a.string(),FormList:Ht.a.collectionOf(Ht.a.reference()),FormListLoadState:Ht.a.reference(),FormMaster:Ht.a.reference(),FormsProBranchingData:Ht.a.string(),FormsProToken:Ht.a.string(),FormsTenantSettings:Ht.a.reference(),Grading:Ht.a.reference(),GroupMaster:Ht.a.reference(),GroupMruFormListLoadState:Ht.a.reference(),Host:Ht.a.string(),InfoBarMessageType:Ht.a.string(),IsDefaultCds:Ht.a.boolean(),LastActiveTime:Ht.a.number(),LastUsedEnv:Ht.a.reference(),Locale:Ht.a.string(),MeetingInfo:Ht.a.reference(),pendingCalls:Ht.a.reference(),PlaceholderList:Ht.a.collectionOf(Ht.a.reference()),Preview:Ht.a.reference(),PreviousFlexPane:Ht.a.reference(),RecycleBin:Ht.a.collectionOf(Ht.a.reference()),RelativeScrolHeight:Ht.a.number(),Scenario:Ht.a.string(),SearchContent:Ht.a.string(),SectionElementId:Ht.a.string(),SelectedCdsId:Ht.a.string(),SelectedCdsRegion:Ht.a.string(),SelectedCdsUrl:Ht.a.string(),SelectedPortalForm:Ht.a.reference(),SenderList:Ht.a.reference(),SharedWithMeFormList:Ht.a.collectionOf(Ht.a.reference()),SharedWithMeFormListLoadState:Ht.a.reference(),SharingToken:Ht.a.string(),ShouldDisableAllClick:Ht.a.boolean(),ShowExcelSurveyIntroductionDialog:Ht.a.boolean(),ShowGroupListInPortal:Ht.a.boolean(),ShowShimmer:Ht.a.boolean(),ShowXLUnsyncedDialog:Ht.a.boolean(),Store:Ht.a.boolean(),TenantCountryCode:Ht.a.string(),Title:Ht.a.string(),Token:Ht.a.string(),TopView:Ht.a.reference(),UserActivities:Ht.a.reference(),ValidationChecked:Ht.a.reference(),XlWorkbookId:Ht.a.string(),SurveyReportId:Ht.a.string()},Jt=function(t){function e(){var e=t.call(this)||this;return e.wc=e.wc.bind(e),e.bulkEdit((function(){var t=e.Model;t.Analysis=!1,t.BranchingElementId=null,t.DataIdeas=!1,t.Store=!1,t.Grading=null,t.FormListLoadState="NotStarted",t.SharedWithMeFormListLoadState="NotStarted",t.GroupMruFormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.MeetingInfo=null,t.SectionElementId=null,e.Model.LastActiveTime=Date.now(),t.CopyFormId=null,t.SharingToken=null,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),Object(l.c)("RtcRefactor")&&e.Ic(),e}Object(d.c)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.Ic=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(e){return document.addEventListener(e,t.wc,!0)}))},n.wc=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},e}(B.a.createObjectMasterClass("DesignPageUxState",Wt)),Kt=n(81),Xt=n(33),Yt=n(40),Zt={Action:Ht.a.reference(),Analysis:Ht.a.boolean(),BottomView:Ht.a.reference(),CopyFormId:Ht.a.string(),CriticalError:Ht.a.reference(),ErrorBarMessage:Ht.a.string(),FormCollectionType:Ht.a.reference(),FormId:Ht.a.string(),FormList:Ht.a.collectionOf(Ht.a.reference()),FormListLoadState:Ht.a.reference(),FormMaster:Ht.a.reference(),FormsTenantSettings:Ht.a.reference(),InfoBarMessageType:Ht.a.string(),LastActiveTime:Ht.a.number(),Locale:Ht.a.string(),QuestionId:Ht.a.string(),QuestionInDesign:Ht.a.reference(),SelectedPortalForm:Ht.a.reference(),SharingToken:Ht.a.string(),ShouldDisableAllClick:Ht.a.boolean(),ShowHeadBar:Ht.a.boolean(),SurveyResults:Ht.a.boolean(),Title:Ht.a.string(),Token:Ht.a.string()},te=function(t){function e(){var e=t.call(this)||this;return e.wc=e.wc.bind(e),e.bulkEdit((function(t){t.Action="None",t.BottomView="None",t.FormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.ShowHeadBar=!0,e.Model.LastActiveTime=Date.now(),t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),e.addRule({InterestedFields:[e.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){e.Model.FormMaster||e.Sc()}}),e.addRule({InterestedFields:[e.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(t){e.Model.QuestionInDesign?e.Model.QuestionId=e.Model.QuestionInDesign.Model.Id:e.Model.QuestionId=null}}),Object(l.c)("RtcRefactor")&&e.Ic(),e}Object(d.c)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.Sc=function(){var t=this;this.bulkEdit((function(){var e=t.Model;e.FormMaster=void 0,e.Analysis=!1,e.BottomView="None",e.ShowHeadBar=!0,e.SurveyResults=!1}))},n.Ic=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(e){return document.addEventListener(e,t.wc,!0)}))},n.wc=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},e}(B.a.createObjectMasterClass("MobileDesignPageUxState",Zt));function ee(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,e)||this;return r.initializing.resolve(),r}return Object(d.c)(e,t),e}(t)}var ne=function(){function t(){}var e=t.prototype;return e.getMixinFormMaster=function(){return t.FormMasterClass||(t.FormMasterClass=ee(dt.a)),t.FormMasterClass},e.getMixinImageInfoMaster=function(){return t.ImageInfoMasterClass||(t.ImageInfoMasterClass=ee(Xt.a)),t.ImageInfoMasterClass},e.getMixinQuestionMaster=function(){return t.QuestionMasterClass||(t.QuestionMasterClass=ee(Pt.d)),t.QuestionMasterClass},e.getMixinFormElementManager=function(){return t.FormElementManagerClass||(t.FormElementManagerClass=Kt.a),t.FormElementManagerClass},e.getMixinImageSettingsMaster=function(){return t.ImageSettingsMasterClass||(t.ImageSettingsMasterClass=Yt.b),t.ImageSettingsMasterClass},e.getMixinDesignPageUxStateMaster=function(){return Jt},e.getMobileDesignPageUxStateMaster=function(){return te},e.getFileUploadConfirmDialog=function(){return null},t}(),re=n(87),ie=function(){function t(){this.Fc=new re.a.CallbackManager,this.Ru=!1}var e=t.prototype;return e.addBootCompleteListener=function(t){this.Ru?t():this.Fc.register(t)},e.raiseBootComplete=function(){this.Ru=!0,this.Fc.trigger("BootCompleted"),this.Fc.clear()},t}(),oe=function(){function t(){}t.prototype;return t.logData=function(t){Object(T.a)({eventName:t.name,eventType:"nav_perf_event",extraData:t.extraData})},t}();function ue(){if(window.performance){var t=function(){if(!window.performance)return{};var t=window.performance.timing.navigationStart,e=Object(p.b)(),n=window.NavKeyPoints,r=I;return r.navigationStart=t,r.serverPageTime=n?n.ServerPageTime:0,r.pageLoaded=n?n.PageStartTime:0,r.basicJsLoaded=n?n.BasicJsLoadedTime:0,r.mainJsLoaded=n?n.MainJsLoadedTime:0,r.formRenderEnd=e,r.timeToContentReady=e-t,r.timeToSpin=r.pageLoaded-t,r.resourceTiming=O(),r.page=window.location.pathname,r}();t.measures=(e=[],F&&F.getEntriesByName&&Object.keys(w).forEach((function(t){var n=F.getEntriesByName(w[t]);n&&1===n.length&&e.push({duration:Math.round(n[0].duration),name:n[0].name,startTime:Math.round(n[0].startTime)})})),e),oe.logData({extraData:t,name:"Endpoint.ResponsePage"})}var e}var ce=n(109);var se,ae,fe,le=function(t){function e(e){var n=t.call(this,e)||this;return n.name="AuthNoStorageError",n}return Object(d.c)(e,t),e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(d.c)(e,t),e}(Error)),he=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(k.c)(se)},e.handleAuthForContentPage=function(t){var e=this;return ae||(ae=de().then((function(n){if(n.HasUserSignedIn)be();else if(t)return e.redirectToLogin()}))),ae.promise()},e.handleAuthForAddinPage=function(){return ae||(ae=de().then((function(t){if(!t.HasUserSignedIn)return $.Deferred().reject().promise();be()}))),ae},e.hasUserLoggedIn=function(){return!!se.getCachedUser()},e.isValid=function(){return!Object(K.o)()},e.redirectToLogin=function(){if(se.login(),fe)return fe;throw Error("redirectForAuthContextLogin not called.")},e.refreshToken=function(){},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return se.config.postLogoutRedirectUri=window.location.href,se.logOut(),$.Deferred().resolve().promise()},t}();function de(){var t=Object(X.d)(),e=Object(X.e)();if(t||Object(T.a)({eventName:"Auth.LocalStorageNotSupported",eventType:"engagement_event",extraData:{supportsSessionStorage:e}}),!t&&!e)return $.Deferred().reject(new le("local storage or session storage can't be used")).promise();var n,r=(n=Object(X.a)().getItem("officeforms.userAccountNameKey"))&&JSON.parse(n),i="response_mode=form_post&msafed=0";r&&(i+="&username="+(r=JSON.stringify(r))),Object(l.c)("WorkAroundImplicitGrantBreak")&&(i+="&response_type=id_token+token&resource="+Object(K.h)());var o=window.location.origin,u={cacheLocation:t?"localStorage":"sessionStorage",clientId:Object(K.a)(),displayCall:me,extraQueryParameter:i,instance:Object(K.b)(),postLogoutRedirectUri:o,redirectUri:o,tenant:""};Object(l.c)("WorkAroundImplicitGrantBreak")&&g.extend(u,{loginResource:Object(K.h)()});var c=new AuthenticationContext(u),s=c.isCallback(window.location.hash);if(c.handleWindowCallback(),s)return $.Deferred().promise();if(!(se=c).getCachedUser())return $.Deferred().resolve({HasUserSignedIn:!1,UserSignedInBefore:!1}).promise();var a=$.Deferred();return se.acquireToken(Object(K.a)(),(function(t,e){var n=!t&&!!e;n?"live.com"===se.getCachedUser().profile.idp&&(se.clearCache(),n=!1,Object(T.a)({eventName:"UnexpectedLiveId",eventType:"error_event"})):se.clearCache();a.resolve({HasUserSignedIn:n,UserSignedInBefore:!0})})),a.promise()}function me(t){if(fe)throw Error("login in progress.");Object(L.f)(t);var e=$.Deferred();fe=e.promise();window.setTimeout((function(){return e.reject()}),3e3)}function be(){var t=se.getCachedUser();if(t){var e=t.profile.oid,n=Object(a.a)();n.userInfo={DisplayName:t.profile.name,Email:t.profile.unique_name,GivenName:t.profile.given_name||t.profile.name&&t.profile.name.split(" ")[0],IsMsa:!1,PUID:e.replace(/-/g,"").substring(16),TenantId:t.profile.tid,Upn:t.profile.upn,UserId:e},Object(a.b)(n)}}var ve=n(130),ge=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return this.yc().getFormApiToken()},e.handleAuthForContentPage=function(t){return this.yc().handleAuthForContentPage(t)},e.handleAuthForAddinPage=function(){return this.yc().handleAuthForAddinPage()},e.hasUserLoggedIn=function(){return this.yc().hasUserLoggedIn()},e.isValid=function(){return this.yc().isValid()},e.redirectToLogin=function(){return this.yc().redirectToLogin()},e.refreshToken=function(){return this.yc().refreshToken()},e.signIn=function(){return this.yc().signIn()},e.signOut=function(){return this.yc().signOut()},e.yc=function(){return this.Nc||(Object(K.o)()?this.Nc=new ve.a:this.Nc=new he),this.Nc},t}(),pe=function(){function t(t){this.Tc=null,this.kc=t?t.concat():[new ge]}var e=t.prototype;return e.signIn=function(){return this.Pc().then((function(t){return t.signIn()}))},e.getFormApiToken=function(){return this.Pc().then((function(t){return t.getFormApiToken()}))},e.handleAuthForContentPage=function(t){return this.Pc().then((function(e){return e.handleAuthForContentPage(t)}))},e.handleAuthForAddinPage=function(){return this.Pc().then((function(t){return t.handleAuthForAddinPage()}))},e.hasUserLoggedIn=function(){var t=this.Cc();return t&&t.hasUserLoggedIn()},e.redirectToLogin=function(){return this.Pc().then((function(t){return t.redirectToLogin()}))},e.refreshToken=function(){return this.Pc().then((function(t){return t.refreshToken()}))},e.signOut=function(){return this.Pc().then((function(t){return t.signOut()}))},e.Pc=function(){var t=this;if(this.Tc)return this.Tc;var e=function(n){var r=t.kc[n];return r?$.when(r.isValid()).then((function(t){return t?r:e(n+1)})):$.Deferred().reject(new Error("No valid authenticator")).promise()};return this.Tc=e(0),this.Tc},e.Cc=function(){return this.kc.filter((function(t){return t.isValid()}))[0]},t}(),Oe=function(){function t(t){var e=this;this.Lc={},this.Mc=t.then((function(t){e.xc=Ne(t)})),"pending"===this.Mc.state()&&(this.Dc=Ne(Object(a.a)().flights))}var e=t.prototype;return e.isEnabled=function(t){return this.Rc(t)},e.isEnabledAsync=function(t){var e=this;if(!t||!(t in we))throw Error("Checking uninitialized flight "+t+".");return this.Mc.then((function(){return e.Rc(t)}))},e.isEnabled_Deprecated=function(t){return this.Rc(t)},e.Rc=function(t){var e=Ie[t];if("tenant"===e){if(!this.xc){var n=Object(a.a)();if(n.useDebugVersionScript&&!n.isInUT)throw Error('Checking flight "'+t+'" before ready.');ye(t)}e="environment"}switch(e){case"environment":if(t in this.Lc)return this.Lc[t];break;case"deprecated":this.xc||ye(t);break;default:throw Error("Checking uninitialized flight "+t+".")}var r=this.Ec(t);return"environment"===e&&(this.Lc[t]=r),r},e.Ec=function(t){var e=this;if(Se[t]&&Se[t].some((function(t){return e.Rc(t)})))return!1;if(Fe[t]&&!Fe[t].every((function(t){return e.Rc(t)})))return!1;var n=t.toUpperCase(),r=function(){if(Te)return Te;var t={};if(!Object(K.t)()||Object(K.s)()){var e=Object(C.c)().fo;Array.isArray(e)&&(e=e[e.length-1]),e&&e.split(";").forEach((function(e){"!"!==e[0]?t[e.toUpperCase()]=!0:(e=e.substr(1).toUpperCase(),t[e]=!1)}))}return Te=t,t}();if(n in r)return r[n];var i=this.xc||this.Dc;return t in i?i[t]:we[t]},t}(),je=function(){switch(Object(K.d)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":return 2;case"Weekly":case"Hotfix":case"ProDaily":return 3;case"Int":case"MSInt":case"CVInt":return 4;case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":default:return 5}}(),we={},Ie={},Se={},Fe={};function ye(t){var e=new Error('Checking flight "'+t+'" before ready.');Object(T.a)({eventName:"UnstableFlightChecking",eventType:"error_event",extraData:{flightName:t,flightType:Ie[t],stack:e.stack}})}function Ne(t){var e={};return t&&t.split(";").forEach((function(t){"!"!==t[0]?e[t]=!0:(t=t.substr(1),e[t]=!1)})),e}var Te=null;function ke(t,e){we[t]=e>=je,Ie[t]="environment"}function Pe(t,e){we[t]=e>=je,Ie[t]="tenant"}function Ce(t,e){we[t]=e>=je,Ie[t]="deprecated"}var Le,Me=function(t,e){Fe[t]=e};Pe("TestTenantFlight",5),ke("TestEnvironmentFlight",5),ke("TestEnvironmentFlight_Blocker",0),Ce("TestDeprecatedFlight",0),ke("SubmitTimeDistributionInsight",0),ke("EnableNPSKeywordsInsight",0),ke("EnablePartialOrderInsight",0),ke("EnableResponseSentimentInsight",0),Ce("EnableMsaContentValidation",0),Pe("ResponseInApp",4),Pe("MathIncorrectAnswerSuggestions",2),Pe("MathQuestionGeneration",2),Ce("EnableOnlineExcelForMSA",0),Pe("DesignerFileUpload",2),Pe("ResponderFileUpload",5),Pe("EnableAnonymousUploadLink",0),Ce("FormInsight",4),Ce("PartialPut",1),ke("PPTContentAddinSSO",4),Ce("MsaPreviewLabel",5),Pe("PrintForm",1),Pe("AssignmentsIFrameLimitParentHeaders",4),Ce("EnableExperimentation",4),ke("FormInsightFeedbackV2",4),Ce("EmailHrdFallback",4),ke("WordCloudMultipleRatio",4),Ce("LogDownloadExcelErrorMessage",4),Ce("DisableBrandingForMSA",0),Ce("MSAIntroductionForResponder",4),Pe("QuestionTagForIntelligence",0),Ce("Question200Limit",4),ke("DataClassification",4),Pe("OptionToOptionSuggestionExp",4),Pe("DownloadExcelThrottlePerVM",4),Pe("DownloadOrOpenExcelInOneDriveThrottleUX",4),ke("DataClassificationRuntime",4),ke("GetShareInvitationKeyFromQuery",4),ke("LogShareInvitationKeyFromQuery",4),Pe("EditorOnContextMenuLog",4),Pe("SignalRConnectV2",4),Pe("BranchingExperiment",4),Pe("IntelligenceUseMemoryCache",4),Pe("IntelligenceScenarioProcess",4),Pe("TagTemplateSuggestionExp",4),Pe("EstimationTimeExp",0),Pe("FrontDoorOptionToOption",4),Pe("StrictAnalyzeTokenEdit",4),ke("RemoveRuntimeWarningbarReportAbuse",4),ke("ShareAssistant",4),Pe("BlockRestrictUser",0),Pe("ImmersiveReaderInForms",4),Pe("ImmersiveReaderMobileToggle",4),ke("O365ShellSuiteHeader",4),ke("LeverageServerRingLogic",4),Pe("BaseProFRE",0),ke("MultiLingualMVP1",5),ke("FirstTimePhishingDetectionWarning",4),Pe("FormsProAvailableTeachingCallout",0),ke("DataIdeasUxState",4),Pe("MobileScriptsPreload",4),Pe("MobileUseIdFromQuery",4),Pe("RemovePreviewLabelForSurvey",0),ke("WorkAroundImplicitGrantBreak",0),ke("UserFeatureSettings",0),ke("EnableUnblockRestrictedUserPage",4),Pe("QuizHistorySuggestion",4),Pe("YouTubeAdminControl",4),Pe("PersonalContextSuggestion",0),Pe("FromsSpinnerControl",4),ke("EnableEmailSharingFixForTeams",4),Pe("DisplayOptionSetting",0),Pe("ProgressBar",0),ke("IntelligenceCardAutoScroll",0),ke("CopyFormByAPI",4),ke("TemplateCopyFormByAPI",0),Pe("QuickPollTeachingUIControl",4),Pe("PermissionControlV2",4),Pe("RemoveBranchInNavi",4),Pe("AddBranchAndTeachUI",4),Pe("BranchingEntryPointInServer",4),ke("ResponseTimeEstimationStorage",4),ke("DeleteQuestionFocusFix",4),Pe("QuickPollDisableEws",0),Pe("ChangeWithPaste",4),Pe("BingImageAdminControl",4),Pe("MobileResponseDetail",4),Pe("HideSubmitAnother",4),Pe("DownloadExcelThrottleError",4),ke("ThrottledLogging",5),Pe("KeyboardBugForRecycleBin",4),Pe("EnableSlowerSave",5),Pe("EnableSlowerSaveForEdu",5),ke("EnableMoreResponseNav",4),ke("FixClientErrors_March",4),Pe("CheckBoxAlignmentIssueControl",4),Pe("OCVConsumerTypeBugFix",4),Pe("VideoStartTimeBugfix",4),Pe("DownloadExcelExpectedErrors",4),ke("QuizTextQuestionResponseCountFix",4),Pe("DefaultTextInMobileDesign",4),Pe("HideReportAbuse",0),ke("UnionSSOEnabled",4),ke("UnionSsoServerEnabled",4),Pe("TeamsPollLicenseCheck",4),Pe("ResponseDetailTableBeyondContainer",4),ke("RemoveImageTargetResourceId",4),Pe("OutlookQuickPollSso",4),ke("CustomizedThemeBackgroundFix",4),ke("LazyLoadResourceString",4),Pe("SettingShuffleQuestionsControl",4),Pe("ChartPropsCompareFix",4),Pe("FromsProServeryInFormsControl",4),Pe("OnlyReturnAnswersForAutoGradingQuiz",4),Pe("PerWindowRefreshResponseCount",4),Pe("DropDownInMobile",4),ke("EmptyRecycleBinButton",4),Pe("DisablePowertoolView",4),ke("ShareByTeamsEnabled",4),Pe("InformUserWhenUploadFileControl",4),Pe("WarningMessageForGroupNotFound",4),ke("IntelligenceLikertQuestionFix",4),Pe("MultilingualLazyLoadResourceString",4),Pe("RtcDisconnectOnIdle",5),Pe("RtcDontAutoConnect",0),Pe("RtcReconnectOnUserAction",0),Pe("RtcRefactor",4),Pe("RtcShowDisconnectIcon",5),ke("MobileErrorPageFix",4),Pe("SharedWithMeFormsLazyLoad",4),ke("FormsPro",0),ke("ProRedirectInWeb",0),ke("EnableCustomerVoice",0),ke("PrefetchForm",0),ke("PrefetchFormInServer",3),Me("PrefetchFormInServer",["PrefetchForm"]),ke("IncrementalLoadForms",3),Me("IncrementalLoadForms",["PrefetchForm"]),ke("DelayLoadThirdPartyJs",3),ke("SplitBasicsJs",3),ke("LoadJsByQuestionType",3),Me("LoadJsByQuestionType",["PrefetchFormInServer"]),ke("DelayLoadAriaOdataJs",3),Me("DelayLoadAriaOdataJs",["SplitBasicsJs"]),ke("PrefetchFormInServerByApi",0),ke("SettingTimeInputDisabled",0),ke("LoadThemeInServer",0),ke("PrefetchFormInServerByApi",0),ke("LoadResourceStringInServer",0),Me("TestTenantFlight",["TestEnvironmentFlight"]),Le=["TestEnvironmentFlight_Blocker"],Se["TestTenantFlight"]=Le,Me("BaseProFRE",["ProRedirectInWeb"]);var xe=function(){function t(t){this.Ac=$.Deferred(),t=t||{},this._c=new pe(t.authenticators),this.Uc=new Oe(this.Ac.promise()),t.addinAccessTokenGetter&&Object(ce.b)(t.addinAccessTokenGetter)}var e=t.prototype;return Object.defineProperty(e,"AuthContext",{get:function(){return this._c},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Flighting",{get:function(){return this.Uc},enumerable:!1,configurable:!0}),e.setFlightsBasingOnAuth_Deprecated=function(t){this.Ac.resolve(t)},Object.defineProperty(e,"RetryingRecoverableError",{get:function(){return this.$c},set:function(t){this.$c=t},enumerable:!1,configurable:!0}),t}(),De=n(72),Re=function(){function t(){this.Yt=null,this.Bc=null}var e=t.prototype;return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},e.getMuid=function(){return this.Bc},e.ensureMuid=function(){var e=this;if(null==this.Yt)if(this.Yt=$.Deferred(),this.Bc=Object(A.d)("MUID"),null==this.Bc){var n=new De.a("Function.GetMuid");n.start(),t.loadMuid((function(){e.Bc=Object(A.d)("MUID"),null!=e.Bc?(e.Yt.resolve(e.Bc),n.end({resultType:"Success"})):(e.Yt.reject(),n.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))}))}else this.Yt.resolve(this.Bc);return this.Yt.promise()},t.loadMuid=function(t){var e=Object(K.m)();if(e){var n=document.createElement("img");n.style.display="none",n.src=e+"/c.gif",n.hidden=!0,n["aria-hidden"]="true",n.onload=n.onerror=t}else t()},t.instance=null,t}(),Ee=function(){function t(){this.Qc=[]}var e=t.prototype;return e.setFunctionToCall=function(t){var e=this;if(this.Fn!==t)if(this.Fn=t,t){var n=this.Qc;delete this.Qc,n&&n.length&&n.forEach((function(t){return e.Fn.apply(void 0,t)}))}else this.Qc=this.Qc||[]},Object.defineProperty(e,"queue",{get:function(){return this.Fn?this.Fn:this.qc},enumerable:!1,configurable:!0}),e.qc=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Qc.push(t)},t}(),Ae=n(39),_e=n(99);function Ue(){var t=Object(_e.a)();return"OneNoteUwp"===t||"PowerPointTaskpane"===t}function $e(){switch(Object(K.d)()){case"Int":case"MSInt":case"CVInt":return"Int";case"WWProd":case"USGovProd":case"MSProd":case"ProTip":case"CVProd":return"Prod";default:return"DevEnv"}}function Be(t){return isNaN(t)?"0":t.toString()}var Qe=function(){function t(t){var e=this;this.Vc=Object(a.a)().serverSessionId||Object(Y.b)(),this.zc="",this.Gc="",this.De=!1,this.Hc=t,setTimeout((function(){return e.zi()}))}var e=t.prototype;return e.logData=function(e){t.BUFFER.queue(e)},Object.defineProperty(e,"SessionId",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),e.flush=function(t){this.De?AWTLogManager.flush(t):t()},e.zi=function(){var t=this;Re.getInstance().ensureMuid(),this.Wc=Object(K.k)().toUpperCase(),this.Jc=function(){switch(Object(K.n)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),this.Kc=0,this.Xc=window.location.pathname.toLowerCase(),Object(K.r)()&&"OneNoteUwp"!==Object(_e.a)()&&Object(Ae.c)().done((function(e){return t.Kc=e})).always((function(){t.Hc.then((function(){return t.Yc()}))}))},e.Yc=function(){var e={disableCookiesUsage:!0};switch(Object(K.d)()){case"USGovProd":e.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":e.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var n=function(){switch(Object(K.d)()){case"Int":case"MSInt":case"CVInt":return"79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484";case"WWProd":case"MSProd":case"ProTip":case"CVProd":return Object(Ae.f)()||Object(ot.d)()?"5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406":Object(K.v)()?"d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645":Object(bt.c)((function(){return"2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092"}),bt.e);case"USGovGccProd":return"aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984";case"USGovProd":return"577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823";case"USDoDProd":return"291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725";default:return"e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917"}}();AWTLogManager.initialize(n,e),this.De=!0,this.Zc=AWTLogManager.getLogger(n),t.BUFFER.setFunctionToCall(this.ts.bind(this))},t.enrichEngagementInfo=function(t){var e={},n={};t.properties&&(e=JSON.parse(t.properties)),g.extend(n,e,{IsMobileView:Object(A.k)()}),t.properties=JSON.stringify(n)},e.ts=function(e){"session_start"===e.eventType&&this.ns(e),"engagement_event"===e.eventType&&Object(A.k)()&&t.enrichEngagementInfo(e),this.rs(e)},e.ns=function(t){if(t.properties){var e=JSON.parse(t.properties);e&&(this.zc=e.DbId,this.Gc=e.DeviceId)}var n,r={BuildVersion:Object(a.a)().version,DbId:this.zc,DeviceId:this.Gc,Flights:(n={},n.PrefetchForm=Object(l.c)("PrefetchForm"),n.IsCdnEnabled=Object(a.a)().isCdnEnabled,n.PrefetchFormInServer=Object(l.c)("PrefetchFormInServer"),n.IsAFDEnabled=Object(a.a)().isAFDEnabled,n.IncrementalLoadForms=Object(l.d)(),n.DelayLoadThirdPartyJs=Object(l.b)(),n.SplitBasicsJs=Object(l.c)("SplitBasicsJs"),n.DelayLoadAriaOdataJs=Object(l.a)(),n.LoadJsByQuestionType=Object(l.c)("LoadJsByQuestionType"),n.PrefetchFormInServerByApi=Object(l.c)("PrefetchFormInServerByApi"),n.LoadResourceStringInServer=Object(l.c)("LoadResourceStringInServer"),n.SpecificShare=Object(l.c)("PermissionControlV2"),n),IsMobile:Object(A.k)(),JQueryLoaded:!!window.$,SessionRing:$e(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent},i=Object(_e.a)(),o=navigator.connection;i&&(r.Origin=i);var u=Object(it.f)();u&&(r.StartPageRoute=u),o&&(r.Connection={downLink:o.downLink||-1,effectiveType:o.effectiveType||"unsupported",rtt:o.rtt||-1}),r.IsMobile&&(r.IsMobileView=Object(A.l)()),t.eventName=t.eventType,t.duration=0,t.properties=JSON.stringify(r),t.timeStamp=Object(p.b)()},e.rs=function(t){var e=new AWTEventProperties;e.setName(t.eventType),e.setProperty("event_name",t.eventName),e.setProperty("event_correlation_id",t.eventCorrelationId),e.setProperty("duration",Be(t.duration)),e.setProperty("timestamp",Be(t.timeStamp)),e.setProperty("properties",t.properties),t.eventName&&t.eventName.indexOf("IntelligenceStatistic")>=0||t.withoutUserInfo?this.os(e):this.us(e)},e.os=function(t){Ue()||(t.setProperty("source_application",Object(bt.c)((function(){return"Office Forms BrowserApp"}),bt.e)),t.setProperty("user_role",this.Jc),t.setProperty("user_type",this.Kc),t.setProperty("page_type",this.Xc),this.Zc.logEvent(t))},e.us=function(t){if(!Ue()){var e=Object(a.a)().userInfo.UserId,n=Object(a.a)().userInfo.TenantId,r=Object(ot.b)();if(r&&t.setProperty("form_id",r),t.setProperty("source_application",Object(bt.c)((function(){return"Office Forms BrowserApp"}),bt.e)),t.setProperty("user_id",e),t.setProperty("user_tenant_id",n),t.setProperty("user_role",this.Jc),t.setProperty("user_type",this.Kc),t.setProperty("session_id",this.Vc),t.setProperty("page_type",this.Xc),t.setProperty("server_build_version",Object(a.a)().serverBuild),t.setProperty("client_build_version",Object(a.a)().clientBuild),t.setProperty("server_dc",Object(a.a)().datacenter),t.setProperty("server_ring",Object(a.a)().ring),Object(a.a)()&&Object(a.a)().serverInfoFromPageHeaders&&(t.setProperty("server_instance",Object(a.a)().serverInfoFromPageHeaders.serverInstance),t.setProperty("routing_build",Object(a.a)().serverInfoFromPageHeaders.routingBuild),t.setProperty("routing_dc",Object(a.a)().serverInfoFromPageHeaders.routingDataCenter),t.setProperty("routing_instance",Object(a.a)().serverInfoFromPageHeaders.routingInstance)),n)if(n.toUpperCase()===this.Wc){var i=Object(a.a)().userInfo.PUID;t.setProperty("UserInfo.Id",i),t.setProperty("UserInfo.IdType","MSAPUID")}else t.setProperty("UserInfo.Id",e),t.setProperty("UserInfo.IdType","UserObjectId"),t.setProperty("UserInfo.OMSTenantId",n);else e||t.setProperty("MUID",Re.getInstance().getMuid());this.Zc.logEvent(t)}},t.BUFFER=new Ee,t}(),qe=n(59),Ve=n(135),ze=n(70),Ge=function(){function t(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.fs=this.fs.bind(this),document.addEventListener("visibilitychange",this.fs)}var e=t.prototype;return e.stop=function(){document.removeEventListener("visibilitychange",this.fs)},e.fs=function(){this.visiToggleTime=new Date},t}(),He={engagement_event:Ke,error_event:Ke,formspro_event:Ke,nav_perf_event:function(t){var e=Ke(t);t.extraData&&(!function(t){if(Xe){var e=0;"hidden"===Xe.initialVisibility?e=Xe.initializeTime.getTime():Xe.visiToggleTime&&(e=Xe.visiToggleTime.getTime());t.extraData.VisiToggled=e,Xe.stop(),Xe=null}}(t),e.properties=JSON.stringify(t.extraData));return e},qos_event:function(t){var e={duration:t.duration,eventCorrelationId:t.correlationId,eventName:(t.eventName||We[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(p.b)()};t.extraData&&(e.properties=JSON.stringify(t.extraData));return e},session_start:function(t){return t.extraData={DbId:"",DeviceId:""},Ke(t)}},We={engagement_event:"no_EngagementName",error_event:"no_ErrorName",formspro_event:"formspro_event",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"},Je=function(){function t(t){this.ls=t,Object(L.a)(ze.a)}var e=t.prototype;return e.log=function(t){this.hs(t,!1)},e.logWithoutUserInfo=function(t){this.hs(t,!0)},e.logFormsProEvent=function(t){t.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3;var e={eventName:t.type,eventType:"formspro_event",extraData:t.eventInfo};this.ls.logData(Ke(e))},e.logForTeamsTab=function(t){Object(it.l)()&&(t?Object(m.a)(t)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:Object(Ve.a)(t),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},e.hs=function(t,e){if(!function(t){return Object(l.c)("ThrottledLogging")&&-1!==(Object(qe.a)("DisabledEventNames")||[]).indexOf(t.eventName)}(t)){var n,r=He[t.eventType];if(r)n=r(t);else n=Ke({eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:t,message:"Unsupported event"}});this.ls.logData(g.extend(n,{withoutUserInfo:e}))}},t}();function Ke(t){var e={duration:0,eventCorrelationId:t.correlationId||Object(Y.b)(),eventName:(t.eventName||We[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(p.b)()};return t.extraData&&(e.properties=JSON.stringify(t.extraData)),e}var Xe=new Ge;var Ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ds="",e}Object(d.c)(e,t);var n=e.prototype;return n.render=function(){for(var t=[],e=0;e<this.props.NumStar;e++)t.push(H.createElement("span",{style:{margin:this.bs()}},this.ds));return H.createElement("div",{className:"rateit-empty",style:{fontSize:this.props.Config.FontSize}},t)},n.bs=function(){return"0px "+this.props.Config.MarginRight+"px 0px "+this.props.Config.MarginLeft+"px"},e}(yt.a),Ze=function(){function t(){}return t.prototype.createRatingStar=function(t){return H.createElement(Ye,Object(d.a)({},t))},t}();function tn(){if(_.a.Register("IRatingStarsFactory").UsingSingleton((function(){return new Ze})),Object(l.b)()){var t=new Promise((function(t,e){_.a.Resolve("IBootEvent").addBootCompleteListener((function(){Object(ut.a)("combined-response").then(t,e)}))})),e=function(){return t};_.a.Register("IThirdPartyRateIt").UsingSingleton(e),_.a.Register("IThirdPartyLinkify").UsingSingleton(e),_.a.Register("IThirdPartyDateTimePicker").UsingSingleton(e)}else!function(){var t=Promise.resolve($),e=function(){return t};_.a.Register("IThirdPartyRateIt").UsingSingleton(e),_.a.Register("IThirdPartyLinkify").UsingSingleton(e),_.a.Register("IThirdPartyDateTimePicker").UsingSingleton(e)}()}var en=n(102);function nn(t){return t.SyncContext===ht.a.AdminPhishingReviewForm}var rn,on,un,cn,sn=function(){function t(){}var e=t.prototype;return e.createAdminPhishingReviewNavBar=function(t,e){return nn(t)?Object(en.a)({FormMaster:t,SetErrorStateCallback:e}):null},e.createPhishingWarningPage=function(t,e){return Object(ot.d)()&&!e&&!nn(t)&&t.SyncContext===ht.a.ResponseTimeForm&&(1===t.Model.OnlineSafetyLevel||128===t.Model.OnlineSafetyLevel||129===t.Model.OnlineSafetyLevel)?Object(en.b)({}):null},t}();function an(){return Object(l.c)("PrefetchForm")||Object(l.c)("PrefetchFormInServerByApi")}Object(l.e)(f.a.ResponsePage),rn=null,on=U.a,_.a.Register("IPageContext").UsingSingleton((function(){return new xe(rn)})),_.a.Register("IAWTLogger").UsingSingleton((function(){return new Qe(on&&on()||Promise.resolve())})),_.a.Register("ILogger").UsingSingleton((function(){return new Je(_.a.Resolve("IAWTLogger"))})),_.a.Register("IMixin").UsingSingleton((function(){return new ne})),_.a.Register("IFormApiMixin").UsingSingleton((function(){return new Gt})),_.a.Register("IErrorHandler").UsingSingleton((function(){return new qt})),(un=new ie).addBootCompleteListener(ue),_.a.Register("IBootEvent").UsingSingleton((function(){return un})),tn(),_.a.Register("IIncrementalLoadStrategy").UsingSingleton((function(){return new q(_.a.Resolve("IBootEvent"))})),_.a.Register("IIncrementalQuestionLoader").UsingSingleton((function(){return new z(_.a.Resolve("IIncrementalLoadStrategy"))})),Object(Et.a)().setFlightsBasingOnAuth_Deprecated(Object(a.a)().flights),(cn=Object(h.b)("pre-auth",Object(Et.a)().AuthContext.handleAuthForContentPage(!1))).done((function(){S("authEnd",Object(p.b)()),Object(T.a)({eventName:"session_start",eventType:"session_start"}),y("forms.boot.create.fm.start");var t,e,n,r=(t=Object(C.c)().id,e=Object(Vt.a)(t),new(Object(V.j)())(ht.a.ResponseTimeForm,{ExistingInDataSource:!0,InitialData:{Id:t,OwnerId:e.OwnerId,OwnerTenantId:e.OrgId,TableId:e.TableId}},e.IsGroupOwner,!1,null,Object(l.d)()&&_.a.Resolve("IIncrementalQuestionLoader")));if(N(w.FP_CreateFormMaster,"forms.boot.create.fm.start"),_t(r,(function(){return function(t){return an()?new x(t,"ResponseForm.Get",_.a,Object(l.d)()).getPromise():t.ensureReadyToResponse()}(r)}),!1,new sn,(n=Object(a.a)().resourceStringsLoadedInServer,Object(E.b)()?(Object(D.d)(n),$.Deferred().resolve(n).promise()):an()?(new R).getPromise():void 0)),Object(C.c)().qrcode&&Object(T.a)({eventName:"ResponsePage.Form.QRCode",eventType:"engagement_event"}),Object(C.c)().nocdn&&Object(T.a)({eventName:"ResponsePage.CdnFallback",eventType:"error_event"}),Object(A.m)()){var i=Object(C.c)().platform,o=Object(C.c)().host,u=void 0;(i||o)&&(u={host:o,platform:i}),Object(T.a)({eventName:"ResponsePage.EmbedView.IsEmbeddedSession",eventType:"engagement_event",extraData:u})}})).fail((function(t){Ut(!1,t)})),Rt(cn,"ResponsePage_HandleAuth")}]);